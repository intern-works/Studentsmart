
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="pU2v7x_qRVQ5j-A_JIVEKln6zIq_B4Jdjh122RCf4eQ" />
    <title>Studentsmart</title>
    <link rel="icon" href="https://i.ibb.co/1YBpx2KS/logo.png">
    <!-- Add modern dependencies -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PZCVV1J0EK"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PZCVV1J0EK"></script>
    
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-PZCVV1J0EK');
    </script>
    <style>
        :root {
            --primary: #6C5CE7;
            --primary-light: #A29BFE;
            --secondary: #00CEC9;
            --accent: #FD79A8;
            --accent-light: #FFEAA7;
            --dark: #2D3436;
            --light: #F5F6FA;
            --white: #FFFFFF;
            --success: #00B894;
            --warning: #FDCB6E;
            --danger: #E17055;
            --border-radius: 12px;
            --border-radius-lg: 20px;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.15);
            --blur: blur(10px);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --sidebar-width: 400px;
            --sidebar-width-mobile: 100vw;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: var(--light);
            overflow-x: hidden;
        }

        /* Navigation */
        /* Improved Navigation with Better Spacing */
        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1.2rem 0; /* Increased vertical padding */
            transition: var(--transition);
            background: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .nav-container {
            max-width: 1400px; /* Increased max-width for more space */
            margin: 0 auto;
            padding: 0 3rem; /* Increased horizontal padding */
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem; /* Added gap between main sections */
        }

        .navbar-brand {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.8rem; /* Increased gap between logo and text */
            min-width: 200px; /* Ensure brand section has minimum width */
        }

        .logo {
            height: 42px; /* Slightly larger logo */
            transition: var(--transition);
        }

        .navbar-brand:hover .logo {
            transform: rotate(8deg) scale(1.1);
        }

        /* Navigation Links with Better Spacing */
        .nav-links {
            display: flex;
            list-style: none;
            gap: 2.5rem; /* Increased gap between nav items */
            align-items: center;
            margin: 0;
            padding: 0;
            flex: 1; /* Allow nav links to take available space */
            justify-content: center; /* Center the navigation links */
        }

        .nav-link {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            font-size: 1rem; /* Slightly larger font */
            transition: var(--transition);
            position: relative;
            padding: 0.8rem 1rem; /* Added horizontal and vertical padding */
            border-radius: 8px; /* Rounded background on hover */
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0.2rem;
            left: 1rem;
            width: 0;
            height: 3px;
            background: var(--accent);
            transition: var(--transition);
            border-radius: 3px;
        }

        .nav-link:hover {
            background: rgba(108, 92, 231, 0.1);
            color: var(--primary);
        }

        .nav-link:hover::after {
            width: calc(100% - 2rem);
        }

        .nav-link.active {
            background: rgba(108, 92, 231, 0.1);
            color: var(--primary);
        }

        .nav-link.active::after {
            width: calc(100% - 2rem);
        }

        /* Action Buttons Section with Improved Spacing */
        .nav-buttons {
            display: flex;
            align-items: center;
            gap: 1.2rem; /* Increased gap between buttons */
            min-width: 200px; /* Ensure buttons section has minimum width */
            justify-content: flex-end;
        }

        /* Mobile Menu Toggle (if you have one) */
        .mobile-menu-toggle {
            display: none;
            flex-direction: column;
            gap: 4px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
        }

        .mobile-menu-toggle span {
            width: 25px;
            height: 3px;
            background: var(--dark);
            border-radius: 2px;
            transition: var(--transition);
        }

        /* Mobile Responsive Adjustments */
        @media (max-width: 992px) {
            .nav-container {
                padding: 0 2rem;
                gap: 1.5rem;
            }

            .nav-links {
                gap: 2rem;
            }

            .navbar-brand {
                min-width: auto;
            }

            .nav-buttons {
                min-width: auto;
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--white);
                flex-direction: column;
                padding: 2rem;
                box-shadow: var(--shadow-lg);
                gap: 1rem;
            }

            .nav-links.active {
                display: flex;
            }

            .mobile-menu-toggle {
                display: flex;
            }

            .nav-container {
                padding: 0 1.5rem;
            }

            .nav-buttons {
                gap: 0.8rem;
            }

            .btn {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
        }
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            transition: var(--transition);
            cursor: pointer;
            border: none;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: var(--primary-light);
        }

        .btn-secondary {
            background: var(--secondary);
            color: var(--dark);
            box-shadow: var(--shadow);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: #00D8D3;
        }

        .btn-accent {
            background: var(--accent);
            color: var(--white);
            box-shadow: var(--shadow);
        }

        .btn-accent:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: #FF8FAB;
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: var(--white);
        }

        /* Hero Section */
        /* Mobile Responsive Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            position: relative;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            overflow: hidden;
            padding-top: 80px;
        }

        .hero-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            align-items: center;
        }

        .hero-content {
            animation: slideUp 0.8s ease 0.2s both;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--white);
            border-radius: 50px;
            padding: 0.5rem 1.2rem;
            color: var(--primary);
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-sm);
            animation: slideDown 0.8s ease;
        }

        .hero-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            color: var(--dark);
        }

        .hero-gradient {
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Search Bar Styles - Mobile Responsive */
        .search-container {
            position: relative;
            margin-bottom: 2.5rem;
        }

        .search-wrapper {
            background: var(--white);
            border-radius: var(--border-radius-lg);
            padding: 1rem;
            box-shadow: var(--shadow-lg);
            border: 2px solid rgba(108, 92, 231, 0.1);
            transition: var(--transition);
            position: relative;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-wrapper:focus-within {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .search-input {
            flex: 1;
            border: none;
            outline: none;
            font-size: 1.1rem;
            padding: 0.8rem 1rem;
            color: var(--dark);
            background: transparent;
        }

        .search-input::placeholder {
            color: var(--dark);
            opacity: 0.6;
        }

        .search-btn {
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius);
            padding: 0.8rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
        }

        .search-btn:hover {
            background: var(--primary-light);
            transform: scale(1.05);
        }

        .quick-search {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-top: 1rem;
            justify-content: center;
        }

        .quick-tag {
            background: rgba(108, 92, 231, 0.1);
            color: var(--primary);
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .quick-tag:hover {
            background: var(--primary);
            color: var(--white);
            transform: translateY(-2px);
        }

        .hero-cta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
            justify-content: center;
        }

        /* Image Carousel Styles - Mobile Responsive */
        .hero-carousel {
            position: relative;
            animation: slideInRight 0.8s ease 0.4s both;
            height: 500px;
            overflow: hidden;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
        }

        .carousel-container {
            display: flex;
            height: 100%;
            animation: slideCarousel 18s infinite ease-in-out;
        }

        .carousel-slide {
            min-width: 100%;
            height: 100%;
            position: relative;
        }

        .carousel-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .carousel-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            padding: 2rem;
            color: var(--white);
        }

        .carousel-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .carousel-desc {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        /* Animations */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideCarousel {
            0%, 30% { transform: translateX(0); }
            33.33%, 63% { transform: translateX(-100%); }
            66.66%, 96% { transform: translateX(-200%); }
            100% { transform: translateX(0); }
        }

        /* MOBILE RESPONSIVE BREAKPOINTS */

        /* Large tablets and small laptops (992px and down) */
        @media (max-width: 992px) {
            .hero-container {
                gap: 2rem;
            }

            .hero-title {
                font-size: clamp(2rem, 4vw, 3rem);
            }

            .hero-carousel {
                height: 400px;
            }
        }

        /* Tablets (768px and down) */
        @media (max-width: 768px) {
            .hero {
                padding-top: 100px;
                padding-bottom: 2rem;
            }

            .hero-container {
                grid-template-columns: 1fr;
                gap: 3rem;
                padding: 0 1.5rem;
                text-align: center;
            }

            .hero-content {
                order: 1;
            }

            .hero-carousel {
                order: 2;
                height: 300px;
                margin: 0 auto;
                max-width: 500px;
            }

            .search-wrapper {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .search-input {
                padding: 1rem;
                font-size: 1rem;
                text-align: center;
            }

            .search-btn {
                padding: 1rem 2rem;
                width: 100%;
            }

            .quick-search {
                justify-content: center;
            }

            .hero-cta {
                justify-content: center;
                flex-direction: column;
                align-items: center;
            }

            .carousel-overlay {
                padding: 1.5rem;
            }

            .carousel-title {
                font-size: 1.2rem;
            }

            .carousel-desc {
                font-size: 0.9rem;
            }
        }

        /* Mobile phones (576px and down) */
        @media (max-width: 576px) {
            .hero {
                min-height: auto;
                padding-top: 120px;
                padding-bottom: 3rem;
            }

            .hero-container {
                padding: 0 1rem;
                gap: 2rem;
            }

            .hero-badge {
                font-size: 0.8rem;
                padding: 0.4rem 1rem;
                margin-bottom: 1rem;
            }

            .hero-title {
                font-size: clamp(1.8rem, 8vw, 2.5rem);
                margin-bottom: 1rem;
            }

            .hero-carousel {
                height: 250px;
            }

            .search-container {
                margin-bottom: 2rem;
            }

            .search-wrapper {
                padding: 0.8rem;
            }

            .search-input {
                padding: 0.8rem;
                font-size: 0.95rem;
            }

            .search-btn {
                padding: 0.8rem 1.5rem;
                font-size: 0.9rem;
            }

            .quick-tag {
                font-size: 0.8rem;
                padding: 0.3rem 0.6rem;
            }

            .carousel-overlay {
                padding: 1rem;
            }

            .carousel-title {
                font-size: 1rem;
                margin-bottom: 0.3rem;
            }

            .carousel-desc {
                font-size: 0.8rem;
            }
        }

        /* Extra small phones (480px and down) */
        @media (max-width: 480px) {
            .hero-container {
                padding: 0 0.75rem;
            }

            .hero-title {
                font-size: clamp(1.5rem, 7vw, 2rem);
            }

            .hero-carousel {
                height: 200px;
                border-radius: 12px;
            }

            .search-wrapper {
                border-radius: 12px;
            }

            .search-btn {
                border-radius: 8px;
            }
        }

        /* Stats Section */
        .stats {
            padding: 4rem 0;
            background: var(--white);
            text-align: center;
        }

        .stats-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .stat-item {
            padding: 2rem 1rem;
            background: var(--light);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .stat-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .stat-label {
            font-size: 1rem;
            color: var(--dark);
            opacity: 0.8;
        }

        /* Categories Section */
        .categories {
            padding: 6rem 0;
            background: var(--light);
        }

        .categories-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .section-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .section-subtitle {
            font-size: 1.125rem;
            color: var(--dark);
            opacity: 0.7;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Infinite Category Carousel */
        .categories-carousel-wrapper {
            overflow: hidden;
            mask: linear-gradient(90deg, transparent, white 10%, white 90%, transparent);
            -webkit-mask: linear-gradient(90deg, transparent, white 10%, white 90%, transparent);
        }

        .categories-carousel {
            display: flex;
            gap: 2rem;
            animation: infiniteScroll 30s linear infinite;
            width: max-content;
        }

        .categories-carousel:hover {
            animation-play-state: paused;
        }

        @keyframes infiniteScroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .category-card {
            background: var(--white);
            border-radius: var(--border-radius-lg);
            padding: 2rem 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
            min-width: 280px;
            flex-shrink: 0;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--primary);
            transition: var(--transition);
        }

        .category-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-lg);
        }

        .category-card:hover::before {
            background: var(--accent);
        }

        .category-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(108, 92, 231, 0.1);
            border-radius: 50%;
            font-size: 2rem;
            color: var(--primary);
            transition: var(--transition);
        }

        .category-card:hover .category-icon {
            background: var(--primary);
            color: var(--white);
            transform: scale(1.1) rotate(10deg);
        }

        .category-name {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.75rem;
        }

        .category-desc {
            color: var(--dark);
            opacity: 0.7;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        /* Featured Section */
        .featured {
            padding: 6rem 0;
            background: var(--white);
        }

        .featured-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .featured-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 4rem;
        }

        .featured-card {
            background: var(--white);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            transition: var(--transition);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .featured-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: var(--secondary);
            transition: var(--transition);
        }

        .featured-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .featured-card:hover::before {
            background: var(--accent);
        }

        .card-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent);
            color: var(--white);
            padding: 0.3rem 1rem;
            border-radius: var(--border-radius);
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 2;
        }

        .card-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
            transition: var(--transition);
        }

        .featured-card:hover .card-image {
            transform: scale(1.03);
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .card-subtitle {
            color: var(--dark);
            opacity: 0.7;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.5;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .price-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .price {
            font-weight: 800;
            font-size: 1.3rem;
            color: var(--primary);
        }

        .price-btn {
            background: var(--primary);
            color: var(--white);
            border: none;
            border-radius: var(--border-radius);
            padding: 0.6rem 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .price-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        /* Success Stories - New Design */
        /* Success Stories - Enhanced Design */
        .success-stories {
            padding: 8rem 0;
            background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
            position: relative;
            overflow: hidden;
        }

        .success-stories::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                radial-gradient(circle at 20% 80%, rgba(108, 92, 231, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(253, 121, 168, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 206, 201, 0.02) 0%, transparent 50%);
            pointer-events: none;
        }

        .success-container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
        }

        .success-header {
            text-align: center;
            margin-bottom: 5rem;
            position: relative;
        }

        .success-header::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 2px;
        }

        .success-header .section-title {
            color: var(--dark);
            margin-bottom: 1.5rem;
            font-size: clamp(2.2rem, 5vw, 3.5rem);
            position: relative;
        }

        .success-header .section-subtitle {
            color: var(--dark);
            opacity: 0.75;
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.7;
        }

        /* Student Cards Grid */
        .student-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 2.5rem;
            margin-top: 4rem;
        }

        /* Enhanced Student Card */
        .student-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(108, 92, 231, 0.12);
            border-radius: 24px;
            padding: 2.5rem 2rem;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
            box-shadow:
                0 8px 30px rgba(0, 0, 0, 0.08),
                0 1px 3px rgba(0, 0, 0, 0.05);
            transform: translateY(0);
        }

        /* Gradient Border Effect */
        .student-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg,
                var(--primary) 0%,
                var(--secondary) 35%,
                var(--accent) 70%,
                var(--primary-light) 100%);
            border-radius: 24px 24px 0 0;
            transition: all 0.4s ease;
        }

        /* Hover Effects */
        .student-card:hover {
            transform: translateY(-12px) scale(1.02);
            background: linear-gradient(145deg, rgba(255, 255, 255, 1), rgba(248, 249, 255, 0.98));
            box-shadow:
                0 25px 50px rgba(108, 92, 231, 0.15),
                0 10px 20px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            border-color: rgba(108, 92, 231, 0.3);
        }

        .student-card:hover::before {
            height: 8px;
            background: linear-gradient(90deg,
                var(--accent) 0%,
                var(--primary) 25%,
                var(--secondary) 50%,
                var(--accent) 75%,
                var(--primary-light) 100%);
            animation: shimmerBorder 2s ease-in-out infinite;
        }

        @keyframes shimmerBorder {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; transform: scaleX(1.05); }
        }

        /* Student Profile Section */
        .student-profile {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            margin-bottom: 1.8rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(108, 92, 231, 0.08);
        }

        .student-avatar {
            width: 85px;
            height: 85px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid transparent;
            background: linear-gradient(135deg, var(--primary), var(--accent)) padding-box,
                        linear-gradient(135deg, var(--primary), var(--accent)) border-box;
            box-shadow:
                0 8px 25px rgba(108, 92, 231, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
        }

        .student-avatar::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .student-card:hover .student-avatar {
            transform: scale(1.1) rotate(5deg);
            box-shadow:
                0 12px 35px rgba(108, 92, 231, 0.35),
                inset 0 2px 0 rgba(255, 255, 255, 0.4);
        }

        .student-card:hover .student-avatar::after {
            opacity: 0.1;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.1; }
            50% { transform: scale(1.05); opacity: 0.2; }
        }

        /* Student Info */
        .student-info {
            flex: 1;
        }

        .student-info h4 {
            font-weight: 700;
            font-size: 1.3rem;
            margin-bottom: 0.4rem;
            color: var(--dark);
            font-family: 'Space Grotesk', sans-serif;
            letter-spacing: -0.02em;
        }

        .student-info .college {
            color: var(--primary);
            font-size: 1rem;
            font-weight: 600;
            opacity: 0.9;
            margin-bottom: 0.8rem;
            position: relative;
            padding-left: 1.2rem;
        }

        .student-info .college::before {
            content: '🎓';
            position: absolute;
            left: 0;
            top: 0;
            font-size: 0.9rem;
        }

        /* Enhanced Earnings Badge */
        .earnings-badge {
            background: linear-gradient(135deg, #00B894 0%, #00CEC9 50%, #00A085 100%);
            color: var(--white);
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow:
                0 6px 20px rgba(0, 184, 148, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .earnings-badge::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }

        .student-card:hover .earnings-badge::before {
            left: 100%;
        }

        .earnings-badge i {
            font-size: 1.1rem;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));
        }

        /* Quote Section */
        .student-quote {
            font-style: italic;
            color: var(--dark);
            opacity: 0.85;
            line-height: 1.7;
            font-size: 1rem;
            margin-bottom: 1.8rem;
            position: relative;
            padding: 0.5rem 0;
            background: linear-gradient(135deg, rgba(108, 92, 231, 0.03), rgba(253, 121, 168, 0.03));
            border-radius: 12px;
            padding: 1.2rem 1.5rem;
            border-left: 4px solid var(--primary);
        }

        .student-quote::before {
            content: '"';
            font-size: 4rem;
            color: var(--primary);
            opacity: 0.15;
            position: absolute;
            top: -0.5rem;
            left: 0.5rem;
            font-family: 'Georgia', serif;
            font-weight: bold;
            line-height: 1;
        }

        .student-quote::after {
            content: '"';
            font-size: 4rem;
            color: var(--primary);
            opacity: 0.15;
            position: absolute;
            bottom: -2rem;
            right: 0.5rem;
            font-family: 'Georgia', serif;
            font-weight: bold;
            line-height: 1;
        }

        /* Enhanced Stats Section */
        .student-stats {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 1.5rem 0 0.5rem;
            border-top: 2px solid rgba(108, 92, 231, 0.1);
            background: linear-gradient(135deg, rgba(108, 92, 231, 0.02), rgba(253, 121, 168, 0.02));
            border-radius: 12px;
            margin: 0 -0.5rem;
            position: relative;
        }

        .stat-group {
            text-align: center;
            flex: 1;
            position: relative;
        }

        .stat-group:not(:last-child)::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 1px;
            height: 30px;
            background: linear-gradient(to bottom, transparent, var(--primary), transparent);
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--accent);
            display: block;
            font-family: 'Space Grotesk', sans-serif;
            text-shadow: 0 1px 3px rgba(253, 121, 168, 0.2);
            transition: all 0.3s ease;
        }

        .student-card:hover .stat-number {
            transform: scale(1.1);
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--dark);
            opacity: 0.7;
            margin-top: 0.3rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Rating Section */
        .student-rating {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            padding: 0.8rem;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 193, 7, 0.1));
            border-radius: 15px;
            border: 2px solid rgba(255, 215, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        .student-rating::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .student-card:hover .student-rating::before {
            left: 100%;
        }

        /* Star Styles */
        .star {
            color: #FFD700;
            font-size: 1.5rem;
            text-shadow:
                0 0 5px rgba(255, 215, 0, 0.8),
                0 0 10px rgba(255, 215, 0, 0.6),
                0 0 15px rgba(255, 215, 0, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
        }

        .star:hover {
            color: #FFA000;
            transform: scale(1.3) rotate(10deg);
            text-shadow:
                0 0 8px rgba(255, 160, 0, 1),
                0 0 20px rgba(255, 160, 0, 0.8),
                0 0 30px rgba(255, 160, 0, 0.6);
        }

        /* Rating number and text */
        .rating-text {
            color: var(--dark);
            font-size: 1.1rem;
            font-weight: 700;
            margin-left: 0.8rem;
            padding: 0.3rem 0.8rem;
            background: linear-gradient(135deg, #FFD700, #FFA000);
            color: var(--white);
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .student-card:hover .rating-text {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
            background: linear-gradient(135deg, #FFA000, #FF8F00);
        }

        /* Star animation on card hover */
        .student-card:hover .star {
            animation: starPulse 1.2s ease-in-out infinite;
        }

        @keyframes starPulse {
            0%, 100% {
                transform: scale(1);
                color: #FFD700;
            }
            25% {
                transform: scale(1.1) rotate(5deg);
                color: #FFA000;
            }
            50% {
                transform: scale(1.2);
                color: #FF8F00;
            }
            75% {
                transform: scale(1.1) rotate(-5deg);
                color: #FFA000;
            }
        }

        /* Additional glow effect for rating section */
        .student-card:hover .student-rating {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 193, 7, 0.2));
            border-color: rgba(255, 215, 0, 0.4);
            box-shadow:
                0 0 20px rgba(255, 215, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        /* Responsive Design */
        @media (max-width: 1200px) {
            .student-cards {
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
                gap: 2rem;
            }
        }

        @media (max-width: 768px) {
            .success-stories {
                padding: 6rem 0;
            }

            .student-cards {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                margin-top: 3rem;
            }

            .student-card {
                padding: 2rem 1.5rem;
                border-radius: 20px;
            }

            .student-profile {
                gap: 1rem;
                margin-bottom: 1.5rem;
            }

            .student-avatar {
                width: 70px;
                height: 70px;
            }

            .student-info h4 {
                font-size: 1.2rem;
            }

            .student-info .college {
                font-size: 0.9rem;
            }

            .earnings-badge {
                font-size: 0.9rem;
                padding: 0.5rem 1rem;
            }

            .student-quote {
                font-size: 0.95rem;
                padding: 1rem 1.2rem;
                margin-bottom: 1.5rem;
            }

            .student-stats {
                padding: 1.2rem 0 0.5rem;
                margin: 0 -0.3rem;
            }

            .stat-number {
                font-size: 1.5rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .success-container {
                padding: 0 1rem;
            }

            .student-card {
                padding: 1.5rem 1rem;
                border-radius: 16px;
            }

            .student-profile {
                flex-direction: column;
                text-align: center;
                gap: 0.8rem;
            }

            .student-avatar {
                width: 80px;
                height: 80px;
            }

            .earnings-badge {
                align-self: center;
            }

            .student-stats {
                flex-direction: column;
                gap: 1rem;
                padding: 1.5rem 0;
            }

            .stat-group::after {
                display: none;
            }
        }

        /* Additional Enhancement: Floating Animation */
        @media (prefers-reduced-motion: no-preference) {
            .student-card {
                animation: float 6s ease-in-out infinite;
            }

            .student-card:nth-child(2) {
                animation-delay: -2s;
            }

            .student-card:nth-child(3) {
                animation-delay: -4s;
            }

            @keyframes float {
                0%, 100% {
                    transform: translateY(0px);
                }
                50% {
                    transform: translateY(-10px);
                }
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .student-card {
                border: 2px solid var(--dark);
                background: var(--white);
            }

            .student-card:hover {
                border-color: var(--primary);
            }
        }
        @media (max-width: 1200px) {
            .student-cards {
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
                gap: 2rem;
            }
        }

        @media (max-width: 768px) {
            .success-stories {
                padding: 6rem 0;
            }

            .student-cards {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                margin-top: 3rem;
            }

            .student-card {
                padding: 2rem 1.5rem;
                border-radius: 20px;
            }

            .student-profile {
                gap: 1rem;
                margin-bottom: 1.5rem;
            }

            .student-avatar {
                width: 70px;
                height: 70px;
            }

            .student-info h4 {
                font-size: 1.2rem;
            }

            .student-info .college {
                font-size: 0.9rem;
            }

            .earnings-badge {
                font-size: 0.9rem;
                padding: 0.5rem 1rem;
            }

            .student-quote {
                font-size: 0.95rem;
                padding: 1rem 1.2rem;
                margin-bottom: 1.5rem;
            }

            .student-stats {
                padding: 1.2rem 0 0.5rem;
                margin: 0 -0.3rem;
            }

            .stat-number {
                font-size: 1.5rem;
            }

            .stat-label {
                font-size: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .success-container {
                padding: 0 1rem;
            }

            .student-card {
                padding: 1.5rem 1rem;
                border-radius: 16px;
            }

            .student-profile {
                flex-direction: column;
                text-align: center;
                gap: 0.8rem;
            }

            .student-avatar {
                width: 80px;
                height: 80px;
            }

            .earnings-badge {
                align-self: center;
            }

            .student-stats {
                flex-direction: row;
                justify-content: space-between;
                gap: 1rem;
                padding: 1.5rem 0;
            }

            .stat-group {
                flex: 1;
                text-align: center;
            }

            /* Keep rating star and number side by side on mobile */
            .student-rating {
                flex-direction: row;
                justify-content: center;
                align-items: center;
                gap: 0.5rem;
            }

            .star {
                font-size: 1.3rem;
            }

            .rating-text {
                margin-left: 0.5rem;
                font-size: 1rem;
                padding: 0.2rem 0.6rem;
            }
        }

        /* High contrast mode support for mobile */
        @media (prefers-contrast: high) {
            .student-card {
                border: 2px solid var(--dark);
                background: var(--white);
            }

            .student-card:hover {
                border-color: var(--primary);
            }
        }

        /* CTA Section */
        .cta-section {
            padding: 6rem 0;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: var(--white);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .cta-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 2rem;
            position: relative;
            z-index: 2;
        }

        .cta-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 700;
            margin-bottom: 1.5rem;
        }

        .cta-subtitle {
            font-size: 1.25rem;
            opacity: 0.9;
            margin-bottom: 2.5rem;
            line-height: 1.6;
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .cta-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.05;
            background-image: radial-gradient(var(--white) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Footer */
        /* Footer Section - Redesigned to match your website theme */
        /* Revamped Footer Styles */
        /* Revamped Footer Styles */
        /* Modern Footer Styles */
/* Modern Footer Styles */
        /* Footer Styles */
        /* StudentsMart Footer - Based on Reference Image */
/* StudentsMart Footer - Light Theme like Image 1 */
/* StudentsMart Footer - Light Theme with Borders */
/* StudentsMart Footer - Light Theme with Borders */
/* StudentsMart Footer - Light Theme with Complete Border */
        .footer {
            background-color: #f8f9fa;
            color: #333333;
            padding: 60px 0 30px;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            margin: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        /* Add outline borders around each section */
        .footer .col-md-2,
        .footer .col-md-3,
        .footer .col-md-4 {
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 2rem 1.5rem;
            margin-bottom: 1rem;
            background-color: #ffffff;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        /* Brand Section */
        .footer .col-md-4:first-child h5 {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.5rem !important;
            font-weight: 700;
            margin-bottom: 1rem !important;
            display: flex;
            align-items: center;
        }

        .footer .col-md-4:first-child h5 i {
            color: #8b5cf6;
            background: none;
            -webkit-text-fill-color: #8b5cf6;
            margin-right: 8px;
        }

        /* Description text */
        .footer .col-md-4:first-child p {
            color: #6b7280;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        /* About Us Button - Purple gradient */
        .footer .btn-outline-light {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            border: none;
            color: #ffffff;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .footer .btn-outline-light:hover {
            background: linear-gradient(135deg, #7c3aed, #9333ea);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        /* Section Headers */
        .footer h5.text-primary {
            color: #1f2937 !important;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1.5rem !important;
        }

        /* Navigation Links */
        .footer .list-unstyled {
            padding: 0;
            margin: 0;
        }

        .footer .list-unstyled li {
            margin-bottom: 10px;
        }

        .footer .list-unstyled li a {
            color: #6b7280 !important;
            text-decoration: none !important;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer .list-unstyled li a:hover {
            color: #374151 !important;
        }

        /* Icon colors for links */
        .footer .list-unstyled li a i {
            color: #8b5cf6;
            width: 18px;
            font-size: 0.9rem;
        }

        /* Contact Information */
        .footer .col-md-3:last-child ul li {
            color: #6b7280;
            font-size: 0.95rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer .col-md-3:last-child ul li i {
            color: #8b5cf6;
            width: 18px;
            font-size: 0.9rem;
        }

        /* Social Media Icons */
        .footer .col-md-3:last-child .mt-3 {
            margin-top: 1.5rem;
        }

        .footer .col-md-3:last-child .mt-3 a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background-color: #f3f4f6;
            color: #6b7280;
            text-decoration: none;
            border-radius: 6px;
            margin-right: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            border: 1px solid #e5e7eb;
        }

        .footer .col-md-3:last-child .mt-3 a:hover {
            background-color: #8b5cf6;
            color: #ffffff;
            border-color: #8b5cf6;
            transform: translateY(-1px);
        }

        /* Divider */
        .footer hr {
            border: none;
            height: 1px;
            background-color: #e5e7eb;
            margin: 40px 0 25px;
            opacity: 1;
        }

        /* Bottom Copyright Section */
        .footer .row:last-child p {
            color: #9ca3af;
            font-size: 0.9rem;
            margin: 0;
        }

        .footer .text-danger {
            color: #ef4444 !important;
        }

        /* Override Bootstrap text-white class for light theme */
        .footer .text-white {
            color: #6b7280 !important;
        }

        .footer .text-white:hover {
            color: #374151 !important;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .footer {
                padding: 40px 0 20px;
            }

            /* Keep outline borders on mobile */
            .footer .col-md-2,
            .footer .col-md-3,
            .footer .col-md-4 {
                border: 1px solid #e9ecef;
                border-radius: 6px;
                padding: 1.5rem 1rem;
                margin-bottom: 1rem;
                background-color: #ffffff;
            }

            .footer .col-md-4:first-child h5 {
                font-size: 1.3rem !important;
            }

            .footer h5.text-primary {
                font-size: 1rem;
                margin-bottom: 1rem !important;
            }

            .footer .col-md-3:last-child .mt-3 a {
                width: 32px;
                height: 32px;
                font-size: 0.8rem;
            }
        }
        /* About Us Modal Styles */
        .team-modal .modal-dialog {
            max-width: 1400px;
            margin: 1rem auto;
        }

        .team-modal .modal-content {
            border: none;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-xl);
            background: var(--white);
            position: relative;
        }

        /* Animated Background Pattern */
        .team-modal .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><g fill="%236c5ce7" fill-opacity="0.02"><circle cx="30" cy="30" r="4"/></g></g></svg>');
            pointer-events: none;
            z-index: 1;
        }

        /* Modal Header with Enhanced Design */
        .team-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 50%, var(--accent) 100%);
            color: var(--white);
            padding: 4rem 2rem 3rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            z-index: 2;
        }

        .team-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .team-header-content {
            position: relative;
            z-index: 3;
        }

        .team-header-content h2 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .team-header-content p {
            font-size: 1.4rem;
            opacity: 0.95;
            margin: 0;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 25px;
            background: rgba(255,255,255,0.15);
            border: none;
            color: var(--white);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            cursor: pointer;
            transition: var(--transition);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.2);
            z-index: 10;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.25);
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* Company Backing Section - Simplified */
        .company-backing {
            background: #f8f9ff;
            padding: 4rem 2rem;
            text-align: center;
            position: relative;
            border-bottom: 1px solid #e0e0e0;
            z-index: 2;
        }

        .company-content {
            position: relative;
            z-index: 3;
        }

        .backing-badge {
            display: inline-flex;
            align-items: center;
            background: #6c5ce7;
            color: #ffffff;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .mentorly-container {
            background: #ffffff;
            border-radius: 16px;
            padding: 3rem 2rem;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            border: 1px solid #e0e0e0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            max-width: 600px;
            margin: 0 auto;
        }

        .mentorly-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
        }

        .mentorly-logo {
            width: 200px;
            height: 200px;
            object-fit: contain;
            margin-bottom: 2rem;
            filter: drop-shadow(0 12px 35px rgba(0,0,0,0.2));
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 16px;
            background: #ffffff;
            padding: 25px;
            border: 1px solid #e0e0e0;
        }

        .mentorly-logo:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 12px 35px rgba(108, 92, 231, 0.2));
        }

        .company-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #2d3436;
        }

        .company-description {
            font-size: 1.1rem;
            color: #636e72;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        /* Team Section */
        .team-section {
            padding: 4rem 2rem 2rem;
            background: var(--white);
            position: relative;
            z-index: 2;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title h3 {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .section-title p {
            font-size: 1.2rem;
            color: var(--dark);
            opacity: 0.7;
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2.5rem;
            margin-bottom: 3rem;
        }

        /* Modern Profile Cards */
        .team-member {
            background: var(--white);
            border-radius: 20px;
            padding: 0;
            text-align: left;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: none;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            height: auto;
            min-height: 400px;
        }

        /* Card Header with Gradient */
        .card-header {
            padding: 24px 24px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            border-radius: 20px 20px 0 0;
            position: relative;
        }

        .profile-section {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        /* Redesigned Avatar */
        .member-avatar {
            width: 60px;
            height: 60px;
            margin: 0;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid rgba(255,255,255,0.3);
            box-shadow: none;
            flex-shrink: 0;
        }

        .member-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .profile-info {
            color: white;
            flex: 1;
        }

        .member-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.3rem;
            font-weight: 700;
            color: white;
            margin: 0 0 4px 0;
            letter-spacing: -0.02em;
        }

        .member-title {
            color: rgba(255,255,255,0.9);
            font-weight: 500;
            font-size: 0.9rem;
            margin: 0;
            text-transform: none;
            letter-spacing: normal;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Achievement Badge */
        .achievement-badge {
            background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 15px rgba(0,210,255,0.3);
        }

        /* Card Body */
        .card-body {
            padding: 24px;
        }

        /* Testimonial Quote */
        .testimonial-quote {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid;
            margin-bottom: 24px;
            position: relative;
            font-style: italic;
            line-height: 1.6;
            color: var(--dark);
            opacity: 0.8;
        }

        .testimonial-quote::before {
            content: '"';
            position: absolute;
            top: -5px;
            left: 15px;
            font-size: 3rem;
            opacity: 0.2;
            font-family: serif;
        }

        /* Social Links */
        .social-links {
            display: flex;
            justify-content: center;
            gap: 1.2rem;
            margin-top: 1.5rem;
        }

        .social-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            text-decoration: none;
            transition: var(--transition);
            font-size: 1.3rem;
            position: relative;
            overflow: hidden;
        }

        .social-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transition: var(--transition);
            transform: translate(-50%, -50%);
        }

        .social-btn:hover::before {
            width: 60px;
            height: 60px;
        }

        .social-btn i {
            position: relative;
            z-index: 2;
        }

        .social-btn.linkedin {
            background: linear-gradient(135deg, #0077B5, #005885);
        }

        .social-btn.github {
            background: linear-gradient(135deg, #333, #000);
        }

        .social-btn.phone {
            background: linear-gradient(135deg, var(--success), #00A085);
        }

        .social-btn:hover {
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 10px 25px rgba(0,0,0,0.25);
        }

        /* Different Card Themes */
        .team-member:nth-child(1) .card-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
        }

        .team-member:nth-child(1) .testimonial-quote {
            border-left-color: var(--primary);
            background: linear-gradient(135deg, rgba(108, 92, 231, 0.05) 0%, rgba(168, 155, 254, 0.05) 100%);
        }

        .team-member:nth-child(2) .card-header {
            background: linear-gradient(135deg, var(--accent) 0%, #ff6b9d 100%);
        }

        .team-member:nth-child(2) .testimonial-quote {
            border-left-color: var(--accent);
            background: linear-gradient(135deg, rgba(253, 121, 168, 0.05) 0%, rgba(255, 107, 157, 0.05) 100%);
        }

        .team-member:nth-child(3) .card-header {
            background: linear-gradient(135deg, var(--secondary) 0%, #55efc4 100%);
        }

        .team-member:nth-child(3) .testimonial-quote {
            border-left-color: var(--secondary);
            background: linear-gradient(135deg, rgba(0, 184, 148, 0.05) 0%, rgba(85, 239, 196, 0.05) 100%);
        }

        .team-member:nth-child(4) .card-header {
            background: linear-gradient(135deg, #e17055 0%, #fdcb6e 100%);
        }

        .team-member:nth-child(4) .testimonial-quote {
            border-left-color: #e17055;
            background: linear-gradient(135deg, rgba(225, 112, 85, 0.05) 0%, rgba(253, 203, 110, 0.05) 100%);
        }

        /* Hover Effects */
        .team-member:hover {
            transform: translateY(-8px);
            box-shadow: 0 16px 48px rgba(0,0,0,0.15);
        }

        .team-member:hover .member-avatar img {
            transform: scale(1.1);
        }

        /* Enhanced Mission Section */
        .mission-section {
            padding: 4rem 2rem;
            background: linear-gradient(135deg, rgba(108, 92, 231, 0.03) 0%, rgba(253, 121, 168, 0.03) 100%);
            position: relative;
            z-index: 2;
        }

        .mission-card {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
            background: var(--white);
            padding: 3rem;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(108, 92, 231, 0.1);
        }

        .mission-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 2rem;
            position: relative;
        }

        .mission-title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 3px;
        }

        .mission-text {
            font-size: 1.2rem;
            line-height: 1.8;
            color: var(--dark);
            opacity: 0.8;
            margin-bottom: 2rem;
        }

        .mission-highlight {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: var(--white);
            padding: 2rem 2.5rem;
            border-radius: var(--border-radius-lg);
            font-size: 1.3rem;
            font-weight: 600;
            margin-top: 2.5rem;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .mission-highlight::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 4s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        /* Enhanced Modal Footer */
        .modal-footer-custom {
            padding: 2.5rem;
            background: var(--light);
            border-top: 2px solid rgba(108, 92, 231, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem;
            z-index: 2;
            position: relative;
        }

        .btn-custom {
            padding: 1rem 2.5rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .btn-custom::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50px;
            background: rgba(255,255,255,0.2);
            transition: var(--transition);
            transform: translate(-50%, -50%);
        }

        .btn-custom:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-secondary-custom {
            background: var(--white);
            color: var(--dark);
            border: 2px solid var(--primary);
        }

        .btn-secondary-custom:hover {
            background: var(--primary);
            color: var(--white);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary-custom {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: var(--white);
            box-shadow: var(--shadow);
        }

        .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            background: linear-gradient(135deg, var(--primary-light), var(--accent));
            text-decoration: none;
            color: var(--white);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .team-modal .modal-dialog {
                margin: 0.5rem;
                max-width: calc(100vw - 1rem);
            }

            .team-header {
                padding: 3rem 1rem 2rem;
            }

            .team-header-content h2 {
                font-size: 2.5rem;
            }

            .team-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
                padding: 0;
            }

            .member-avatar {
                width: 50px;
                height: 50px;
            }

            .member-name {
                font-size: 1.1rem;
            }

            .mission-section, .team-section, .company-backing {
                padding: 3rem 1rem;
            }

            .mission-title, .section-title h3 {
                font-size: 2rem;
            }

            .company-title {
                font-size: 1.6rem;
            }

            .mentorly-logo {
                width: 120px;
                height: 120px;
            }

            .modal-footer-custom {
                flex-direction: column;
                gap: 1rem;
            }

            .btn-custom {
                width: 100%;
                justify-content: center;
            }
        }
        /* Modal Base Styles */
        /* Basic Modal Styles */
        .modal-content {
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            border: none;
        }

        .modal-header {
            border-bottom: 1px solid rgba(108, 92, 231, 0.1);
            padding: 1.5rem;
        }

        .modal-logo-container {
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .modal-logo {
            height: 35px;
            width: 35px;
        }

        .modal-site-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
        }

        .create-account-text {
            text-align: center;
            flex: 1;
        }

        .modal-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        .modal-body {
            padding: 2rem;
        }

        /* Form Styles */
        .form-label {
            font-weight: 500;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .form-control, .form-select {
            border: 1px solid rgba(108, 92, 231, 0.2);
            border-radius: var(--border-radius);
            padding: 0.75rem;
            transition: var(--transition);
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.2rem rgba(108, 92, 231, 0.1);
            outline: none;
        }

        .form-check {
            margin-bottom: 1rem;
        }

        .form-check-input {
            margin-right: 0.5rem;
        }

        /* Conditional Fields */
        .field-branch, .field-faculty, .field-subject,
        .field-softcopy, .field-fileupload,
        .field-working-condition, .field-warranty,
        .rent-field {
            display: none;
        }

        /* Terms Summary */
        .terms-summary {
            background: rgba(0, 184, 148, 0.1);
            padding: 1rem;
            border-radius: var(--border-radius);
            margin-top: 0.5rem;
        }

        .terms-summary li {
            margin-bottom: 0.5rem;
        }

        /* Mobile */
        @media (max-width: 768px) {
            .modal-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .col-md-6 {
                width: 100%;
            }
        }

        /* AI Chat Styles */
        .chat-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: var(--sidebar-width);
            height: 100vh;
            background: white;
            box-shadow: -5px 0 20px rgba(0,0,0,0.1);
            z-index: 1030; /* Reduced from 1050 to prevent navbar conflicts */
            transition: right 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
        }

        .chat-sidebar.open {
            right: 0;
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .chat-sidebar {
                width: var(--sidebar-width-mobile);
                right: -100vw;
            }
        }

        /* Chat Header */
        .chat-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between; /* Fixed: changed 'between' to 'space-between' */
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .chat-header h5 {
            margin: 0;
            flex: 1;
            font-weight: 600;
        }

        .chat-close-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
        }

        .chat-close-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Chat Messages Area */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background-color: #f8f9fa;
        }

        .message {
            max-width: 85%;
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 18px;
            position: relative;
            word-wrap: break-word;
            animation: slideInMessage 0.3s ease;
        }

        .message.received {
            background-color: white;
            margin-right: auto;
            margin-left: 0;
            border-bottom-left-radius: 5px;
            border: 1px solid #e9ecef;
        }

        .message.sent {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            margin-left: auto;
            margin-right: 0;
            border-bottom-right-radius: 5px;
        }

        .message-time {
            font-size: 0.7rem;
            color: #6c757d;
            margin-top: 5px;
            text-align: right;
        }

        .sent .message-time {
            color: rgba(255, 255, 255, 0.8);
        }

        /* AI Typing Indicator */
        .ai-typing {
            display: flex;
            align-items: center;
            color: #6c757d;
            font-style: italic;
            margin-bottom: 15px;
            padding: 12px 16px;
            background: white;
            border-radius: 18px;
            border-bottom-left-radius: 5px;
            max-width: 85%;
            border: 1px solid #e9ecef;
        }

        .typing-dots {
            display: inline-flex;
            margin-left: 8px;
        }

        .typing-dots span {
            height: 8px;
            width: 8px;
            margin: 0 2px;
            background-color: var(--primary);
            border-radius: 50%;
            display: inline-block;
            animation: typing 1.5s infinite ease-in-out;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        /* Chat Input Area */
        .chat-input {
            padding: 1rem;
            border-top: 1px solid #dee2e6;
            background-color: white;
        }

        .chat-input .form-control {
            border-radius: 25px;
            border: 2px solid #e9ecef;
            padding: 12px 20px;
            resize: none;
        }

        .chat-input .form-control:focus {
            border-color: var(--primary-light);
            box-shadow: 0 0 0 0.2rem rgba(108, 92, 231, 0.25);
        }

        .send-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3);
        }

        /* Floating Chat Button */
        .floating-chat-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1020; /* Lower than navbar but higher than most content */
            box-shadow: 0 4px 20px rgba(108, 92, 231, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-chat-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(108, 92, 231, 0.4);
        }

        .floating-chat-btn.hidden {
            display: none; /* Changed from transform: scale(0) for better compatibility */
        }

        /* Backdrop */
        .chat-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1010; /* Lower than navbar dropdown */
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .chat-backdrop.show {
            opacity: 1;
            visibility: visible;
        }

        /* Animations */
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.3;
            }
            30% {
                transform: translateY(-8px);
                opacity: 1;
            }
        }

        @keyframes slideInMessage {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Scrollbar Styling */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 10px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Online indicator */
        .online-indicator {
            width: 10px;
            height: 10px;
            background: #28a745;
            border-radius: 50%;
            margin-left: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Prevent body scrolling when chat is open */
        body.chat-open {
            overflow: hidden;
        }
        /* MODAL-ONLY CSS - Won't affect your existing site styles */
/* MODAL-ONLY CSS - Won't affect your existing site styles */

        /* Modal Dialog Sizing - Wider but Compact Height */
        #loginModal .modal-dialog {
            max-width: 480px; /* Increased width */
            margin: 1rem auto;
        }

        #registerModal .modal-dialog {
            max-width: 520px; /* Much wider for better form layout */
            margin: 1rem auto;
        }

        /* Modal Content */
        #loginModal .modal-content,
        #registerModal .modal-content {
            border: none;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
            overflow: hidden;
            background: #ffffff;
        }

        /* Modal Header Improvements - Properly Centered */
        #loginModal .modal-header,
        #registerModal .modal-header {
            background: #ffffff;
            border-bottom: 1px solid #e8eaed;
            padding: 0.75rem 2rem 0.25rem 2rem;
            position: relative;
            text-align: center;
        }

        #loginModal .modal-logo-container,
        #registerModal .modal-logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 0.25rem;
            width: 100%;
        }

        #loginModal .modal-logo,
        #registerModal .modal-logo {
            height: 24px;
            width: auto;
            margin-right: 8px;
        }

        #loginModal .modal-site-name,
        #registerModal .modal-site-name {
            font-size: 1rem;
            font-weight: 500;
            color: #5f6368;
        }

        #loginModal .create-account-text,
        #registerModal .create-account-text {
            display: flex;
            justify-content: center;
            width: 100%;
            margin-top: 0.25rem;
        }

        #loginModal .create-account-text .modal-title,
        #registerModal .create-account-text .modal-title {
            font-size: 1.25rem;
            font-weight: 500;
            color: #202124;
            margin: 0;
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            text-align: center;
        }

        /* Close Button - More Visible */
        #loginModal .btn-close,
        #registerModal .btn-close {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            opacity: 0.7;
            transition: all 0.2s ease;
            background: transparent;
            border: none;
            font-size: 1.5rem;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #5f6368;
            border-radius: 50%;
        }

        #loginModal .btn-close:hover,
        #registerModal .btn-close:hover {
            opacity: 1;
            background: #f1f3f4;
            color: #202124;
            transform: none;
        }

        #loginModal .btn-close::before,
        #registerModal .btn-close::before {
            content: '✕';
            font-size: 1.2rem;
            font-weight: 400;
            line-height: 1;
        }

        /* Modal Body - Wider with Better Spacing */
        #loginModal .modal-body,
        #registerModal .modal-body {
            padding: 0.5rem 2rem 1rem 2rem; /* Increased horizontal padding for wider feel */
        }

        /* Google Authentication Button - Much More Compact */
        #loginModal .google-login-btn,
        #registerModal .google-login-btn {
            background: #ffffff !important;
            border: 1px solid #dadce0 !important;
            color: #3c4043 !important;
            font-weight: 500 !important;
            padding: 0.5rem 1rem !important; /* Even smaller padding */
            border-radius: 4px !important;
            transition: all 0.2s ease !important;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem; /* Smaller gap */
            font-size: 0.875rem;
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            margin-bottom: 0.75rem; /* Much smaller margin */
        }

        #loginModal .google-login-btn:hover,
        #registerModal .google-login-btn:hover {
            background: #f8f9fa !important;
            border-color: #c6c6c6 !important;
            color: #174ea6 !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15), 0 1px 4px rgba(0,0,0,0.3) !important;
            transform: none;
        }

        #loginModal .google-login-btn:focus,
        #registerModal .google-login-btn:focus {
            background: #ffffff !important;
            border-color: #4285f4 !important;
            color: #174ea6 !important;
            box-shadow: 0 0 0 1px #4285f4 !important;
            outline: none;
        }

        #loginModal .google-login-btn:active,
        #registerModal .google-login-btn:active {
            background: #f1f3f4 !important;
            border-color: #c6c6c6 !important;
            color: #174ea6 !important;
            box-shadow: 0 1px 2px rgba(0,0,0,0.3) !important;
        }

        /* Google Icon - Multicolor Google Logo */
        #loginModal .google-login-btn .fab.fa-google,
        #registerModal .google-login-btn .fab.fa-google {
            color: #4285f4 !important;
            font-size: 1.1rem;
            background: linear-gradient(45deg, #4285f4 0%, #34a853 25%, #fbbc05 50%, #ea4335 75%, #4285f4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: normal;
        }

        /* OR Divider - Much More Compact */
        #loginModal .text-center .text-muted,
        #registerModal .text-center .text-muted {
            position: relative;
            padding: 0 1rem;
            background: #ffffff;
            color: #5f6368;
            font-size: 0.875rem;
            margin: 0.5rem 0; /* Much smaller margin */
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        }

        #loginModal .text-center .text-muted::before,
        #registerModal .text-center .text-muted::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -50px;
            right: -50px;
            height: 1px;
            background: #e8eaed;
            z-index: -1;
        }

        /* Form Improvements - Much More Compact */
        #loginModal .form-control,
        #registerModal .form-control,
        #loginModal .form-select,
        #registerModal .form-select {
            border: 1px solid #dadce0;
            border-radius: 4px;
            padding: 0.5rem 0.65rem; /* Much smaller padding */
            font-size: 0.875rem;
            transition: all 0.2s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #ffffff;
        }

        #loginModal .form-control:focus,
        #registerModal .form-control:focus,
        #loginModal .form-select:focus,
        #registerModal .form-select:focus {
            border-color: #4285f4;
            box-shadow: 0 0 0 1px #4285f4;
            outline: none;
        }

        /* Form Labels - More Compact */
        #loginModal .form-label,
        #registerModal .form-label {
            color: #202124;
            font-weight: 500;
            font-size: 0.875rem;
            margin-bottom: 0.25rem; /* Much smaller margin */
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        }

        /* Primary Register Button - Centered White Text */
        #loginModal .btn-primary,
        #registerModal .btn-primary {
            background: #1a73e8;
            border: 1px solid #1a73e8;
            border-radius: 4px;
            padding: 0.6rem 1.5rem;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            width: 100%;
            margin-top: 0.5rem;
            color: #ffffff !important; /* Force white text */
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        #loginModal .btn-primary:hover,
        #registerModal .btn-primary:hover {
            background: #1765cc;
            border-color: #1765cc;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            color: #ffffff !important; /* Force white text on hover */
        }

        #loginModal .btn-primary:focus,
        #registerModal .btn-primary:focus {
            background: #1765cc;
            border-color: #1765cc;
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.3);
            color: #ffffff !important; /* Force white text on focus */
        }

        #loginModal .btn-primary:active,
        #registerModal .btn-primary:active {
            background: #1557b0;
            border-color: #1557b0;
            color: #ffffff !important; /* Force white text when active */
        }

        /* Ensure icons in buttons are also white */
        #loginModal .btn-primary i,
        #registerModal .btn-primary i {
            color: #ffffff !important;
        }

        /* Links */
        #loginModal .forgot-password-link,
        #registerModal .form-check-label a,
        #loginModal .modal-body p a,
        #registerModal .modal-body p a {
            color: #1a73e8;
            font-weight: 500;
            transition: all 0.2s ease;
            font-size: 0.875rem;
        }

        #loginModal .forgot-password-link:hover,
        #registerModal .form-check-label a:hover,
        #loginModal .modal-body p a:hover,
        #registerModal .modal-body p a:hover {
            color: #1765cc;
            text-decoration: underline;
        }

        /* Register Modal - Better Grid Spacing for Wider Layout */
        #registerModal .row.g-3 {
            --bs-gutter-x: 1rem; /* Better horizontal spacing for wider modal */
            --bs-gutter-y: 0.25rem; /* Keep compact vertical spacing */
        }

        /* Checkbox styling */
        #registerModal .form-check-input:checked {
            background-color: #1a73e8;
            border-color: #1a73e8;
        }

        #registerModal .form-check-input:focus {
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.3);
        }

        #registerModal .form-check-label {
            font-size: 0.875rem;
            color: #5f6368;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        }

        /* MOBILE RESPONSIVE - Modal Only */
        @media (max-width: 768px) {
            #loginModal .modal-dialog,
            #registerModal .modal-dialog {
                margin: 1rem;
                max-width: calc(100% - 2rem);
            }

            #loginModal .modal-body,
            #registerModal .modal-body {
                padding: 1rem 1.5rem 1.5rem 1.5rem;
            }

            #loginModal .modal-header,
            #registerModal .modal-header {
                padding: 1.25rem 1.5rem 0.75rem 1.5rem;
            }
        }

        @media (max-width: 576px) {
            #loginModal .modal-dialog,
            #registerModal .modal-dialog {
                margin: 0.5rem;
                max-width: calc(100% - 1rem);
            }

            #loginModal .modal-body,
            #registerModal .modal-body {
                padding: 1rem;
            }

            #loginModal .modal-header,
            #registerModal .modal-header {
                padding: 1rem 1rem 0.5rem 1rem;
            }

            #registerModal .col-md-6 {
                flex: 0 0 100%;
                max-width: 100%;
            }

            #loginModal .create-account-text .modal-title,
            #registerModal .create-account-text .modal-title {
                font-size: 1.3rem;
            }
        }

        @media (max-width: 400px) {
            #loginModal .modal-dialog,
            #registerModal .modal-dialog {
                margin: 0.25rem;
                max-width: calc(100% - 0.5rem);
            }

            #loginModal .modal-body,
            #registerModal .modal-body {
                padding: 0.875rem;
            }

            #loginModal .modal-header,
            #registerModal .modal-header {
                padding: 0.875rem 0.875rem 0.375rem 0.875rem;
            }
        }
        .chat-button-container {
            position: fixed;
            right: 20px;
            bottom: 20px;
            z-index: 1050;
        }

        #chatFloatingBtn {
            background: transparent;
            border: none;
            border-radius: 50%;
            padding: 0;
            box-shadow: none;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #chatFloatingBtn:hover {
            background: transparent;
            transform: translateY(-8px) scale(1.1);
            box-shadow: none;
        }

        #chatFloatingBtn img {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            object-fit: contain;
            background: transparent;
            padding: 10px;
        }

        #unreadMessageCount {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #dc3545;
            color: white;
            border-radius: 50%;
            min-width: 20px;
            height: 20px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Mobile Responsive Styles */
        @media screen and (max-width: 768px) {
            .chat-button-container {
                right: 15px;
                bottom: 20px;
            }

            #chatFloatingBtn img {
                width: 130px;
                height: 130px;
                padding: 8px;
            }

            #chatFloatingBtn:hover {
                transform: translateY(-4px) scale(1.05);
            }

            #unreadMessageCount {
                min-width: 18px;
                height: 18px;
                font-size: 0.7rem;
                top: -3px;
                right: -3px;
            }
        }

        @media screen and (max-width: 480px) {
            .chat-button-container {
                right: 10px;
                bottom: 15px;
            }

            #chatFloatingBtn img {
                width: 110px;
                height: 110px;
                padding: 6px;
            }

            #chatFloatingBtn:hover {
                transform: translateY(-3px) scale(1.03);
            }

            #unreadMessageCount {
                min-width: 16px;
                height: 16px;
                font-size: 0.65rem;
                top: -2px;
                right: -2px;
            }
        }

        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            #chatFloatingBtn:hover {
                transform: none;
            }

            #chatFloatingBtn:active {
                transform: scale(0.95);
            }
        }
/* Step Form Styles - ADD THIS TO YOUR EXISTING <style> SECTION */
        .step-progress {
            margin-bottom: 2rem;
        }

        .step-progress-bar {
            height: 4px;
            background: #e9ecef;
            border-radius: 2px;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }

        .step-progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 2px;
            width: 20%;
            transition: width 0.3s ease;
        }

        .step-indicators {
            display: flex;
            justify-content: space-between;
        }

        .step-indicator {
            text-align: center;
            flex: 1;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .step-indicator.active .step-number {
            background: var(--primary);
            color: white;
        }

        .step-indicator.completed .step-number {
            background: var(--success);
            color: white;
        }

        .step-title {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 500;
        }

        .step-indicator.active .step-title {
            color: var(--primary);
            font-weight: 600;
        }

        .step-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .step-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .step-header h4 {
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .step-navigation {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Image Upload Styles */
        .image-upload-area {
            border: 2px dashed #dee2e6;
            border-radius: var(--border-radius);
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .image-upload-area:hover {
            border-color: var(--primary);
            background: rgba(108, 92, 231, 0.05);
        }

        .image-upload-label {
            display: block;
            cursor: pointer;
            margin: 0;
        }

        .upload-placeholder {
            padding: 3rem 2rem;
            text-align: center;
        }

        .preview-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
        }

        .image-actions {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        #imagePreviewContainer {
            position: relative;
        }

        /* Review Card */
        .review-card {
            background: var(--light);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid #dee2e6;
        }

        .review-image img {
            border-radius: var(--border-radius);
            max-height: 200px;
            width: 100%;
            object-fit: cover;
        }

        .review-meta {
            margin: 1rem 0;
        }

        .review-meta .badge {
            margin-right: 0.5rem;
        }

        .review-price h4 {
            font-weight: 700;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .step-indicators {
                gap: 0.5rem;
            }

            .step-number {
                width: 32px;
                height: 32px;
                font-size: 0.875rem;
            }

            .step-title {
                font-size: 0.75rem;
            }

            .upload-placeholder {
                padding: 2rem 1rem;
            }

            .step-navigation {
                flex-direction: column-reverse;
                gap: 0.5rem;
            }

            .step-navigation button {
                width: 100%;
            }
        }

        /* Form Control Enhancements */
        .form-control-lg, .form-select-lg {
            padding: 0.75rem 1rem;
            font-size: 1.1rem;
        }

        .btn-group .btn-check:checked + .btn {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }
        /* Category Navigation Styles */
        .category-nav-section {
            background: var(--white);
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
        }

        .category-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            max-width: 1000px;
            margin: 0 auto;
        }

        .category-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 2rem 1.5rem;
            background: var(--white);
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius-lg);
            text-decoration: none;
            color: var(--dark);
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .category-btn:hover {
            border-color: var(--primary);
            background: rgba(108, 92, 231, 0.05);
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            color: var(--primary);
        }

        .category-btn.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        .category-btn i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            opacity: 0.8;
        }

        .category-btn span {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .category-btn small {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .category-buttons {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }

            .category-btn {
                padding: 1.5rem 1rem;
            }

            .category-btn i {
                font-size: 2rem;
            }

            .category-btn span {
                font-size: 1rem;
            }
        }
        .breadcrumb-nav {
            background: var(--white);
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
            margin-bottom: 2rem;
        }

        .breadcrumb {
            background: none;
            margin: 0;
        }

        .breadcrumb-item a {
            color: var(--primary);
            text-decoration: none;
        }
        /* ============================================
   MODERN MOBILE MENU STYLES
   ============================================ */

/* Custom Hamburger Button */
        
       

    </style>
</head>
<body>




    <!-- Navigation -->
    <!-- Fixed Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container">
            <!-- Logo -->
            <a class="navbar-brand" href="/" style="flex-grow: 1; max-width: 400px;">
                <div class="logo-container">
                    <img src="https://i.ibb.co/Z05RbY8/logo-removebg-preview-5.png"
                        alt="StudentsMart - Learn.Sell.Repeat"
                        class="logo">
                </div>
            </a>
            
            <!-- Modern Hamburger Button -->
            <button class="navbar-toggler" type="button" onclick="toggleMobileMenu()">
                <div class="navbar-toggler-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            
            <!-- Navigation Menu -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Mobile Menu Header (Only visible on mobile) -->
                

                <!-- Navigation Items -->
                <ul class="navbar-nav ms-auto">
                    <!-- Admin Menu (Hidden by default) -->
                    <li class="nav-item dropdown d-none" id="adminMenu">
                        <a class="nav-link" href="#" onclick="showAdminDashboard()">
                            <i class="fas fa-tools me-2"></i>Admin Dashboard
                        </a>
                    </li>
                    
                    <!-- Reports Menu (Hidden by default) -->
                    <li class="nav-item d-none" id="reportsMenu">
                        <a class="nav-link" href="#" onclick="showAdminDashboard('reports')">
                            <i class="fas fa-flag me-2"></i>Reports
                            <span class="badge bg-danger" id="navReportsBadge">0</span>
                        </a>
                    </li>
                    
                    <!-- Auth Buttons (Shown when logged out - Desktop only) -->
                    <li class="nav-item" id="authButtons">
                        <button class="btn btn-outline-primary me-2" onclick="showLoginModal()">
                            <i class="fas fa-sign-in-alt me-2"></i>Login
                        </button>
                        <button class="btn btn-primary" onclick="showRegisterModal()">
                            <i class="fas fa-user-plus me-2"></i>Register
                        </button>
                    </li>
                    
                    <!-- Notifications Menu (Hidden by default) -->
                    <li class="nav-item d-none" id="notificationMenu">
                        <a class="nav-link position-relative" href="/notifications">
                            <i class="fas fa-bell"></i>
                            <span id="notificationBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display: none;">
                                0
                            </span>
                            Notifications
                        </a>
                    </li>
                    
                    <!-- User Menu Dropdown (Hidden by default - Shown when logged in) -->
                    <li class="nav-item dropdown d-none" id="userMenu">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-2"></i><span id="userName"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="showMyListings()">
                                <i class="fas fa-list me-2"></i>My Listings
                            </a></li>
                            <li><a class="dropdown-item" href="#" onclick="showWishlist()">
                                <i class="fas fa-heart me-2"></i>Wishlist
                            </a></li>
                            <li><a class="dropdown-item" href="/profiledashboard">
                                <i class="fas fa-user me-2"></i>Profile Dashboard
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()">
                                <i class="fas fa-sign-out-alt me-2"></i>Logout
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <span class="hero-badge">
                    <i class="fas fa-bolt"></i>
                    <span>Made by Students . Made for Students</span>
                </span>
                <h1 class="hero-title">
                    <span class="hero-gradient">Buy, Sell & Rent</span><br>
                    Campus Needs
                </h1>

                <!-- Search Bar -->
                <div class="search-container">
                    <div class="search-wrapper">
                        <input type="text" class="search-input" placeholder="Search textbooks, calculators, laptops..." id="searchInput">
                        <button class="search-btn" onclick="handleSearch()">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div class="quick-search">
                        <span class="quick-tag" onclick="quickSearch('textbooks')">📚 Textbooks</span>
                        <span class="quick-tag" onclick="quickSearch('calculator')">🧮 Calculator</span>
                        <span class="quick-tag" onclick="quickSearch('laptop')">💻 Laptop</span>
                        <span class="quick-tag" onclick="quickSearch('notes')">📝 Notes</span>
                    </div>
                </div>

                <div class="hero-cta">
                    <button class="btn btn-accent" onclick="handlePathSelection('sell')">
                        <i class="fas fa-plus-circle"></i>
                        List an Item
                    </button>
                    <button class="btn btn-secondary" onclick="handlePathSelection('buy')">
                        <i class="fas fa-search"></i>
                        Browse Marketplace
                    </button>
                </div>
            </div>

            <!-- Image Carousel -->
            <div class="hero-carousel">
                <div class="carousel-container">
                    <div class="carousel-slide">
                        <img src="https://i.ibb.co/9DRMfyN/Gemini-Generated-Image-drcrsidrcrsidrcr.png" alt="StudentsMart Marketplace" class="carousel-image">
                        <div class="carousel-overlay">
                            <h3 class="carousel-title">📚 Your Campus Marketplace</h3>
                            <p class="carousel-desc">Connect with students, trade essentials, save money</p>
                        </div>
                    </div>
                    <div class="carousel-slide">
                        <img src="https://i.ibb.co/FbGFh8fq/Untitled-design.png" alt="Student Community" class="carousel-image">
                        <div class="carousel-overlay">
                            <h3 class="carousel-title">🎓 Student Community</h3>
                            <p class="carousel-desc">Buy, sell, rent with trusted peers on campus</p>
                        </div>
                    </div>
                    <div class="carousel-slide">
                        <img src="https://i.ibb.co/twVzqrsc/In-Shot-20250817-185805208.jpg" alt="Study Together" class="carousel-image">
                        <div class="carousel-overlay">
                            <h3 class="carousel-title">💡 Smart Savings</h3>
                            <p class="carousel-desc">Save up to 70% on textbooks and study materials</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats Section -->

    <!-- Categories Section -->
    <section class="categories">
        <div class="categories-container">
            <div class="section-header animate">
                <h2 class="section-title">Shop by Category</h2>
                <p class="section-subtitle">Find exactly what you need for your studies</p>
            </div>

            <div class="categories-carousel-wrapper">
                <div class="categories-carousel">
                    <!-- First set of categories -->
                    <div class="category-card" onclick="handleCategory('Textbooks')">
                        <div class="category-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3 class="category-name">Textbooks</h3>
                        <p class="category-desc">Course books, reference materials, study guides for all subjects</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Calculators')">
                        <div class="category-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <h3 class="category-name">Calculators</h3>
                        <p class="category-desc">Scientific, graphing, financial calculators for all courses</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Lab Equipment')">
                        <div class="category-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <h3 class="category-name">Lab Equipment</h3>
                        <p class="category-desc">Lab kits, instruments, safety gear for science students</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Tech & Gadgets')">
                        <div class="category-icon">
                            <i class="fas fa-laptop"></i>
                        </div>
                        <h3 class="category-name">Tech & Gadgets</h3>
                        <p class="category-desc">Laptops, tablets, accessories for modern students</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Notes & Guides')">
                        <div class="category-icon">
                            <i class="fas fa-sticky-note"></i>
                        </div>
                        <h3 class="category-name">Notes & Guides</h3>
                        <p class="category-desc">Study notes, exam guides, cheat sheets from top students</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Art Supplies')">
                        <div class="category-icon">
                            <i class="fas fa-palette"></i>
                        </div>
                        <h3 class="category-name">Art Supplies</h3>
                        <p class="category-desc">Drawing tools, paints, canvases for creative students</p>
                    </div>

                    <!-- Duplicate set for infinite scroll -->
                    <div class="category-card" onclick="handleCategory('Textbooks')">
                        <div class="category-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <h3 class="category-name">Textbooks</h3>
                        <p class="category-desc">Course books, reference materials, study guides for all subjects</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Calculators')">
                        <div class="category-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <h3 class="category-name">Calculators</h3>
                        <p class="category-desc">Scientific, graphing, financial calculators for all courses</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Lab Equipment')">
                        <div class="category-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <h3 class="category-name">Lab Equipment</h3>
                        <p class="category-desc">Lab kits, instruments, safety gear for science students</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Tech & Gadgets')">
                        <div class="category-icon">
                            <i class="fas fa-laptop"></i>
                        </div>
                        <h3 class="category-name">Tech & Gadgets</h3>
                        <p class="category-desc">Laptops, tablets, accessories for modern students</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Notes & Guides')">
                        <div class="category-icon">
                            <i class="fas fa-sticky-note"></i>
                        </div>
                        <h3 class="category-name">Notes & Guides</h3>
                        <p class="category-desc">Study notes, exam guides, cheat sheets from top students</p>
                    </div>

                    <div class="category-card" onclick="handleCategory('Art Supplies')">
                        <div class="category-icon">
                            <i class="fas fa-palette"></i>
                        </div>
                        <h3 class="category-name">Art Supplies</h3>
                        <p class="category-desc">Drawing tools, paints, canvases for creative students</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Section -->
    <section class="featured">
        <div class="featured-container">
            <div class="section-header animate">
                <h2 class="section-title">Trending This Week</h2>
                <p class="section-subtitle">Popular picks from your campus community</p>
            </div>

            <div class="featured-grid">
                <div class="featured-card animate">
                    <div class="card-badge">HOT</div>
                    <img src="https://i.ibb.co/xS4TZtwQ/casio-jpeg.jpg" alt="Casio Calculator" class="card-image">
                    <h3 class="card-title">Casio FX-991ES Plus</h3>
                    <p class="card-subtitle">
                        <i class="fas fa-star" style="color: #FDCB6E;"></i>
                        <span>4.9 • Excellent condition</span>
                    </p>
                    <div class="price-section">
                        <span class="price">₹60/day</span>
                        <button class="price-btn" onclick="handlePrice('rent', 'Casio FX-991ES Plus', '₹60/day')">
                            <i class="fas fa-shopping-cart"></i> Rent Now
                        </button>
                    </div>
                </div>

                <div class="featured-card animate">
                    <div class="card-badge">NEW</div>
                    <img src="https://i.ibb.co/d067QFGB/signals-systems-2nd-ED-jpeg.jpg" alt="Signals & Systems Textbook" class="card-image">
                    <h3 class="card-title">Signals & Systems (2nd Ed)</h3>
                    <p class="card-subtitle">
                        <i class="fas fa-star" style="color: #FDCB6E;"></i>
                        <span>4.7 • Like new condition</span>
                    </p>
                    <div class="price-section">
                        <span class="price">₹450</span>
                        <button class="price-btn" onclick="handlePrice('buy', 'Signals & Systems', '₹450')">
                            <i class="fas fa-shopping-cart"></i> Buy Now
                        </button>
                    </div>
                </div>

                <div class="featured-card animate">
                    <div class="card-badge">DEAL</div>
                    <img src="https://i.ibb.co/Q71Y2h0S/image-Compound-Microscope-2.png" alt="Microscope" class="card-image">
                    <h3 class="card-title">Compound Microscope</h3>
                    <p class="card-subtitle">
                        <i class="fas fa-star" style="color: #FDCB6E;"></i>
                        <span>4.8 • Lab quality</span>
                    </p>
                    <div class="price-section">
                        <span class="price">₹120/day</span>
                        <button class="price-btn" onclick="handlePrice('rent', 'Compound Microscope', '₹120/day')">
                            <i class="fas fa-shopping-cart"></i> Rent Now
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Stories -->
    <section class="success-stories">
        <div class="success-container">
            <div class="success-header animate">
                <h2 class="section-title">Student Success Stories</h2>
                <p class="section-subtitle">Real students making real money with their unused items</p>
            </div>

            <div class="student-cards">
                <div class="student-card animate">
                    <div class="student-profile">
                        <img src="https://i.ibb.co/xtqXLdH2/Swethasai.jpg" alt="Rahul Patel" class="student-avatar">
                        <div class="student-info">
                            <h4>Swetha Sai</h4>
                            <p class="college">BTech,Vemu Institute of Technology</p>
                            <div class="earnings-badge">
                                <i class="fas fa-coins"></i>
                                <span>Listed 2 Items</span>
                            </div>
                        </div>
                    </div>

                    <p class="student-quote">
                        StudentsMart is amazing! 💻 ⚡,I have listed my Books for sale
                    </p>

                    <div class="student-stats">
                        <div class="stat-group">
                            <span class="stat-number">4</span>
                            <span class="stat-label">Items</span>
                        </div>
                        <div class="stat-group">
                            <span class="stat-number">1</span>
                            <span class="stat-label">Months</span>
                        </div>
                        <div class="stat-group">
                            <div class="student-rating">
                                <span class="star">★</span>
                                <span class="rating-text">5.0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="student-card animate">
                    <div class="student-profile">
                        <img src="https://i.ibb.co/Qj3Z7gVC/karthik.jpg" alt="Karthik" class="student-avatar">
                        <div class="student-info">
                            <h4>Karthik</h4>
                            <p class="college">BTech,Vemu Institute of Technology</p>
                            <div class="earnings-badge">
                                <i class="fas fa-coins"></i>
                                <span>Listed 5 Items</span>
                            </div>
                        </div>
                    </div>

                    <p class="student-quote">
                        Rented my Calci and Apron. Now I can get my pocket money! StudentsMart made me financially independent! 🩺 📚
                    </p>

                    <div class="student-stats">
                        <div class="stat-group">
                            <span class="stat-number">5</span>
                            <span class="stat-label">Items</span>
                        </div>
                        <div class="stat-group">
                            <span class="stat-number">1</span>
                            <span class="stat-label">Month</span>
                        </div>
                        <div class="stat-group">
                            <div class="student-rating">
                                <span class="star">★</span>
                                <span class="rating-text">5.0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="student-card animate">
                    <div class="student-profile">
                        <img src="https://i.ibb.co/pvR3r1ZL/karna.jpg" alt="Karna Karan" class="student-avatar">
                        <div class="student-info">
                            <h4>Karuna Karan</h4>
                            <p class="college">BTech,Vemu Institute of Technology</p>
                            <div class="earnings-badge">
                                <i class="fas fa-coins"></i>
                                <span>Listed 3 Items</span>
                            </div>
                        </div>
                    </div>

                    <p class="student-quote">
                        Sold my study books and business calculator. Earned enough for my food expenses! This platform is a goldmine! 💎 📊
                    </p>

                    <div class="student-stats">
                        <div class="stat-group">
                            <span class="stat-number">3</span>
                            <span class="stat-label">Items</span>
                        </div>
                        <div class="stat-group">
                            <span class="stat-number">1</span>
                            <span class="stat-label">Month</span>
                        </div>
                        <div class="stat-group">
                            <div class="student-rating">
                                <span class="star">★</span>
                                <span class="rating-text">5.0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <div class="modal fade" id="adminLoginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Admin Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="adminLoginForm">
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Password</label>
                            <input type="password" class="form-control" name="password" required>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-lock me-2"></i>Admin Login
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>



    <!-- Search Section -->


        <!-- Listings Grid -->


    <!-- Modals -->
    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-logo-container">
                        <img src="https://i.ibb.co/1YBpx2KS/logo.png" alt="StudentsMart" class="modal-logo">
                        <span class="modal-site-name">Welcome BacK</span>
                    </div>

                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- Google Login Button -->
                    <div class="d-grid mb-3">
                        <button type="button" class="btn btn-outline-danger btn-lg google-login-btn" onclick="initiateGoogleLogin()">
                            <i class="fab fa-google me-2"></i>Continue with Google
                        </button>
                    </div>

                    <div class="text-center mb-3">
                        <span class="text-muted">or</span>
                    </div>

                    <form id="loginForm">
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Password</label>
                            <input type="password" class="form-control" name="password" required>
                        </div>

                        <!-- Forgot Password Link -->
                        <div class="text-end mb-3">
                            <a href="#" class="text-decoration-none forgot-password-link" id="forgotPasswordLink">
                                Forgot Password?
                            </a>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt me-2"></i>Login
                            </button>
                        </div>
                        <div class="text-center mt-3">
                            <p>Don't have an account? <a href="#" onclick="showRegisterModalFromLogin()">Register here</a></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- UPDATED REGISTER MODAL (Add Google registration option) -->
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-logo-container">
                        <img src="https://i.ibb.co/1YBpx2KS/logo.png" alt="StudentsMart" class="modal-logo">
                        <span class="modal-site-name">Create Account</span>
                    </div>

                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- Google Registration Button -->
                    <div class="d-grid mb-3">
                        <button type="button" class="btn btn-outline-danger btn-lg google-login-btn" onclick="initiateGoogleLogin()">
                            <i class="fab fa-google me-2"></i>Sign up with Google
                        </button>
                    </div>

                    <div class="text-center mb-3">
                        <span class="text-muted">or</span>
                    </div>

                    <form id="registerForm">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" name="email" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Full Name</label>
                                <input type="text" class="form-control" name="full_name" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Department</label>
                                <input type="text" class="form-control" name="department" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Year</label>
                                <select class="form-select" name="year" required>
                                    <option value="">Select Year</option>
                                    <option value="1">1st Year</option>
                                    <option value="2">2nd Year</option>
                                    <option value="3">3rd Year</option>
                                    <option value="4">4th Year</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label class="form-label">College</label>
                                <select class="form-select" name="college" id="collegeSelect" required>
                                    <option value="">Select Your College</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Roll Number (Optional)</label>
                                <input type="text" class="form-control" name="roll_number" placeholder="Your college roll number (optional)">
                            </div>
                            <div class="col-12">
                                <label class="form-label">Password</label>
                                <input type="password" class="form-control" name="password" required minlength="6">
                                <small class="text-muted">Password must be at least 6 characters long</small>
                            </div>
                            <div class="col-12">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="acceptTerms" required>
                                    <label class="form-check-label" for="acceptTerms">
                                        I agree to the <a href="#" onclick="showTermsModal()">Terms and Conditions</a>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="d-grid mt-4">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-user-plus me-2"></i>Register
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
        <div class="container">
        <div class="search-section">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                        <input type="text" class="form-control" id="searchInput" placeholder="Search items...">
                    </div>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="collegeFilter">
                        <option value="">All Colleges</option>
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="categoryFilter">
                        <option value="">All Categories</option>
                        <option value="electronic">Electronic</option>
                        <option value="books">Books</option>
                        <option value="clothes">Clothes</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="sortFilter">
                        <option value="newest">Newest First</option>
                        <option value="price_low">Price: Low to High</option>
                        <option value="price_high">Price: High to Low</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="row g-4" id="listingsGrid">
            <!-- Listings will be dynamically added here -->
        </div>

        <!-- Loading Skeleton -->
        <div class="row g-4" id="loadingSkeleton" style="display: none;">
            <!-- Skeleton cards will be added here -->
        </div>
    </div>
    <div id="listingsSection" style="display: none;">
        <!-- Your existing search-section and listings grid will go here -->
        <div class="container">
            <div class="search-section">
                <!-- Your existing search section content -->
            </div>
            <div class="row g-4" id="listingsGrid">
                <!-- Listings will be dynamically added here -->
            </div>
        </div>
    </div>

    <!-- Register Modal -->


    <!-- Create Listing Modal -->
    <!-- Create Listing Modal -->
<!-- Create Listing Modal -->
    <div class="modal fade" id="createListingModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <div class="w-100">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="modal-title">Create New Listing</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>

                        <!-- Step Progress Indicator -->
                        <div class="step-progress">
                            <div class="step-progress-bar">
                                <div class="step-progress-fill" id="progressBar"></div>
                            </div>
                            <div class="step-indicators">
                                <div class="step-indicator active" data-step="1">
                                    <div class="step-number">1</div>
                                    <div class="step-title">Category</div>
                                </div>
                                <div class="step-indicator" data-step="2">
                                    <div class="step-number">2</div>
                                    <div class="step-title">Details</div>
                                </div>
                                <div class="step-indicator" data-step="3">
                                    <div class="step-number">3</div>
                                    <div class="step-title">Pricing</div>
                                </div>
                                <div class="step-indicator" data-step="4">
                                    <div class="step-number">4</div>
                                    <div class="step-title">Image</div>
                                </div>
                                <div class="step-indicator" data-step="5">
                                    <div class="step-number">5</div>
                                    <div class="step-title">Review</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-body">
                    <form id="createListingForm" enctype="multipart/form-data">
                        <!-- Step 1: Category Selection -->
                        <div class="step-content active" data-step="1">
                            <div class="step-header">
                                <h4>Choose Your Category</h4>
                                <p class="text-muted">Select the category that best describes your item</p>
                            </div>

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Category *</label>
                                    <select class="form-select form-select-lg" name="category" id="listingCategory" required>
                                        <option value="">Select Category</option>
                                        <option value="electronic">📱 Electronics</option>
                                        <option value="books">📚 Books</option>
                                        <option value="clothes">👕 Clothes</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label">Product Type *</label>
                                    <select class="form-select form-select-lg" name="product_type" id="productType" required>
                                        <option value="">Select Product Type</option>
                                    </select>
                                </div>

                                <div class="col-12">
                                    <label for="academicYear" class="form-label">Academic Year *</label>
                                    <select class="form-select form-select-lg" id="academicYear" name="study_year" required>
                                        <option value="" selected disabled>Select Academic Year</option>
                                        <option value="1">🎓 1st Year</option>
                                        <option value="2">🎓 2nd Year</option>
                                        <option value="3">🎓 3rd Year</option>
                                        <option value="4">🎓 4th Year</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Details -->
                        <div class="step-content" data-step="2">
                            <div class="step-header">
                                <h4>Product Details</h4>
                                <p class="text-muted">Provide detailed information about your item</p>
                            </div>

                            <div class="row g-3">
                                <div class="col-12">
                                    <label class="form-label">Title *</label>
                                    <input type="text" class="form-control form-control-lg" name="title"
                                        placeholder="Enter a descriptive title for your item" required>
                                </div>

                                <div class="col-12">
                                    <label class="form-label">Description *</label>
                                    <textarea class="form-control" name="description" rows="4"
                                            placeholder="Describe your item's condition, features, and any other relevant details..." required></textarea>
                                </div>

                                <!-- Conditional fields that will be shown based on category -->
                                <div class="col-md-6 field-branch" style="display: none;">
                                    <label class="form-label">Branch</label>
                                    <select class="form-select" name="branch">
                                        <option value="">Select Branch</option>
                                        <option value="CSE">CSE</option>
                                        <option value="ECE">ECE</option>
                                        <option value="EEE">EEE</option>
                                        <option value="MECH">MECH</option>
                                        <option value="CIVIL">CIVIL</option>
                                    </select>
                                </div>

                                <div class="col-md-6 field-faculty" style="display: none;">
                                    <label class="form-label">Faculty Name</label>
                                    <input type="text" class="form-control" name="faculty_name" placeholder="Enter faculty name">
                                </div>

                                <div class="col-md-6 field-subject" style="display: none;">
                                    <label class="form-label">Subject</label>
                                    <input type="text" class="form-control" name="subject" placeholder="Enter subject">
                                </div>

                                <div class="col-md-6 field-softcopy" style="display: none;">
                                    <label class="form-label">Copy Type</label>
                                    <div class="btn-group w-100" role="group">
                                        <input type="radio" class="btn-check" name="copy_type" id="softCopy" value="soft">
                                        <label class="btn btn-outline-primary" for="softCopy">📱 Soft Copy</label>

                                        <input type="radio" class="btn-check" name="copy_type" id="hardCopy" value="hard" checked>
                                        <label class="btn btn-outline-primary" for="hardCopy">📖 Hard Copy</label>
                                    </div>
                                </div>

                                <div class="col-12 field-fileupload" style="display: none;">
                                    <label class="form-label">Upload PDF/Document</label>
                                    <input type="file" class="form-control" name="document" accept=".pdf,.doc,.docx">
                                </div>

                                <div class="col-md-6 field-working-condition" style="display: none;">
                                    <label class="form-label">Working Condition</label>
                                    <select class="form-select" name="working_condition">
                                        <option value="">Select Condition</option>
                                        <option value="Fully functional">✅ Fully functional</option>
                                        <option value="Needs repair">⚠️ Needs repair</option>
                                    </select>
                                </div>

                                <div class="col-md-6 field-warranty" style="display: none;">
                                    <label class="form-label">Warranty Status</label>
                                    <select class="form-select" name="warranty_status">
                                        <option value="">Select Warranty Status</option>
                                        <option value="No">❌ No Warranty</option>
                                        <option value="Yes">✅ Under Warranty</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Pricing -->
                        <div class="step-content" data-step="3">
                            <div class="step-header">
                                <h4>Set Your Price</h4>
                                <p class="text-muted">Choose how you want to sell your item</p>
                            </div>

                            <div class="row g-3">
                                <div class="col-12">
                                    <label class="form-label">Listing Type *</label>
                                    <div class="btn-group w-100" role="group">
                                        <input type="radio" class="btn-check" name="listing_type" id="sellType" value="sell" checked>
                                        <label class="btn btn-outline-success btn-lg" for="sellType">
                                            <i class="fas fa-tags me-2"></i>Sell
                                        </label>

                                        <input type="radio" class="btn-check" name="listing_type" id="rentType" value="rent">
                                        <label class="btn btn-outline-info btn-lg" for="rentType">
                                            <i class="fas fa-clock me-2"></i>Rent
                                        </label>
                                    </div>
                                </div>

                                <div class="col-12" id="sellPriceField">
                                    <label class="form-label">Selling Price (₹) *</label>
                                    <input type="number" class="form-control form-control-lg" name="price"
                                        placeholder="Enter selling price" min="0" required>
                                </div>

                                <div class="col-md-6 rent-field" id="rentPriceField" style="display: none;">
                                    <label class="form-label">Rental Price (₹/day) *</label>
                                    <input type="number" class="form-control" name="rent_price"
                                        placeholder="Daily rental rate" min="0">
                                </div>

                                <div class="col-md-6 rent-field" id="rentTenureField" style="display: none;">
                                    <label class="form-label">Maximum Rental Days *</label>
                                    <input type="number" class="form-control" name="rent_tenure"
                                        placeholder="Maximum rental period" min="1">
                                </div>
                            </div>
                        </div>

                        <!-- Step 4: Image Upload -->
                        <div class="step-content" data-step="4">
                            <div class="step-header">
                                <h4>Add Product Image</h4>
                                <p class="text-muted">Upload a clear image of your item to attract buyers</p>
                            </div>

                            <div class="row g-3">
                                <div class="col-12">
                                    <div class="image-upload-area">
                                        <input type="file" class="form-control d-none" name="image" id="imageInput" accept="image/*" required>
                                        <label for="imageInput" class="image-upload-label">
                                            <div class="upload-placeholder" id="uploadPlaceholder">
                                                <i class="fas fa-cloud-upload-alt fa-3x mb-3 text-muted"></i>
                                                <h5>Click to upload image</h5>
                                                <p class="text-muted">JPG, PNG or GIF (Max 5MB)</p>
                                            </div>
                                            <div id="imagePreviewContainer" style="display: none;">
                                                <img id="imagePreview" src="" alt="Preview" class="preview-image">
                                                <div class="image-actions">
                                                    <button type="button" class="btn btn-sm btn-outline-danger" onclick="removeImage()">
                                                        <i class="fas fa-trash"></i> Remove
                                                    </button>
                                                </div>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 5: Review -->
                        <div class="step-content" data-step="5">
                            <div class="step-header">
                                <h4>Review Your Listing</h4>
                                <p class="text-muted">Please review all information before creating your listing</p>
                            </div>

                            <div class="review-card">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="review-image">
                                            <img id="reviewImage" src="" alt="Product" class="img-fluid rounded">
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="review-details">
                                            <h5 id="reviewTitle">Product Title</h5>
                                            <div class="review-meta">
                                                <span class="badge bg-primary" id="reviewCategory">Category</span>
                                                <span class="badge bg-secondary" id="reviewProductType">Product Type</span>
                                                <span class="badge bg-info" id="reviewYear">Academic Year</span>
                                            </div>
                                            <p id="reviewDescription" class="mt-2 text-muted">Product description...</p>
                                            <div class="review-price">
                                                <h4 id="reviewPriceDisplay" class="text-success mb-0">₹0</h4>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 mt-4">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input" name="is_fake_warning" id="fakeWarning" required>
                                    <label class="form-check-label" for="fakeWarning">
                                        <strong>I confirm that this product is genuine and the information provided is accurate</strong>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer border-0">
                    <div class="step-navigation w-100">
                        <button type="button" class="btn btn-outline-secondary" id="prevBtn" onclick="changeStep(-1)" style="display: none;">
                            <i class="fas fa-arrow-left me-2"></i>Previous
                        </button>
                        <div class="flex-grow-1"></div>
                        <button type="button" class="btn btn-primary" id="nextBtn" onclick="changeStep(1)">
                            Next<i class="fas fa-arrow-right ms-2"></i>
                        </button>
                        <button type="submit" class="btn btn-success" id="submitBtn" style="display: none;" form="createListingForm">
                            <i class="fas fa-plus-circle me-2"></i>Create Listing
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Add this right before the closing </body> tag -->
    <!-- Chat Modal -->
<!-- Chat Modal -->
    <!-- Chat Modal -->
   <!-- Chat Modal -->

    <!-- Admin Dashboard Modal -->
   <!-- Enhanced Admin Dashboard Modal -->
  <!-- Admin Dashboard Modal -->
    <!-- Update the Admin Dashboard Modal section in index.html -->
   <!-- Admin Dashboard Modal -->
    <div class="modal fade" id="adminDashboardModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">Admin Dashboard</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="container-fluid">
                        <div class="row">
                            <!-- Sidebar -->
                            <div class="col-md-3 col-lg-2 bg-light p-0 border-end">
                                <div class="d-flex flex-column h-100">
                                    <div class="p-3 border-bottom">
                                        <div class="d-flex align-items-center">
                                            <div class="me-2">
                                                <i class="fas fa-user-shield fs-4 text-primary"></i>
                                            </div>
                                            <div>
                                                <h6 class="mb-0">Admin Panel</h6>
                                                <small class="text-muted">Welcome, ${currentUser.full_name}</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="nav flex-column nav-pills p-3" id="adminTabs" role="tablist">
                                        <button class="nav-link active" id="dashboard-tab" data-bs-toggle="pill" data-bs-target="#dashboard" type="button" role="tab">
                                            <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                                        </button>
                                        <button class="nav-link" id="users-tab" data-bs-toggle="pill" data-bs-target="#users" type="button" role="tab">
                                            <i class="fas fa-users me-2"></i> Users
                                        </button>
                                        <button class="nav-link" id="listings-tab" data-bs-toggle="pill" data-bs-target="#listings" type="button" role="tab">
                                            <i class="fas fa-list me-2"></i> Listings
                                        </button>
                                        <button class="nav-link" id="reports-tab" data-bs-toggle="pill" data-bs-target="#reports" type="button" role="tab">
                                            <i class="fas fa-flag me-2"></i> Reports
                                            <span class="badge bg-danger ms-2" id="reportsBadge">0</span>
                                        </button>
                                        <button class="nav-link" id="colleges-tab" data-bs-toggle="pill" data-bs-target="#colleges" type="button" role="tab">
                                            <i class="fas fa-university me-2"></i> Colleges
                                        </button>
                                        <button class="nav-link" id="activity-tab" data-bs-toggle="pill" data-bs-target="#activity" type="button" role="tab">
                                            <i class="fas fa-history me-2"></i> Activity Log
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Main Content -->
                            <div class="col-md-9 col-lg-10 p-4">
                                <div class="tab-content">
                                    <!-- Dashboard Tab -->
                                    <div class="tab-pane fade show active" id="dashboard" role="tabpanel">
                                        <div class="row mb-4">
                                            <div class="col-md-3">
                                                <div class="card bg-primary text-white">
                                                    <div class="card-body">
                                                        <h5 class="card-title">Total Users</h5>
                                                        <h2 id="totalUsers">0</h2>
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <small>Last 30 days: <span id="newUsers">0</span></small>
                                                            <i class="fas fa-users fs-4"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="card bg-success text-white">
                                                    <div class="card-body">
                                                        <h5 class="card-title">Verified Users</h5>
                                                        <h2 id="verifiedUsers">0</h2>
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <small>Unverified: <span id="unverifiedUsers">0</span></small>
                                                            <i class="fas fa-user-check fs-4"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="card bg-info text-white">
                                                    <div class="card-body">
                                                        <h5 class="card-title">Total Listings</h5>
                                                        <h2 id="totalListings">0</h2>
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <small>Last 30 days: <span id="newListings">0</span></small>
                                                            <i class="fas fa-list-alt fs-4"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="card bg-warning text-dark">
                                                    <div class="card-body">
                                                        <h5 class="card-title">Fake Warnings</h5>
                                                        <h2 id="fakeWarnings">0</h2>
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <small>Pending: <span id="pendingReports">0</span></small>
                                                            <i class="fas fa-exclamation-triangle fs-4"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Sales Analytics Row -->
                                            <div class="row mb-4">
                                                <div class="col-md-3">
                                                    <div class="card bg-success text-white">
                                                        <div class="card-body">
                                                            <h5 class="card-title">Total Sales</h5>
                                                            <h2 id="totalSalesCount">0</h2>
                                                            <div class="d-flex justify-content-between align-items-center">
                                                                <small>Confirmed transactions</small>
                                                                <i class="fas fa-check-circle fs-4"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="card bg-warning text-dark">
                                                        <div class="card-body">
                                                            <h5 class="card-title">Pending Sales</h5>
                                                            <h2 id="pendingSalesCount">0</h2>
                                                            <div class="d-flex justify-content-between align-items-center">
                                                                <small>Awaiting buyer confirmation</small>
                                                                <i class="fas fa-hourglass-half fs-4"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="card bg-info text-white">
                                                        <div class="card-body">
                                                            <h5 class="card-title">Recent Sales</h5>
                                                            <h2 id="recentSalesCount">0</h2>
                                                            <div class="d-flex justify-content-between align-items-center">
                                                                <small>Last 30 days</small>
                                                                <i class="fas fa-chart-line fs-4"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="card bg-danger text-white">
                                                        <div class="card-body">
                                                            <h5 class="card-title">Denied Sales</h5>
                                                            <h2 id="deniedSalesCount">0</h2>
                                                            <div class="d-flex justify-content-between align-items-center">
                                                                <small>Buyer declined</small>
                                                                <i class="fas fa-times-circle fs-4"></i>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            

                                        </div>

                                        <div class="row mb-4">
                                            <div class="col-md-6">
                                                <div class="card">
                                                    <div class="card-header bg-white">
                                                        <h5 class="mb-0">User Growth</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <canvas id="userGrowthChart" height="250"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="card">
                                                    <div class="card-header bg-white">
                                                        <h5 class="mb-0">Listing Growth</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <canvas id="listingGrowthChart" height="250"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="card">
                                                    <div class="card-header bg-white">
                                                        <h5 class="mb-0">Categories Distribution</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <canvas id="categoryChart" height="250"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="card">
                                                    <div class="card-header bg-white">
                                                        <h5 class="mb-0">Top Colleges</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <canvas id="collegeChart" height="250"></canvas>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Sales Transactions Table -->
                                            <div class="row mt-4">
                                                <div class="col-12">
                                                    <div class="card">
                                                        <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                                            <h5 class="mb-0"><i class="fas fa-shopping-cart me-2"></i>Sales Transactions</h5>
                                                            <div class="d-flex gap-2">
                                                                <select class="form-select form-select-sm" id="salesStatusFilter" style="width: 150px;">
                                                                    <option value="">All Sales</option>
                                                                    <option value="confirmed">Confirmed</option>
                                                                    <option value="pending">Pending</option>
                                                                    <option value="denied">Denied</option>
                                                                </select>
                                                                <button class="btn btn-sm btn-success" onclick="exportSalesData()">
                                                                    <i class="fas fa-download me-1"></i>Export CSV
                                                                </button>
                                                            </div>
                                                        </div>
                                                        <div class="card-body p-0">
                                                            <div class="table-responsive">
                                                                <table class="table table-hover mb-0">
                                                                    <thead class="table-light">
                                                                        <tr>
                                                                            <th>ID</th>
                                                                            <th>Item</th>
                                                                            <th>Price</th>
                                                                            <th>Category</th>
                                                                            <th>Seller</th>
                                                                            <th>Buyer</th>
                                                                            <th>College</th>
                                                                            <th>Status</th>
                                                                            <th>Sold Date</th>
                                                                            <th>Confirmed</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="salesTableBody">
                                                                        <tr>
                                                                            <td colspan="10" class="text-center py-3">
                                                                                <div class="spinner-border spinner-border-sm text-primary me-2" role="status">
                                                                                    <span class="visually-hidden">Loading...</span>
                                                                                </div>
                                                                                Loading sales data...
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        <div class="card-footer bg-white d-flex justify-content-between align-items-center">
                                                            <div class="pagination-info">
                                                                Showing <span id="salesStart">0</span> to <span id="salesEnd">0</span> of <span id="salesTotal">0</span> sales
                                                            </div>
                                                            <div class="d-flex gap-1">
                                                                <button class="btn btn-sm btn-outline-secondary" id="salesPrevPage" disabled>
                                                                    <i class="fas fa-chevron-left"></i>
                                                                </button>
                                                                <button class="btn btn-sm btn-outline-secondary" id="salesNextPage" disabled>
                                                                    <i class="fas fa-chevron-right"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Sales Charts -->
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="card">
                                                        <div class="card-header bg-white">
                                                            <h5 class="mb-0">Sales by Category</h5>
                                                        </div>
                                                        <div class="card-body">
                                                            <canvas id="salesByCategoryChart" height="250"></canvas>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="card">
                                                        <div class="card-header bg-white">
                                                            <h5 class="mb-0">Sales by Status</h5>
                                                        </div>
                                                        <div class="card-body">
                                                            <canvas id="salesByStatusChart" height="250"></canvas>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Users Tab -->
                                    <div class="tab-pane fade" id="users" role="tabpanel">
                                        <div class="card">
                                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                                <h5 class="mb-0">User Management</h5>
                                                <div class="d-flex gap-2">
                                                    <div class="input-group input-group-sm" style="width: 250px;">
                                                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                                                        <input type="text" class="form-control" id="userSearch" placeholder="Search users...">
                                                    </div>
                                                    <select class="form-select form-select-sm" id="userFilter" style="width: 150px;">
                                                        <option value="">All Users</option>
                                                        <option value="verified">Verified</option>
                                                        <option value="unverified">Unverified</option>
                                                        <option value="admin">Admins</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead class="table-light">
                                                            <tr>
                                                                <th width="50">
                                                                    <input type="checkbox" class="form-check-input" id="selectAllUsers">
                                                                </th>
                                                                <th>ID</th>
                                                                <th>Name</th>
                                                                <th>Email</th>
                                                                <th>College</th>
                                                                <th>Verified</th>
                                                                <th>Listings</th>
                                                                <th>Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="usersTableBody">
                                                            <!-- Users will be loaded here -->
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-white d-flex justify-content-between align-items-center">
                                                <div class="d-flex gap-2">
                                                    <select class="form-select form-select-sm" id="bulkUserAction" style="width: 150px;">
                                                        <option value="">Bulk Actions</option>
                                                        <option value="verify">Verify Selected</option>
                                                        <option value="unverify">Unverify Selected</option>
                                                        <option value="delete">Delete Selected</option>
                                                    </select>
                                                    <button class="btn btn-sm btn-primary" id="applyBulkAction">Apply</button>
                                                </div>
                                                <div class="pagination-info">
                                                    Showing <span id="userStart">1</span> to <span id="userEnd">10</span> of <span id="userTotal">0</span> users
                                                </div>
                                                <div class="d-flex gap-1">
                                                    <button class="btn btn-sm btn-outline-secondary" id="userPrevPage" disabled>
                                                        <i class="fas fa-chevron-left"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-secondary" id="userNextPage" disabled>
                                                        <i class="fas fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Listings Tab -->
                                    <div class="tab-pane fade" id="listings" role="tabpanel">
                                        <div class="card">
                                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                                <h5 class="mb-0">Listing Management</h5>
                                                <div class="d-flex gap-2">
                                                    <div class="input-group input-group-sm" style="width: 250px;">
                                                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                                                        <input type="text" class="form-control" id="listingSearch" placeholder="Search listings...">
                                                    </div>
                                                    <select class="form-select form-select-sm" id="listingFilter" style="width: 150px;">
                                                        <option value="">All Listings</option>
                                                        <option value="fake">Fake Warnings</option>
                                                        <option value="recent">Recent</option>
                                                        <option value="old">Old</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead class="table-light">
                                                            <tr>
                                                                <th width="50">
                                                                    <input type="checkbox" class="form-check-input" id="selectAllListings">
                                                                </th>
                                                                <th>ID</th>
                                                                <th>Title</th>
                                                                <th>Price</th>
                                                                <th>Category</th>
                                                                <th>Seller</th>
                                                                <th>Fake Warning</th>
                                                                <th>Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="listingsTableBody">
                                                            <!-- Listings will be loaded here -->
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-white d-flex justify-content-between align-items-center">
                                                <div class="d-flex gap-2">
                                                    <select class="form-select form-select-sm" id="bulkListingAction" style="width: 150px;">
                                                        <option value="">Bulk Actions</option>
                                                        <option value="flag">Flag as Fake</option>
                                                        <option value="unflag">Remove Flag</option>
                                                        <option value="delete">Delete</option>
                                                    </select>
                                                    <button class="btn btn-sm btn-primary" id="applyBulkListingAction">Apply</button>
                                                </div>
                                                <div class="pagination-info">
                                                    Showing <span id="listingStart">1</span> to <span id="listingEnd">10</span> of <span id="listingTotal">0</span> listings
                                                </div>
                                                <div class="d-flex gap-1">
                                                    <button class="btn btn-sm btn-outline-secondary" id="listingPrevPage" disabled>
                                                        <i class="fas fa-chevron-left"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-secondary" id="listingNextPage" disabled>
                                                        <i class="fas fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Reports Tab -->
                                    <div class="tab-pane fade" id="reports" role="tabpanel">
                                        <div class="card">
                                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                                <h5 class="mb-0">Reported Content</h5>
                                                <div class="d-flex gap-2">
                                                    <select class="form-select form-select-sm" id="reportFilter" style="width: 150px;">
                                                        <option value="">All Reports</option>
                                                        <option value="pending">Pending</option>
                                                        <option value="resolved">Resolved</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead class="table-light">
                                                            <tr>
                                                                <th>ID</th>
                                                                <th>Listing</th>
                                                                <th>Reporter</th>
                                                                <th>Reason</th>
                                                                <th>Status</th>
                                                                <th>Date</th>
                                                                <th>Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="reportsTableBody">
                                                            <!-- Reports will be loaded here -->
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-white d-flex justify-content-between align-items-center">
                                                <div class="pagination-info">
                                                    Showing <span id="reportStart">1</span> to <span id="reportEnd">10</span> of <span id="reportTotal">0</span> reports
                                                </div>
                                                <div class="d-flex gap-1">
                                                    <button class="btn btn-sm btn-outline-secondary" id="reportPrevPage" disabled>
                                                        <i class="fas fa-chevron-left"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-secondary" id="reportNextPage" disabled>
                                                        <i class="fas fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Colleges Tab -->
                                    <div class="tab-pane fade" id="colleges" role="tabpanel">
                                        <div class="card">
                                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                                <h5 class="mb-0">College Management</h5>
                                                <div class="d-flex gap-2">
                                                    <div class="input-group input-group-sm" style="width: 250px;">
                                                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                                                        <input type="text" class="form-control" id="collegeSearch" placeholder="Search colleges...">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead class="table-light">
                                                            <tr>
                                                                <th>College Name</th>
                                                                <th>Users</th>
                                                                <th>Listings</th>
                                                                <th>Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="collegesTableBody">
                                                            <!-- Colleges will be loaded here -->
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-white d-flex justify-content-between align-items-center">
                                                <div class="pagination-info">
                                                    Showing <span id="collegeStart">1</span> to <span id="collegeEnd">10</span> of <span id="collegeTotal">0</span> colleges
                                                </div>
                                                <div class="d-flex gap-1">
                                                    <button class="btn btn-sm btn-outline-secondary" id="collegePrevPage" disabled>
                                                        <i class="fas fa-chevron-left"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-secondary" id="collegeNextPage" disabled>
                                                        <i class="fas fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Activity Log Tab -->
                                    <div class="tab-pane fade" id="activity" role="tabpanel">
                                        <div class="card">
                                            <div class="card-header bg-white">
                                                <h5 class="mb-0">Admin Activity Log</h5>
                                            </div>
                                            <div class="card-body p-0">
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0">
                                                        <thead class="table-light">
                                                            <tr>
                                                                <th>ID</th>
                                                                <th>Admin</th>
                                                                <th>Action</th>
                                                                <th>Target</th>
                                                                <th>Date</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="activityTableBody">
                                                            <!-- Activities will be loaded here -->
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                            <div class="card-footer bg-white d-flex justify-content-between align-items-center">
                                                <div class="pagination-info">
                                                    Showing <span id="activityStart">1</span> to <span id="activityEnd">10</span> of <span id="activityTotal">0</span> activities
                                                </div>
                                                <div class="d-flex gap-1">
                                                    <button class="btn btn-sm btn-outline-secondary" id="activityPrevPage" disabled>
                                                        <i class="fas fa-chevron-left"></i>
                                                    </button>
                                                    <button class="btn btn-sm btn-outline-secondary" id="activityNextPage" disabled>
                                                        <i class="fas fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close Dashboard</button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Details Modal -->
    <div class="modal fade" id="userDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">User Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="userDetailsContent">
                    <!-- User details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Listing Details Modal -->
    <div class="modal fade" id="listingDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Listing Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="listingDetailsContent">
                    <!-- Listing details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Details Modal -->
    <div class="modal fade" id="reportDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Report Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="reportDetailsContent">
                    <!-- Report details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" id="resolveReportBtn">Mark as Resolved</button>
                    <button type="button" class="btn btn-primary" id="reviewReportBtn">Mark as Reviewed</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div class="modal fade report-modal" id="reportModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Report User</h5>
                    <button type="button" class="btn-close" onclick="closeReportModal()"></button>
                </div>
                <div class="modal-body">
                    <form id="reportForm" class="report-form">
                        <input type="hidden" id="reportListingId">
                        <input type="hidden" id="reportMessageThreadId">
                        <div class="mb-3">
                            <label for="reportDescription" class="form-label">Describe why you are reporting this user</label>
                            <textarea class="form-control" id="reportDescription" rows="4" required placeholder="Explain the issue with this user or conversation..."></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="reportImage" class="form-label">Add supporting image (optional)</label>
                            <input type="file" class="form-control" id="reportImage" accept="image/*">
                            <img id="reportPreviewImage" class="report-preview-image d-none">
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Submit Report</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- College Details Modal -->
    <div class="modal fade" id="collegeDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">College Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="collegeDetailsContent">
                    <!-- College details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <!-- About Us Column -->
                <div class="col-md-4 mb-4">
                    <h5 class="text-primary mb-3">
                        <i class="fas fa-graduation-cap me-2"></i>StudentsMart
                    </h5>
                    <p>The fastest campus marketplace,connecting students to buy, sell, and rent college essentials.</p>
                    <button class="btn btn-outline-light btn-sm" onclick="showAboutUs()">
                        <i class="fas fa-info-circle me-1"></i>About Us
                    </button>
                </div>

                <!-- Quick Links Column -->
                <div class="col-md-2 mb-4">
                    <h5 class="text-primary mb-3">Quick Links</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none" onclick="handlePathSelection('buy')"><i class="fas fa-shopping-cart me-2"></i>Buy Items</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none" onclick="handlePathSelection('sell')"><i class="fas fa-store me-2"></i>Sell/Rent</a></li>

                    </ul>
                </div>

                <!-- Help & Support Column -->
                <div class="col-md-3 mb-4">
                    <h5 class="text-primary mb-3">Help & Support</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none" onclick="ShowFAQPageModal()"><i class="fas fa-question-circle me-2"></i>FAQs</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none" onclick="showContactModal()"><i class="fas fa-headset me-2"></i>Contact Us</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none" onclick="showTermsModal()"><i class="fas fa-file-contract me-2"></i>Terms</a></li>
                        <li class="mb-2"><a href="#" class="text-white text-decoration-none" onclick="showPrivacyModal()"><i class="fas fa-shield-alt me-2"></i>Privacy</a></li>
                    </ul>
                </div>

                <!-- Contact Column -->
                <div class="col-md-3 mb-4">
                    <h5 class="text-primary mb-3">Contact Us</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-envelope me-2"></i>stud.studentsmart@gmail.com</li>
                        <li class="mb-2"><i class="fas fa-phone me-2"></i> +91 8500707175</li>
                        <li class="mb-2"><i class="fas fa-map-marker-alt me-2"></i> Andhra Pradesh</li>
                    </ul>
                    <div class="mt-3">
                        <a href="https://www.facebook.com/share/17dR5Zg2n9/?mibextid=qi2Omg" class="text-white me-2"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-white me-2"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.instagram.com/edutrade_official?igsh=bzVwb2Z2b2wxczBl" class="text-white me-2"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-white me-2"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
            </div>
            <hr class="my-4 bg-secondary">
            <div class="row">
                <div class="col-md-6 text-center text-md-start">
                    <p class="mb-0">&copy; 2025 StudentsMart. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="mb-0">Made with <i class="fas fa-heart text-danger"></i> by Team StudentsMart</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- About Us Modal -->
    <!-- About Us Modal -->
    <!-- About Us Modal -->
    <!-- About Us Modal -->
    <!-- About Us Modal -->
    <div class="modal fade team-modal" id="aboutUsModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <!-- Header -->
                <div class="team-header">
                    <button type="button" class="close-btn" data-bs-dismiss="modal">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="team-header-content">
                        <h2>Meet Our Team</h2>
                        <p>The passionate minds behind StudentsMart</p>
                    </div>
                </div>

                <!-- Team Section -->
                <div class="team-section">
                    <div class="section-title">
                        <h3>Our Core Team</h3>
                        <p>Meet the dedicated individuals making StudentsMart possible</p>
                    </div>

                    <div class="team-grid">
                        <!-- Likith -->
                        <div class="team-member">
                            <div class="card-header">
                                <div class="profile-section">
                                    <div class="member-avatar">
                                        <img src="https://i.ibb.co/v66xv1HX/likith.jpg" alt="Likith">
                                    </div>
                                    <div class="profile-info">
                                        <h4 class="member-name">LIKITH</h4>
                                        <p class="member-title">
                                            <i class="fas fa-graduation-cap me-1"></i>Co-Founder & Visionary, Ram Chandra College
                                        </p>
                                    </div>
                                </div>
                                <div class="achievement-badge">
                                    <i class="fas fa-lightbulb me-1"></i>
                                    Innovative Thinking
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="testimonial-quote">
                                    The visionary who identified the student problem and proposed the concept of a college marketplace. His innovative thinking laid the foundation for StudentsMart.
                                </div>
                                <div class="social-links">
                                    <a href="https://www.linkedin.com/in/likith-kanigolla-66740a307" class="social-btn linkedin" title="LinkedIn">
                                        <i class="fab fa-linkedin-in"></i>
                                    </a>
                                    <a href="https://github.com/likithkanigolla" class="social-btn github" title="GitHub">
                                        <i class="fab fa-github"></i>
                                    </a>
                                    <a href="tel:+918179373099" class="social-btn phone" title="Phone">
                                        <i class="fas fa-phone"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="team-member">
                            <div class="card-header">
                                <div class="profile-section">
                                    <div class="member-avatar">
                                        <img src="https://i.ibb.co/8L2PJS2L/rctr.jpg" alt="Ram Charan Teja">
                                    </div>
                                    <div class="profile-info">
                                        <h4 class="member-name">RAM CHARAN TEJA</h4>
                                        <p class="member-title">
                                            <i class="fas fa-laptop-code me-1"></i>Tech Lead & Co-Founder, VEMU College
                                        </p>
                                    </div>
                                </div>
                                <div class="achievement-badge">
                                    <i class="fas fa-code me-1"></i>
                                    Technical Excellence
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="testimonial-quote">
                                    The technical mastermind behind StudentsMart who built the platform from scratch. A computer science student with expertise in Python, AI, and web development, turning innovative ideas into reality.
                                </div>
                                <div class="social-links">
                                    <a href="https://www.linkedin.com/in/n-l-ram-charan-teja-ba2b25288/" class="social-btn linkedin" title="LinkedIn">
                                        <i class="fab fa-linkedin-in"></i>
                                    </a>
                                    <a href="https://github.com/RamCharanTeja-22" class="social-btn github" title="GitHub">
                                        <i class="fab fa-github"></i>
                                    </a>
                                    <a href="tel:+919177415501" class="social-btn phone" title="Phone">
                                        <i class="fas fa-phone"></i>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Jyothiraj Sagar -->
                        <div class="team-member">
                            <div class="card-header">
                                <div class="profile-section">
                                    <div class="member-avatar">
                                        <img src="https://i.ibb.co/Z1h8TKBn/In-Shot-20250722-145116183.jpg" alt="Jyothiraj Sagar">
                                    </div>
                                    <div class="profile-info">
                                        <h4 class="member-name">JYOTHIRAJ SAGAR</h4>
                                        <p class="member-title">
                                            <i class="fas fa-paint-brush me-1"></i>Marketing Lead & Brand Designer
                                        </p>
                                    </div>
                                </div>
                                <div class="achievement-badge">
                                    <i class="fas fa-palette me-1"></i>
                                    Creative Excellence
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="testimonial-quote">
                                    The creative mind behind StudentsMart's branding and visual identity. Led the design of the official logo and drives marketing efforts with expertise in creative direction and content creation.
                                </div>
                                <div class="social-links">
                                    <a href="https://www.linkedin.com/in/jyothi-raj-sagar-a4b800319" class="social-btn linkedin" title="LinkedIn">
                                        <i class="fab fa-linkedin-in"></i>
                                    </a>
                                    <a href="https://github.com/Jyothirajsagar" class="social-btn github" title="GitHub">
                                        <i class="fab fa-github"></i>
                                    </a>
                                    <a href="tel:+919391629911" class="social-btn phone" title="Phone">
                                        <i class="fas fa-phone"></i>
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Shantha -->
                        <div class="team-member">
                            <div class="card-header">
                                <div class="profile-section">
                                    <div class="member-avatar">
                                        <img src="https://i.ibb.co/3Y800nbG/1753193856575.jpg" alt="Shantha">
                                    </div>
                                    <div class="profile-info">
                                        <h4 class="member-name">SHANTHA</h4>
                                        <p class="member-title">
                                            <i class="fas fa-pen-fancy me-1"></i>Marketing Team & Content Creator
                                        </p>
                                    </div>
                                </div>
                                <div class="achievement-badge">
                                    <i class="fas fa-edit me-1"></i>
                                    Content Mastery
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="testimonial-quote">
                                    Strong pillar of the marketing team, writing clear and creative scripts for promotions. Plays a key role in making ideas come alive with exceptional teamwork and consistent efforts.
                                </div>
                                <div class="social-links">
                                    <a href="https://www.linkedin.com/in/shantha-k-9572402b4" class="social-btn linkedin" title="LinkedIn">
                                        <i class="fab fa-linkedin-in"></i>
                                    </a>
                                    <a href="https://github.com/Shanthakothandaraman/" class="social-btn github" title="GitHub">
                                        <i class="fab fa-github"></i>
                                    </a>
                                    <a href="tel:+917780490015" class="social-btn phone" title="Phone">
                                        <i class="fas fa-phone"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <!-- Venkat Prasad -->
                        <div class="team-member">
                            <div class="card-header">
                                <div class="profile-section">
                                    <div class="member-avatar">
                                        <img src="https://i.ibb.co/pv9kmhSr/venkat.jpg" alt="Venkat Prasad">
                                    </div>
                                    <div class="profile-info">
                                        <h4 class="member-name">VENKAT PRASAD</h4>
                                        <p class="member-title">
                                            <i class="fas fa-video me-1"></i>Content Creator & Template Designer
                                        </p>
                                    </div>
                                </div>
                                <div class="achievement-badge">
                                    <i class="fas fa-play me-1"></i>
                                    Creative Content
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="testimonial-quote">
                                    Creative content supporter in the marketing team, specializing in template design and reel creation. Works closely with Sagar to bring engaging visual content and promotional materials to life.
                                </div>
                                <div class="social-links">
                                    <a href="https://www.linkedin.com/in/c-venkataprasad-15a76b33a/" class="social-btn linkedin" title="LinkedIn">
                                        <i class="fab fa-linkedin-in"></i>
                                    </a>
                                    <a href="https://github.com/venkataprasad0707" class="social-btn github" title="GitHub">
                                        <i class="fab fa-github"></i>
                                    </a>
                                    <a href="tel:+917893863952" class="social-btn phone" title="Phone">
                                        <i class="fas fa-phone"></i>
                                    </a>
                                </div>
                            </div>
                        </div>



                    </div>
                </div>
                <div class="company-backing">
                    <div class="company-content">
                        <div class="backing-badge">
                            <i class="fas fa-shield-alt me-2"></i>
                            Proudly Backed By
                        </div>

                        <div class="mentorly-container">
                            <img src="https://i.ibb.co/CXPFhwY/OP.png" class="mentorly-logo" alt="Mentorly Logo">
                            <h4 class="company-title">Mentorly</h4>
                            <p class="company-description">
                                StudentsMart is proudly backed by Mentorly, a leading platform dedicated to empowering
                                student entrepreneurs and innovative educational solutions.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Mission Section -->
                <div class="mission-section">
                    <div class="mission-card">
                        <h3 class="mission-title">Our Story & Mission</h3>
                        <p class="mission-text">
                            At StudentsMart, we believe in the power of connection. Our platform was born from a student
                            problem identified by Likith from Ram Chandra college, which was then developed into a
                            full-fledged platform with innovative solutions.
                        </p>
                        <p class="mission-text">
                            Together with our amazing team of Jyothiraj Sagar, Shantha, and Ram Charan Teja, we've built something special -
                            a platform that truly understands student needs and bridges the gap between different colleges.
                        </p>
                        <div class="mission-highlight">
                            <i class="fas fa-heart me-2"></i>
                            Connecting students. Sharing resources. Building community.
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="modal-footer-custom">
                    <button type="button" class="btn btn-secondary-custom btn-custom" data-bs-dismiss="modal">
                        <i class="fas fa-arrow-left me-2"></i>Close
                    </button>
                    <a href="tel:+918500707175" class="btn btn-primary-custom btn-custom">
                        <i class="fas fa-phone me-2"></i>+91 8500707175
                    </a>
                </div>
            </div>
        </div>
    </div>
    <!-- Contact Modal -->
    <!-- Contact Modal -->
    <div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="contactModalLabel">
                        <i class="fas fa-envelope me-2"></i>Contact Us
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Contact Methods -->
                    <div class="d-flex justify-content-around mb-4">
                        <a href="mailto:contactstudentsmart@gmail.com" class="text-decoration-none text-center">
                            <div class="bg-light p-3 rounded-circle mb-2">
                                <i class="fas fa-envelope fa-2x text-primary"></i>
                            </div>
                            <span class="d-block">Email</span>
                        </a>
                        <a href="tel:+918500707175" class="text-decoration-none text-center">
                            <div class="bg-light p-3 rounded-circle mb-2">
                                <i class="fas fa-phone fa-2x text-primary"></i>
                            </div>
                            <span class="d-block">Call</span>
                        </a>
                        <a href="https://wa.me/918500707175" target="_blank" class="text-decoration-none text-center">
                            <div class="bg-light p-3 rounded-circle mb-2">
                                <i class="fab fa-whatsapp fa-2x text-primary"></i>
                            </div>
                            <span class="d-block">WhatsApp</span>
                        </a>
                    </div>

                    <hr class="my-4">

                    <!-- Contact Form -->
                    <form id="contactForm" class="needs-validation" novalidate>
                        <div class="mb-3">
                            <label for="contactName" class="form-label">Full Name</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-user"></i></span>
                                <input type="text" class="form-control" id="contactName" name="name" placeholder="Enter your name" required>
                                <div class="invalid-feedback">
                                    Please provide your name.
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="contactEmail" class="form-label">Email Address</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-at"></i></span>
                                <input type="email" class="form-control" id="contactEmail" name="email" placeholder="Enter your email" required>
                                <div class="invalid-feedback">
                                    Please provide a valid email address.
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="contactSubject" class="form-label">Subject</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-heading"></i></span>
                                <input type="text" class="form-control" id="contactSubject" name="subject" placeholder="Enter subject" required>
                                <div class="invalid-feedback">
                                    Please provide a subject.
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="contactMessage" class="form-label">Message</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-comment-alt"></i></span>
                                <textarea class="form-control" id="contactMessage" name="message" rows="4" placeholder="Enter your message" required></textarea>
                                <div class="invalid-feedback">
                                    Please enter your message.
                                </div>
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-paper-plane me-2"></i>Send Message
                            </button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer bg-light">
                    <p class="small text-muted mb-0">We'll get back to you within 24 hours.</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Terms Modal -->
    <!-- Terms of Service Modal -->
    <!-- Terms Modal -->
    <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="termsModalLabel">
                        <i class="fas fa-file-contract me-2"></i>StudentsMart Terms of Service
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <!-- Header Section -->
                    <div class="text-center mb-4">
                        <h4>StudentsMart Marketplace Terms</h4>
                        <p class="text-muted">Last Updated: August 2025</p>
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Important:</strong> Violations may result in permanent account suspension
                        </div>
                    </div>

                    <!-- 1. Acceptance of Terms -->
                    <div class="term-section mb-4">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">
                                    <i class="fas fa-signature me-2 text-primary"></i>1. Acceptance of Terms
                                </h5>
                            </div>
                            <div class="card-body">
                                <p>By using StudentsMart, you agree to these Terms and all applicable laws. If you don't agree, you may not use our services.</p>
                                <div class="alert alert-warning">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <strong>Student Responsibility:</strong> You are responsible for all activities under your account.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2. Marketplace Rules -->
                    <div class="term-section mb-4">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">
                                    <i class="fas fa-gavel me-2 text-primary"></i>2. Marketplace Rules
                                </h5>
                            </div>
                            <div class="card-body">
                                <h6 class="text-primary"><i class="fas fa-list-check me-2"></i>Listing Requirements</h6>
                                <ul class="fa-ul">
                                    <li><span class="fa-li"><i class="fas fa-check text-success"></i></span>All listings must be accurate and truthful</li>
                                    <li><span class="fa-li"><i class="fas fa-check text-success"></i></span>You must own or have rights to sell the items</li>
                                    <li><span class="fa-li"><i class="fas fa-check text-success"></i></span>Prices must be fair (no price gouging)</li>
                                    <li><span class="fa-li"><i class="fas fa-check text-success"></i></span>Digital content must be legally obtained</li>
                                </ul>

                                <h6 class="text-primary mt-4"><i class="fas fa-ban me-2"></i>Prohibited Actions</h6>
                                <ul class="fa-ul">
                                    <li><span class="fa-li"><i class="fas fa-times text-danger"></i></span>No fake/misleading listings (instant ban)</li>
                                    <li><span class="fa-li"><i class="fas fa-times text-danger"></i></span>No academic dishonesty (selling exams/assignments)</li>
                                    <li><span class="fa-li"><i class="fas fa-times text-danger"></i></span>No harassment or discrimination</li>
                                    <li><span class="fa-li"><i class="fas fa-times text-danger"></i></span>No spam or commercial advertising</li>
                                </ul>

                                <div class="alert alert-danger mt-3">
                                    <i class="fas fa-skull-crossbones me-2"></i>
                                    <strong>Zero Tolerance:</strong> Academic cheating services will result in permanent ban and reporting to your institution.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. Privacy & Conduct -->
                    <div class="term-section mb-4">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">
                                    <i class="fas fa-user-shield me-2 text-primary"></i>3. Privacy & Conduct
                                </h5>
                            </div>
                            <div class="card-body">
                                <h6 class="text-primary"><i class="fas fa-handshake me-2"></i>Community Standards</h6>
                                <ul>
                                    <li>Keep all communications within StudentsMart</li>
                                    <li>Never share personal contact information in listings</li>
                                    <li>Report suspicious activity immediately</li>
                                    <li>Meet in public spaces for exchanges</li>
                                </ul>

                                <div class="alert alert-info mt-3">
                                    <i class="fas fa-lightbulb me-2"></i>
                                    <strong>Safety Tip:</strong> Use our messaging system for all communications to stay protected.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Account Termination -->
                    <div class="term-section mb-4">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">
                                    <i class="fas fa-user-slash me-2 text-primary"></i>4. Account Termination
                                </h5>
                            </div>
                            <div class="card-body">
                                <p>We may suspend or terminate your account immediately if you:</p>
                                <ul class="fa-ul">
                                    <li><span class="fa-li"><i class="fas fa-hammer text-danger"></i></span>Violate these Terms</li>
                                    <li><span class="fa-li"><i class="fas fa-hammer text-danger"></i></span>Harm other users</li>
                                    <li><span class="fa-li"><i class="fas fa-hammer text-danger"></i></span>Attempt to bypass our systems</li>
                                </ul>
                                <p class="mt-3"><strong>Note:</strong> Permanent bans may include device blocking and reporting to your college administration for serious violations.</p>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Dispute Resolution -->
                    <div class="term-section mb-4">
                        <div class="card">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">
                                    <i class="fas fa-balance-scale me-2 text-primary"></i>5. Dispute Resolution
                                </h5>
                            </div>
                            <div class="card-body">
                                <h6 class="text-primary"><i class="fas fa-flag me-2"></i>Reporting Issues</h6>
                                <p>If you have a problem with another user:</p>
                                <ol>
                                    <li>Use our <strong>Report</strong> button immediately</li>
                                    <li>Provide evidence (screenshots, etc.)</li>
                                    <li>Our team will investigate within 48 hours</li>
                                </ol>
                                <div class="alert alert-warning mt-3">
                                    <i class="fas fa-exclamation-circle me-2"></i>
                                    StudentsMart acts as a platform only - we're not responsible for transactions between users.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Final Acknowledgement -->
                    <div class="alert alert-dark">
                        <div class="d-flex">
                            <div class="me-3">
                                <i class="fas fa-signature fa-2x text-primary"></i>
                            </div>
                            <div>
                                <h5 class="alert-heading">Your Agreement</h5>
                                <p>By using StudentsMart, you confirm that:</p>
                                <ul class="mb-0">
                                    <li>You're currently enrolled at a recognized educational institution</li>
                                    <li>You'll maintain academic integrity</li>
                                    <li>You've read and accept these Terms</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Close
                    </button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
                        <i class="fas fa-check me-2"></i>I Understand
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Privacy Modal -->
    <div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="privacyModalLabel">Privacy Policy</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <h2 class="mb-3">StudentsMart Privacy Policy</h2>
                        <p class="text-muted mb-4">Last Updated: August, 2025</p>

                        <!-- Table of Contents -->
                        <div class="card bg-light mb-4">
                            <div class="card-body">
                                <h6 class="card-title">Contents</h6>
                                <ul class="list-unstyled">
                                    <li><a href="#information-collected">1. Information We Collect</a></li>
                                    <li><a href="#information-use">2. How We Use Your Information</a></li>
                                    <li><a href="#information-sharing">3. Information Sharing</a></li>
                                    <li><a href="#data-security">4. Data Security</a></li>
                                    <li><a href="#your-choices">5. Your Choices</a></li>
                                    <li><a href="#policy-changes">6. Changes to This Policy</a></li>
                                    <li><a href="#contact-us">7. Contact Us</a></li>
                                </ul>
                            </div>
                        </div>

                        <!-- Section 1 -->
                        <section id="information-collected" class="mb-4">
                            <h4 class="border-bottom pb-2 text-primary">1. Information We Collect</h4>
                            <p>We collect personal information you provide when registering, creating listings, or contacting other users. This may include:</p>
                            <ul>
                                <li>Name and email address</li>
                                <li>College or university information</li>
                                <li>Profile picture and bio information</li>
                                <li>Information about items you list for sale or exchange</li>
                                <li>Communication data between you and other users</li>
                                <li>Device and usage information when you access our platform</li>
                            </ul>
                        </section>

                        <!-- Section 2 -->
                        <section id="information-use" class="mb-4">
                            <h4 class="border-bottom pb-2 text-primary">2. How We Use Your Information</h4>
                            <p>We use your information to:</p>
                            <ul>
                                <li>Create and maintain your account</li>
                                <li>Provide and improve our services</li>
                                <li>Facilitate transactions between users</li>
                                <li>Send important notifications and updates</li>
                                <li>Protect against fraudulent or unauthorized activity</li>
                                <li>Personalize your experience on the platform</li>
                            </ul>
                        </section>

                        <!-- Section 3 -->
                        <section id="information-sharing" class="mb-4">
                            <h4 class="border-bottom pb-2 text-primary">3. Information Sharing</h4>
                            <p>We do not sell your personal information. We may share information:</p>
                            <ul>
                                <li>With other users as necessary to facilitate transactions</li>
                                <li>With service providers who help operate our platform</li>
                                <li>When required by law or to protect rights and safety</li>
                                <li>In the event of a business transfer or acquisition</li>
                            </ul>
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle"></i> Your public profile and listings are visible to other StudentsMart users.
                            </div>
                        </section>

                        <!-- Section 4 -->
                        <section id="data-security" class="mb-4">
                            <h4 class="border-bottom pb-2 text-primary">4. Data Security</h4>
                            <p>We implement appropriate technical and organizational security measures to protect your information, including:</p>
                            <ul>
                                <li>Encryption of sensitive data</li>
                                <li>Regular security assessments</li>
                                <li>Restricted access to personal information</li>
                            </ul>
                            <p>While we strive to protect your information, no method of transmission over the Internet is 100% secure.</p>
                        </section>

                        <!-- Section 5 -->
                        <section id="your-choices" class="mb-4">
                            <h4 class="border-bottom pb-2 text-primary">5. Your Choices</h4>
                            <p>You have several rights regarding your personal information:</p>
                            <ul>
                                <li>Access, update, or correct your account information at any time</li>
                                <li>Request deletion of your account and personal data</li>
                                <li>Opt out of marketing communications</li>
                                <li>Control privacy settings for your profile and listings</li>
                            </ul>
                            <p>To exercise these rights, visit your account settings or contact our support team.</p>
                        </section>

                        <!-- Section 6 -->
                        <section id="policy-changes" class="mb-4">
                            <h4 class="border-bottom pb-2 text-primary">6. Changes to This Policy</h4>
                            <p>We may update this policy periodically to reflect changes in our practices or legal requirements. We will notify you of significant changes through:</p>
                            <ul>
                                <li>Email notification (for registered users)</li>
                                <li>Prominent notice on our website or app</li>
                            </ul>
                            <p>Continued use of the service after changes constitutes acceptance of the modified policy.</p>
                        </section>

                        <!-- Section 7 -->
                        <section id="contact-us">
                            <h4 class="border-bottom pb-2 text-primary">7. Contact Us</h4>
                            <p>If you have questions or concerns about this Privacy Policy or our data practices, please contact us at:</p>
                            <p><strong>Email:</strong> contactstudentsmart@gmail.com</p>
                        </section>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="FAQPageModal" tabindex="-1" aria-labelledby="FAQPageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="FAQPageModalLabel">Frequently Asked Questions</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <div class="row">
                            <div class="col-12 text-center">
                                <h2 class="mb-4">Frequently Asked Questions</h2>
                                <p class="lead mb-4">
                                    Find answers to common questions about StudentsMart.
                                </p>
                            </div>
                        </div>

                        <div class="row mt-4">
                            <div class="col-12">
                                <div class="accordion" id="faqAccordion">
                                    <!-- FAQ Item 1 -->
                                    <div class="accordion-item mb-3 border-0 rounded overflow-hidden">
                                        <h2 class="accordion-header" id="headingOne">
                                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne">
                                                How do I create an account?
                                            </button>
                                        </h2>
                                        <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                Click on the "Register" button in the top right corner and fill out the registration form with your details.
                                                You'll need to verify your email address to complete the registration.
                                            </div>
                                        </div>
                                    </div>

                                    <!-- FAQ Item 2 -->
                                    <div class="accordion-item mb-3 border-0 rounded overflow-hidden">
                                        <h2 class="accordion-header" id="headingTwo">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo">
                                                Is there a fee for using StudentsMart?
                                            </button>
                                        </h2>
                                        <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                No, StudentsMart is completely free for students to use. We don't charge any fees for listing items or making purchases.
                                            </div>
                                        </div>
                                    </div>

                                    <!-- FAQ Item 3 -->
                                    <div class="accordion-item mb-3 border-0 rounded overflow-hidden">
                                        <h2 class="accordion-header" id="headingThree">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree">
                                                How do I contact a seller?
                                            </button>
                                        </h2>
                                        <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                Click on the "Contact Seller" button on any listing to send a message to the seller.
                                                You can then continue the conversation in your messages.
                                            </div>
                                        </div>
                                    </div>

                                    <!-- FAQ Item 4 -->
                                    <div class="accordion-item mb-3 border-0 rounded overflow-hidden">
                                        <h2 class="accordion-header" id="headingFour">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour">
                                                What should I do if I encounter a problem?
                                            </button>
                                        </h2>
                                        <div id="collapseFour" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                If you encounter any issues with a seller or listing, please use the "Report" button or contact our support team immediately.
                                            </div>
                                        </div>
                                    </div>

                                    <!-- FAQ Item 5 -->
                                    <div class="accordion-item mb-3 border-0 rounded overflow-hidden">
                                        <h2 class="accordion-header" id="headingFive">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive">
                                                Can I sell items from other colleges?
                                            </button>
                                        </h2>
                                        <div id="collapseFive" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                Currently, StudentsMart is designed for transactions within the same college campus to ensure safety and convenience.
                                                We may expand this feature in the future.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="soldModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Mark as Sold</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="soldForm">
                        <input type="hidden" id="listingId" name="listing_id">
                        <div class="mb-3">
                            <label class="form-label">Buyer Name*</label>
                            <input type="text" class="form-control" name="buyer_name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Buyer Email*</label>
                            <input type="email" class="form-control" name="buyer_email" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="markAsSold()">Send Confirmation</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="otpModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-logo-container">
                        <img src="https://i.ibb.co/1YBpx2KS/logo.png" alt="StudentsMart" class="modal-logo">
                        <span class="modal-site-name">StudentsMart</span>
                    </div>
                    <div class="create-account-text">
                        <h5 class="modal-title">Verify Your Email</h5>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="mb-4">
                        <i class="fas fa-envelope-open text-primary" style="font-size: 3rem;"></i>
                    </div>
                    <h6 class="mb-3">Enter Verification Code</h6>
                    <p class="text-muted mb-4">
                        We've sent a 6-digit verification code to<br>
                        <strong id="otpEmailDisplay"></strong>
                    </p>

                    <form id="otpForm">
                        <div class="mb-4">
                            <input type="text"
                                class="form-control form-control-lg text-center"
                                id="otpInput"
                                name="otp_code"
                                maxlength="6"
                                placeholder="000000"
                                style="font-size: 1.5rem; letter-spacing: 0.5rem; font-weight: bold;"
                                required>
                            <small class="text-muted">Enter the 6-digit code from your email</small>
                        </div>

                        <div class="d-grid mb-3">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-check-circle me-2"></i>Verify Email
                            </button>
                        </div>
                    </form>

                    <div class="text-center">
                        <p class="text-muted mb-2">Didn't receive the code wvcdhwkhiw?</p>
                        <button type="button" class="btn btn-link p-0" id="resendOtpBtn">
                            <i class="fas fa-redo me-1"></i>Resend Code
                        </button>
                        <div id="resendTimer" class="text-muted mt-2" style="display: none;">
                            Resend available in <span id="timerCount">60</span> seconds
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="forgotPasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-logo-container">
                        <img src="https://i.ibb.co/1YBpx2KS/logo.png" alt="StudentsMart" class="modal-logo">
                        <span class="modal-site-name">StudentsMart</span>
                    </div>
                    <div class="create-account-text">
                        <h5 class="modal-title">Reset Password</h5>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="mb-4">
                        <i class="fas fa-key text-primary" style="font-size: 3rem;"></i>
                    </div>
                    <h6 class="mb-3">Forgot Your Password?</h6>
                    <p class="text-muted mb-4">
                        No worries! Enter your email address and we'll send you a link to reset your password.
                    </p>

                    <form id="forgotPasswordForm">
                        <div class="mb-4">
                            <input type="email"
                                class="form-control form-control-lg"
                                id="forgotPasswordEmail"
                                name="email"
                                placeholder="Enter your email address"
                                required>
                            <small class="text-muted">We'll send reset instructions to this email</small>
                        </div>

                        <div class="d-grid mb-3">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-paper-plane me-2"></i>Send Reset Link
                            </button>
                        </div>
                    </form>

                    <div class="text-center">
                        <p class="text-muted mb-2">Remember your password?</p>
                        <button type="button" class="btn btn-link p-0" onclick="showLoginModalFromForgotPassword()">
                            <i class="fas fa-sign-in-alt me-1"></i>Back to Login
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- AI Chat Sidebar -->
    <!-- Floating Chat Button -->
    <div class="chat-button-container">
        <button id="chatFloatingBtn" onclick="showChatModal()" title="Open Chat">
            <img src="https://i.ibb.co/8gwcF4q4/chat-removebg-preview.png" alt="Chat" />
            <span id="unreadMessageCount" style="display: none;">0</span>
        </button>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
        
        let currentStep = 1;
        const totalSteps = 5;

        let currentCollegePage = 1;
        const collegesPerPage = 10;
        let allCollegesData = [];
        // ==================== SALES ANALYTICS FUNCTIONS - FIXED ====================

        let allSalesData = [];
        let currentSalesPage = 1;
        const salesPerPage = 10;
        let salesChartsInitialized = false;

        // Load Sales Statistics
        async function loadSalesStats() {
            try {
                const response = await fetch('/api/admin/sales-stats', {
                    credentials: 'same-origin'
                });
                
                if (!response.ok) {
                    throw new Error('Failed to load sales stats');
                }
                
                const data = await response.json();
                
                // Update statistics cards
                document.getElementById('totalSalesCount').textContent = data.total_sales || 0;
                document.getElementById('pendingSalesCount').textContent = data.pending_sales || 0;
                document.getElementById('recentSalesCount').textContent = data.recent_sales || 0;
                document.getElementById('deniedSalesCount').textContent = data.denied_sales || 0;
                
                // Store all sales data
                allSalesData = data.recent_sold_items || [];
                
                // Display sales table
                displaySalesTable(allSalesData);
                
                // Create sales charts ONLY if Chart.js is loaded
                if (typeof Chart !== 'undefined') {
                    createSalesCharts(data);
                } else {
                    // Wait for Chart.js to load, then create charts
                    const checkChartInterval = setInterval(() => {
                        if (typeof Chart !== 'undefined') {
                            clearInterval(checkChartInterval);
                            createSalesCharts(data);
                        }
                    }, 100);
                    
                    // Stop checking after 5 seconds
                    setTimeout(() => clearInterval(checkChartInterval), 5000);
                }
                
            } catch (error) {
                console.error('Error loading sales stats:', error);
                const salesTableBody = document.getElementById('salesTableBody');
                if (salesTableBody) {
                    salesTableBody.innerHTML = `
                        <tr>
                            <td colspan="10" class="text-center text-danger py-3">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Error loading sales data: ${error.message}
                            </td>
                        </tr>
                    `;
                }
            }
        }

        // Display Sales Table
        function displaySalesTable(salesData, page = 1) {
            const tableBody = document.getElementById('salesTableBody');
            if (!tableBody) return;
            
            const start = (page - 1) * salesPerPage;
            const end = start + salesPerPage;
            const paginatedData = salesData.slice(start, end);
            
            if (!salesData || salesData.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="10" class="text-center py-4">
                            <i class="fas fa-inbox fa-3x text-muted mb-3 d-block"></i>
                            <p class="text-muted mb-0">No sales transactions found</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tableBody.innerHTML = paginatedData.map(sale => `
                <tr>
                    <td><span class="badge bg-secondary">#${sale.id}</span></td>
                    <td>
                        <strong>${sale.listing_title || 'Deleted Listing'}</strong>
                    </td>
                    <td><strong class="text-success">₹${sale.listing_price || 0}</strong></td>
                    <td>
                        <span class="badge bg-info">${(sale.listing_category || 'N/A').toUpperCase()}</span>
                    </td>
                    <td>
                        <div>
                            <strong>${sale.seller_name}</strong><br>
                            <small class="text-muted">${sale.seller_email || ''}</small>
                        </div>
                    </td>
                    <td>
                        <div>
                            <strong>${sale.buyer_name}</strong><br>
                            <small class="text-muted">${sale.buyer_email}</small>
                        </div>
                    </td>
                    <td><small class="text-muted">${sale.seller_college}</small></td>
                    <td>
                        <span class="badge ${getSalesStatusBadgeClass(sale.status)}">
                            ${sale.status.toUpperCase()}
                        </span>
                    </td>
                    <td><small>${formatSalesDate(sale.sold_at)}</small></td>
                    <td><small>${sale.confirmed_at ? formatSalesDate(sale.confirmed_at) : '-'}</small></td>
                </tr>
            `).join('');
            
            // Update pagination
            updateSalesPagination(salesData.length, page);
        }

        // Get status badge class
        function getSalesStatusBadgeClass(status) {
            switch(status) {
                case 'confirmed': return 'bg-success';
                case 'pending': return 'bg-warning text-dark';
                case 'denied': return 'bg-danger';
                default: return 'bg-secondary';
            }
        }

        // Format date for sales
        function formatSalesDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-IN', { 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Update sales pagination
        function updateSalesPagination(total, currentPage) {
            const totalPages = Math.ceil(total / salesPerPage);
            const start = total === 0 ? 0 : (currentPage - 1) * salesPerPage + 1;
            const end = Math.min(currentPage * salesPerPage, total);
            
            const salesStartEl = document.getElementById('salesStart');
            const salesEndEl = document.getElementById('salesEnd');
            const salesTotalEl = document.getElementById('salesTotal');
            const prevBtn = document.getElementById('salesPrevPage');
            const nextBtn = document.getElementById('salesNextPage');
            
            if (salesStartEl) salesStartEl.textContent = start;
            if (salesEndEl) salesEndEl.textContent = end;
            if (salesTotalEl) salesTotalEl.textContent = total;
            
            if (prevBtn) prevBtn.disabled = currentPage === 1;
            if (nextBtn) nextBtn.disabled = currentPage === totalPages || totalPages === 0;
        }

        // Create sales charts - WITH CHART.JS CHECK
        function createSalesCharts(data) {
            // Check if Chart.js is loaded
            if (typeof Chart === 'undefined') {
                console.warn('Chart.js is not loaded yet. Charts will be created when available.');
                return;
            }
            
            // Prevent duplicate chart creation
            if (salesChartsInitialized) {
                return;
            }
            
            try {
                // Sales by Category Chart
                if (data.sales_by_category && data.sales_by_category.length > 0) {
                    const ctx = document.getElementById('salesByCategoryChart');
                    if (ctx) {
                        // Destroy existing chart if it exists
                        const existingChart = Chart.getChart(ctx);
                        if (existingChart) {
                            existingChart.destroy();
                        }
                        
                        new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: data.sales_by_category.map(item => item.category.toUpperCase()),
                                datasets: [{
                                    data: data.sales_by_category.map(item => item.count),
                                    backgroundColor: [
                                        '#6C5CE7',
                                        '#00B894',
                                        '#FDCB6E',
                                        '#E17055',
                                        '#0984E3',
                                        '#E84393'
                                    ]
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'bottom'
                                    }
                                }
                            }
                        });
                    }
                }
                
                // Sales by Status Chart
                const ctx2 = document.getElementById('salesByStatusChart');
                if (ctx2) {
                    // Destroy existing chart if it exists
                    const existingChart = Chart.getChart(ctx2);
                    if (existingChart) {
                        existingChart.destroy();
                    }
                    
                    const statusCounts = {
                        confirmed: data.total_sales || 0,
                        pending: data.pending_sales || 0,
                        denied: data.denied_sales || 0
                    };
                    
                    new Chart(ctx2, {
                        type: 'bar',
                        data: {
                            labels: ['Confirmed', 'Pending', 'Denied'],
                            datasets: [{
                                label: 'Number of Sales',
                                data: [statusCounts.confirmed, statusCounts.pending, statusCounts.denied],
                                backgroundColor: [
                                    '#00B894',
                                    '#FDCB6E',
                                    '#E17055'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        precision: 0
                                    }
                                }
                            }
                        }
                    });
                }
                
                salesChartsInitialized = true;
                
            } catch (error) {
                console.error('Error creating sales charts:', error);
            }
        }

        // Export sales data to CSV
        function exportSalesData() {
            const filterValue = document.getElementById('salesStatusFilter').value;
            let dataToExport = filterValue === '' ? allSalesData : 
                allSalesData.filter(sale => sale.status === filterValue);
            
            if (dataToExport.length === 0) {
                Swal.fire({
                    title: 'No Data',
                    text: 'No sales data to export',
                    icon: 'info'
                });
                return;
            }
            
            // Create CSV content
            let csv = 'ID,Item Title,Price,Category,Seller Name,Seller Email,Buyer Name,Buyer Email,College,Status,Sold Date,Confirmed Date\n';
            
            dataToExport.forEach(sale => {
                csv += `${sale.id},"${sale.listing_title}",${sale.listing_price},"${sale.listing_category || 'N/A'}","${sale.seller_name}","${sale.seller_email || ''}","${sale.buyer_name}","${sale.buyer_email}","${sale.seller_college}","${sale.status}","${sale.sold_at}","${sale.confirmed_at || 'N/A'}"\n`;
            });
            
            // Download CSV
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sales_report_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            Swal.fire({
                title: 'Success!',
                text: 'Sales data exported successfully',
                icon: 'success',
                timer: 2000,
                showConfirmButton: false
            });
        }

        // Event Listeners for Sales
        document.addEventListener('DOMContentLoaded', function() {
            // Sales filter
            const salesStatusFilter = document.getElementById('salesStatusFilter');
            if (salesStatusFilter) {
                salesStatusFilter.addEventListener('change', function() {
                    const filterValue = this.value;
                    let filteredData = allSalesData;
                    
                    if (filterValue !== '') {
                        filteredData = allSalesData.filter(sale => sale.status === filterValue);
                    }
                    
                    currentSalesPage = 1;
                    displaySalesTable(filteredData, 1);
                });
            }
            
            // Sales pagination buttons
            const salesPrevBtn = document.getElementById('salesPrevPage');
            const salesNextBtn = document.getElementById('salesNextPage');
            
            if (salesPrevBtn) {
                salesPrevBtn.addEventListener('click', function() {
                    if (currentSalesPage > 1) {
                        currentSalesPage--;
                        const filterValue = document.getElementById('salesStatusFilter').value;
                        let filteredData = filterValue === '' ? allSalesData : 
                            allSalesData.filter(sale => sale.status === filterValue);
                        displaySalesTable(filteredData, currentSalesPage);
                    }
                });
            }
            
            if (salesNextBtn) {
                salesNextBtn.addEventListener('click', function() {
                    const filterValue = document.getElementById('salesStatusFilter').value;
                    let filteredData = filterValue === '' ? allSalesData : 
                        allSalesData.filter(sale => sale.status === filterValue);
                    const totalPages = Math.ceil(filteredData.length / salesPerPage);
                    
                    if (currentSalesPage < totalPages) {
                        currentSalesPage++;
                        displaySalesTable(filteredData, currentSalesPage);
                    }
                });
            }
        });
                

        
        // Add this script in your index.html file
        document.addEventListener('DOMContentLoaded', function() {
    // Get URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const modal = urlParams.get('modal');
            const openChat = urlParams.get('openChat');

            // Show the appropriate modal based on the parameter
            if (modal === 'login') {
                showLoginModal();
            } else if (modal === 'register') {
                showRegisterModal();
            }

            // Open chat if parameter is set and user is logged in
            if (openChat === 'true' && currentUser) {
                openChat();
            }
        });
        // First, let's fix the showAlert function
       function showAlert(title, message, type = 'info') {
    // Check if alerts container exists, create it if not
            let alertPlaceholder = document.getElementById('alertsContainer');
            if (!alertPlaceholder) {
                alertPlaceholder = document.createElement('div');
                alertPlaceholder.id = 'alertsContainer';
                alertPlaceholder.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999; width: 300px;';
                document.body.appendChild(alertPlaceholder);
            }

            const wrapper = document.createElement('div');
            wrapper.innerHTML = `
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    <strong>${title}:</strong> ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;
            alertPlaceholder.append(wrapper);

            // Auto-dismiss after 5 seconds
            setTimeout(() => {
                const bsAlert = new bootstrap.Alert(wrapper.querySelector('.alert'));
                bsAlert.close();
            }, 5000);
        }
        // Now fix the showChatModal function
        function showChatModal() {
    // Check if user is authenticated
            if (!currentUser) {
                // Create simple modal HTML
                const modalHTML = `
                <div id="chatLoginModal" class="modal fade show" style="display: block; background: rgba(0,0,0,0.5);">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content" style="border-radius: 15px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                            <div class="modal-body text-center p-4">
                                <div class="mb-3">
                                    <i class="fas fa-comments fa-3x text-primary mb-3"></i>
                                    <h4 class="text-primary mb-3">Hey there! 👋</h4>
                                    <p class="mb-2" style="font-size: 16px;">Ready to chat with your classmates?</p>
                                    <p class="text-muted" style="font-size: 14px;">Just sign in to join the conversation and connect with other students!</p>
                                </div>
                                <div class="d-flex gap-3 justify-content-center mt-4">
                                    <button type="button" class="btn btn-primary btn-lg px-4" onclick="handleLoginClick()">
                                        🚀 Let's Go!
                                    </button>
                                    <button type="button" class="btn btn-secondary btn-lg px-4" onclick="closeChatModal()">
                                        Maybe Later
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;

                // Add modal to page
                document.body.insertAdjacentHTML('beforeend', modalHTML);

                // Add click outside to close
                document.getElementById('chatLoginModal').addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeChatModal();
                    }
                });

                return;
            }

            // User is logged in - redirect to buy.html with a parameter to trigger chat
            window.location.href = '/buy.html?openChat=true';
        }

        function handleLoginClick() {
            closeChatModal();
            showLoginModal();
        }

        function closeChatModal() {
            const modal = document.getElementById('chatLoginModal');
            if (modal) {
                modal.remove();
            }
        }

        let API_KEY = 'AIzaSyDiAZoIPFR3e2xoSiFPHgj70oKgCHqcNkw';
        const API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';

        // System prompt
        const SYSTEM_PROMPT = `You are StudentsMart AI Assistant, a helpful chatbot for a student marketplace platform.
    StudentsMart allows students to buy, sell, and rent academic materials like textbooks, calculators, lab equipment,
    notes, and other campus essentials.

    Key features:
    - Campus-focused marketplace for students
    - Buy/sell/rent academic materials
    - Secure messaging between students
    - College verification system
    - Categories: Textbooks, Calculators, Lab Equipment, Tech Gadgets, Notes & Guides, Art Supplies

    Please provide helpful, accurate information about:
    - How to use StudentsMart
    - Buying/selling process
    - Safety guidelines for transactions
    - Platform features and benefits
    - Account registration and verification
    - Any other questions about the platform

    Keep responses concise, friendly, and focused on helping students use the platform effectively.`;

        let chatHistory = [];
        let isOpen = false;

        // DOM Elements
        const chatSidebar = document.getElementById('chatSidebar');
        const chatBackdrop = document.getElementById('chatBackdrop');
        const openChatBtn = document.getElementById('openChatBtn');
        const closeChatBtn = document.getElementById('closeChatBtn');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const chatMessages = document.getElementById('chatMessages');

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            autoResizeTextarea();
        });

        function setupEventListeners() {
            // Open chat
            openChatBtn.addEventListener('click', openChat);

            // Close chat
            closeChatBtn.addEventListener('click', closeChat);
            chatBackdrop.addEventListener('click', closeChat);

            // Send message
            sendBtn.addEventListener('click', sendMessage);

            // Handle Enter key
            messageInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage(e);
                }
            });

            // Auto-resize textarea
            messageInput.addEventListener('input', autoResizeTextarea);
        }

        function openChat() {
            isOpen = true;
            chatSidebar.classList.add('open');
            chatBackdrop.classList.add('show');
            openChatBtn.classList.add('hidden');
            document.body.style.overflow = 'hidden';

            // Focus on input after animation
            setTimeout(() => {
                messageInput.focus();
            }, 300);
        }

        function closeChat() {
            isOpen = false;
            chatSidebar.classList.remove('open');
            chatBackdrop.classList.remove('show');
            openChatBtn.classList.remove('hidden');
            document.body.style.overflow = 'auto';
        }

        function autoResizeTextarea() {
            messageInput.style.height = 'auto';
            messageInput.style.height = Math.min(messageInput.scrollHeight, 120) + 'px';
        }

        async function sendMessage(e) {
            // Prevent default behavior if this was triggered by an event
            if (e && e.preventDefault) {
                e.preventDefault();
            }

            const message = messageInput.value.trim();

            if (message) {
                // Add user message
                addMessage(message, true);
                messageInput.value = '';
                autoResizeTextarea();

                // Show typing indicator
                showTypingIndicator();

                // Get AI response
                try {
                    const response = await getAIResponse(message);
                    removeTypingIndicator();
                    addMessage(response, false);
                } catch (error) {
                    removeTypingIndicator();
                    addMessage("Sorry, I'm experiencing technical difficulties. Please try again later.", false);
                }
            }
        }

        function addMessage(content, isUser) {
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'sent' : 'received'}`;
            messageDiv.innerHTML = `
                <div class="message-content">
                    <strong>${isUser ? 'You' : 'StudentsMart AI'}:</strong> ${content}
                </div>
                <div class="message-time">${time}</div>
            `;
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'ai-typing';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <strong>StudentsMart AI</strong> is typing
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;
            chatMessages.appendChild(typingDiv);
            scrollToBottom();
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) {
                indicator.remove();
            }
        }

        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        async function getAIResponse(message) {
            try {
                chatHistory.push({role: "user", content: message});

                const conversation = [{
                    parts: [{
                        text: SYSTEM_PROMPT + "\n\nUser: " + message + "\n\nAssistant:"
                    }]
                }];

                const response = await fetch(`${API_URL}?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: conversation,
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 500,
                            topP: 0.8,
                            topK: 40
                        }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("API error:", errorData);
                    throw new Error(`API error: ${response.status}`);
                }

                const data = await response.json();

                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    const aiResponse = data.candidates[0].content.parts[0].text;
                    chatHistory.push({role: "assistant", content: aiResponse});
                    return aiResponse;
                } else {
                    throw new Error("No response from AI");
                }

            } catch (error) {
                console.error("AI API error:", error);

                if (error.message.includes('403') || error.message.includes('401')) {
                    return "⚠️ API key error. Please check if your API key is valid and has the necessary permissions.";
                } else if (error.message.includes('quota')) {
                    return "⚠️ API quota exceeded. Please check your Google Cloud usage limits.";
                } else {
                    return "I'm having trouble connecting right now. Please try again in a moment.";
                }
            }
        }

        // Handle ESC key to close chat
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && isOpen) {
                closeChat();
            }
        });

        let currentUserEmail = '';
        let resendCooldown = false;
        let tempUserCredentials = null; // NEW: Store credentials for auto-login
        // Add this to your existing JavaScript file (append to your current auth.js or similar)

// FORGOT PASSWORD FUNCTIONALITY

// Show forgot password modal
        function showForgotPasswordModal() {
            const forgotPasswordModal = new bootstrap.Modal(document.getElementById('forgotPasswordModal'));
            forgotPasswordModal.show();
        }

        // Handle forgot password form submission
        document.getElementById('forgotPasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalButtonText = submitBtn.innerHTML;
            const email = document.getElementById('forgotPasswordEmail').value.trim();

            if (!email) {
                Swal.fire({
                    title: 'Email Required',
                    text: 'Please enter your email address',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending Reset Link...';

            try {
                const response = await fetch('/forgot-password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email: email })
                });

                const data = await response.json();

                if (response.ok) {
                    // Close forgot password modal
                    const forgotPasswordModal = bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal'));
                    if (forgotPasswordModal) {
                        forgotPasswordModal.hide();
                    }

                    // Show success message
                    Swal.fire({
                        title: 'Reset Link Sent!',
                        text: data.message,
                        icon: 'success',
                        confirmButtonColor: '#2563eb'
                    });

                    // Reset form
                    this.reset();

                } else {
                    // Handle different error cases
                    if (data.requires_verification && data.email) {
                        // User needs email verification first
                        Swal.fire({
                            title: 'Email Not Verified',
                            text: 'Please verify your email first. Would you like us to send a new verification code?',
                            icon: 'warning',
                            showCancelButton: true,
                            confirmButtonText: 'Send Verification Code',
                            cancelButtonText: 'Cancel',
                            confirmButtonColor: '#2563eb'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                // Close forgot password modal
                                const forgotPasswordModal = bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal'));
                                if (forgotPasswordModal) {
                                    forgotPasswordModal.hide();
                                }
                                // Show OTP modal for verification
                                showOtpModal(data.email);
                            }
                        });
                    } else {
                        Swal.fire({
                            title: 'Error',
                            text: data.error || 'Failed to send reset link. Please try again.',
                            icon: 'error',
                            confirmButtonColor: '#2563eb'
                        });
                    }
                }
            } catch (error) {
                console.error('Forgot password error:', error);
                Swal.fire({
                    title: 'Connection Error',
                    text: 'Unable to send reset link. Please check your internet connection and try again.',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalButtonText;
            }
        });

        // GOOGLE OAUTH FUNCTIONALITY

        // Handle Google login button click
        function initiateGoogleLogin() {
            // Show loading state
            Swal.fire({
                title: 'Connecting to Google',
                text: 'Redirecting to Google authentication...',
                icon: 'info',
                allowOutsideClick: false,
                showConfirmButton: false,
                willOpen: () => {
                    Swal.showLoading();
                }
            });

            // Redirect to Google OAuth
            window.location.href = '/auth/google';
        }

        // Handle Google login callback (when user returns from Google)
        function handleGoogleLoginCallback() {
            const urlParams = new URLSearchParams(window.location.search);
            const googleLogin = urlParams.get('google_login');
            const userName = urlParams.get('name');

            if (googleLogin === 'success' && userName) {
                // Show welcome message
                Swal.fire({
                    title: 'Welcome Back!',
                    text: `Hello ${decodeURIComponent(userName)}! You've successfully logged in with Google.`,
                    icon: 'success',
                    timer: 3000,
                    showConfirmButton: false
                });

                // Clean up URL
                window.history.replaceState({}, document.title, window.location.pathname);

                // Refresh user session
                checkUserSession();
            }
        }

        // Check if user is returning from Google OAuth
        document.addEventListener('DOMContentLoaded', function() {
            handleGoogleLoginCallback();
        });

        // ENHANCED LOGIN FORM (Update your existing login form handler)
        // Add this to your existing login form handler - add the forgot password link functionality

        // Add click handler for "Forgot Password" link in login modal
        document.addEventListener('click', function(e) {
            if (e.target && e.target.id === 'forgotPasswordLink') {
                e.preventDefault();

                // Close login modal
                const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                if (loginModal) {
                    loginModal.hide();
                }

                // Show forgot password modal after a brief delay
                setTimeout(() => {
                    showForgotPasswordModal();
                }, 300);
            }
        });

        // UTILITY FUNCTIONS

        // Enhanced check user session function (add Google user handling)
        async function checkUserSession() {
            try {
                const response = await fetch('/check-session');
                const data = await response.json();

                if (data.authenticated) {
                    currentUser = data.user;
                    sessionStorage.setItem('user', JSON.stringify(data.user));

                    // Handle admin status
                    if (data.user.is_admin) {
                        localStorage.setItem('isAdmin', 'true');
                    } else {
                        localStorage.removeItem('isAdmin');
                        localStorage.removeItem('adminDashboardOpen');
                    }

                    updateAuthUI();

                    // Show Google user indicator if applicable
                    if (data.user.is_google_user) {
                        console.log('Google user logged in');
                    }
                } else {
                    currentUser = null;
                    sessionStorage.removeItem('user');
                    localStorage.removeItem('isAdmin');
                    localStorage.removeItem('adminDashboardOpen');
                    updateAuthUI();
                }
            } catch (error) {
                console.error('Session check error:', error);
            }
        }

        // Enhanced password validation
        function validatePassword(password) {
            if (password.length < 6) {
                return {
                    valid: false,
                    message: 'Password must be at least 6 characters long'
                };
            }

            return {
                valid: true,
                message: 'Password is valid'
            };
        }

        // Show login modal from forgot password (helper function)
        function showLoginModalFromForgotPassword() {
            const forgotPasswordModal = bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal'));
            if (forgotPasswordModal) {
                forgotPasswordModal.hide();
            }

            setTimeout(() => {
                const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                loginModal.show();
            }, 300);
        }

        // Auto-fill email in forgot password modal if user was trying to login
        function prefillForgotPasswordEmail() {
            const loginEmail = document.querySelector('#loginModal input[name="email"]');
            const forgotPasswordEmail = document.getElementById('forgotPasswordEmail');

            if (loginEmail && loginEmail.value && forgotPasswordEmail) {
                forgotPasswordEmail.value = loginEmail.value;
            }
        }

        // Enhanced error handling for authentication
        function handleAuthError(error, context = '') {
            console.error(`Auth error (${context}):`, error);

            let title = 'Authentication Error';
            let message = 'An unexpected error occurred. Please try again.';

            if (error.message && error.message.includes('network')) {
                title = 'Connection Error';
                message = 'Please check your internet connection and try again.';
            } else if (error.message && error.message.includes('timeout')) {
                title = 'Request Timeout';
                message = 'The request took too long. Please try again.';
            }

            Swal.fire({
                title: title,
                text: message,
                icon: 'error',
                confirmButtonColor: '#2563eb'
            });
        }

        // Initialize enhanced authentication features
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listeners for forgot password functionality
            const forgotPasswordLinks = document.querySelectorAll('.forgot-password-link');
            forgotPasswordLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    prefillForgotPasswordEmail();
                    showForgotPasswordModal();
                });
            });

            // Add event listeners for Google login buttons
            const googleLoginButtons = document.querySelectorAll('.google-login-btn');
            googleLoginButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    initiateGoogleLogin();
                });
            });

            // Enhanced form validation
            const passwordInputs = document.querySelectorAll('input[type="password"]');
            passwordInputs.forEach(input => {
                input.addEventListener('blur', function() {
                    if (this.value) {
                        const validation = validatePassword(this.value);
                        if (!validation.valid) {
                            this.classList.add('is-invalid');

                            // Create or update feedback element
                            let feedback = this.parentNode.querySelector('.invalid-feedback');
                            if (!feedback) {
                                feedback = document.createElement('div');
                                feedback.className = 'invalid-feedback';
                                this.parentNode.appendChild(feedback);
                            }
                            feedback.textContent = validation.message;
                        } else {
                            this.classList.remove('is-invalid');
                            const feedback = this.parentNode.querySelector('.invalid-feedback');
                            if (feedback) {
                                feedback.remove();
                            }
                        }
                    }
                });
            });
        });

        // Export functions for use in other modules (if using modules)
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = {
                showForgotPasswordModal,
                initiateGoogleLogin,
                handleGoogleLoginCallback,
                validatePassword,
                handleAuthError
            };
        }
        // UPDATED: Register form handler
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const termsCheckbox = document.getElementById('acceptTerms');
            if (!termsCheckbox.checked) {
                Swal.fire({
                    title: 'Terms Not Accepted',
                    text: 'You must accept the Terms and Conditions to register',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalButtonText = submitBtn.innerHTML;

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Account...';

            try {
                const formData = new FormData(this);
                const response = await fetch('/register', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    // Close the register modal
                    const registerModal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
                    if (registerModal) {
                        registerModal.hide();
                    }

                    // Store email and credentials for auto-login after verification
                    currentUserEmail = formData.get('email');
                    tempUserCredentials = {
                        email: formData.get('email'),
                        password: formData.get('password')
                    };

                    showOtpModal(currentUserEmail);

                    // Reset the form
                    this.reset();
                } else {
                    Swal.fire({
                        title: 'Registration Error',
                        text: data.error || 'Failed to register. Please try again.',
                        icon: 'error',
                        confirmButtonColor: '#2563eb'
                    });
                }
            } catch (error) {
                console.error('Registration error:', error);
                Swal.fire({
                    title: 'Error',
                    text: 'An unexpected error occurred. Please try again.',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalButtonText;
            }
        });

        // NEW: Show OTP Modal Function
        function showOtpModal(email) {
            currentUserEmail = email;
            document.getElementById('otpEmailDisplay').textContent = email;
            document.getElementById('otpInput').value = '';

            const otpModal = new bootstrap.Modal(document.getElementById('otpModal'));
            otpModal.show();

            // Focus on OTP input
            setTimeout(() => {
                document.getElementById('otpInput').focus();
            }, 500);

            // Start resend cooldown
            startResendCooldown();
        }

        // UPDATED: OTP Form Handler with auto-login
        document.getElementById('otpForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalButtonText = submitBtn.innerHTML;
            const otpCode = document.getElementById('otpInput').value.trim();

            if (otpCode.length !== 6) {
                Swal.fire({
                    title: 'Invalid Code',
                    text: 'Please enter a 6-digit verification code',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Verifying...';

            try {
                const response = await fetch('/verify-otp', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: currentUserEmail,
                        otp_code: otpCode
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    // Close OTP modal
                    const otpModal = bootstrap.Modal.getInstance(document.getElementById('otpModal'));
                    if (otpModal) {
                        otpModal.hide();
                    }

                    // Show verification success message
                    Swal.fire({
                        title: 'Email Verified!',
                        text: 'Your account has been successfully verified. Logging you in...',
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    });

                    // Auto-login after successful verification
                    setTimeout(async () => {
                        await performAutoLogin();
                    }, 2000);

                } else {
                    if (data.requires_new_otp) {
                        // Too many attempts - offer to resend
                        Swal.fire({
                            title: 'Too Many Attempts',
                            text: 'Would you like us to send you a new verification code?',
                            icon: 'error',
                            showCancelButton: true,
                            confirmButtonText: 'Send New Code',
                            cancelButtonText: 'Cancel',
                            confirmButtonColor: '#2563eb'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                resendOtp();
                            }
                        });
                    } else {
                        Swal.fire({
                            title: 'Verification Failed',
                            text: data.error || 'Invalid verification code. Please try again.',
                            icon: 'error',
                            confirmButtonColor: '#2563eb'
                        });
                        // Clear the input for retry
                        document.getElementById('otpInput').value = '';
                        document.getElementById('otpInput').focus();
                    }
                }
            } catch (error) {
                console.error('OTP verification error:', error);
                Swal.fire({
                    title: 'Error',
                    text: 'An unexpected error occurred. Please try again.',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalButtonText;
            }
        });

        // NEW: Auto-login function
        async function performAutoLogin() {
            if (!tempUserCredentials) {
                console.error('No stored credentials for auto-login');
                // Show login modal as fallback
                const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                loginModal.show();
                return;
            }

            try {
                // Create FormData with stored credentials
                const formData = new FormData();
                formData.append('email', tempUserCredentials.email);
                formData.append('password', tempUserCredentials.password);

                const response = await fetch('/login', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    // Store user data including admin status
                    currentUser = data.user;
                    sessionStorage.setItem('user', JSON.stringify(data.user));

                    // Manage admin status based on user's role
                    if (data.user.is_admin) {
                        localStorage.setItem('isAdmin', 'true');
                    } else {
                        localStorage.removeItem('isAdmin');
                        localStorage.removeItem('adminDashboardOpen');
                    }

                    // Show welcome message
                    let successMessage = 'Welcome, ' + data.user.full_name + '! Your account is now verified and you\'re logged in.';
                    if (data.user.is_admin) {
                        successMessage += ' (Admin Mode)';
                    }

                    Swal.fire({
                        title: 'Welcome!',
                        text: successMessage,
                        icon: 'success',
                        timer: 3000,
                        showConfirmButton: false
                    });

                    // Update UI based on user role
                    updateAuthUI();

                    // If admin, show admin dashboard after login
                    if (data.user.is_admin) {
                        setTimeout(() => {
                            showAdminDashboard('reports');
                        }, 3000);
                    }

                    // Clear stored credentials for security
                    tempUserCredentials = null;

                } else {
                    console.error('Auto-login failed:', data.error);

                    // Clear stored credentials and show manual login
                    tempUserCredentials = null;

                    Swal.fire({
                        title: 'Login Required',
                        text: 'Your account is verified! Please log in to continue.',
                        icon: 'info',
                        confirmButtonColor: '#2563eb'
                    }).then(() => {
                        const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                        loginModal.show();
                    });
                }
            } catch (error) {
                console.error('Auto-login error:', error);

                // Clear stored credentials and show manual login
                tempUserCredentials = null;

                Swal.fire({
                    title: 'Login Required',
                    text: 'Your account is verified! Please log in to continue.',
                    icon: 'info',
                    confirmButtonColor: '#2563eb'
                }).then(() => {
                    const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                    loginModal.show();
                });
            }
        }

        // NEW: Resend OTP Handler
        document.getElementById('resendOtpBtn').addEventListener('click', function() {
            if (!resendCooldown) {
                resendOtp();
            }
        });

        async function resendOtp() {
            const resendBtn = document.getElementById('resendOtpBtn');
            const originalText = resendBtn.innerHTML;

            resendBtn.disabled = true;
            resendBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';

            try {
                const response = await fetch('/resend-otp', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: currentUserEmail
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    Swal.fire({
                        title: 'Code Sent!',
                        text: 'A new verification code has been sent to your email.',
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    });

                    // Clear the input
                    document.getElementById('otpInput').value = '';
                    document.getElementById('otpInput').focus();

                    // Start cooldown
                    startResendCooldown();
                } else {
                    Swal.fire({
                        title: 'Error',
                        text: data.error || 'Failed to send new code. Please try again.',
                        icon: 'error',
                        confirmButtonColor: '#2563eb'
                    });
                }
            } catch (error) {
                console.error('Resend OTP error:', error);
                Swal.fire({
                    title: 'Error',
                    text: 'An unexpected error occurred. Please try again.',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                resendBtn.disabled = false;
                resendBtn.innerHTML = originalText;
            }
        }

        // NEW: Resend Cooldown Timer
        function startResendCooldown() {
            const resendBtn = document.getElementById('resendOtpBtn');
            const timerDiv = document.getElementById('resendTimer');
            const timerCount = document.getElementById('timerCount');

            resendCooldown = true;
            resendBtn.style.display = 'none';
            timerDiv.style.display = 'block';

            let seconds = 60;
            timerCount.textContent = seconds;

            const countdown = setInterval(() => {
                seconds--;
                timerCount.textContent = seconds;

                if (seconds <= 0) {
                    clearInterval(countdown);
                    resendCooldown = false;
                    resendBtn.style.display = 'inline-block';
                    timerDiv.style.display = 'none';
                }
            }, 1000);
        }

        // NEW: Auto-format OTP input
        document.getElementById('otpInput').addEventListener('input', function(e) {
            // Only allow numbers
            this.value = this.value.replace(/[^0-9]/g, '');

            // Auto-submit when 6 digits are entered
            if (this.value.length === 6) {
                // Small delay to show the complete code
                setTimeout(() => {
                    document.getElementById('otpForm').dispatchEvent(new Event('submit'));
                }, 300);
            }
        });

        // UPDATED: Login form handler - clear temp credentials and handle OTP verification for unverified users
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            // Clear any stored temp credentials when user logs in manually
            tempUserCredentials = null;

            const submitBtn = this.querySelector('button[type="submit"]');
            const originalButtonText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Signing you in...';

            try {
                const formData = new FormData(this);
                const response = await fetch('/login', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (response.ok) {
                    // Store user data including admin status
                    currentUser = data.user;
                    sessionStorage.setItem('user', JSON.stringify(data.user));

                    // Manage admin status based on user's role
                    if (data.user.is_admin) {
                        localStorage.setItem('isAdmin', 'true');
                    } else {
                        localStorage.removeItem('isAdmin');
                        localStorage.removeItem('adminDashboardOpen');
                    }

                    // Close the login modal
                    const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                    if (loginModal) {
                        loginModal.hide();
                    }

                    // Show success message
                    let successMessage = 'Welcome back, ' + data.user.full_name + '!';
                    if (data.user.is_admin) {
                        successMessage += ' (Admin Mode)';
                    }

                    Swal.fire({
                        title: 'Welcome Back!',
                        text: successMessage,
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    });

                    // Update UI based on user role
                    updateAuthUI();

                    // If admin, show admin dashboard after login
                    if (data.user.is_admin) {
                        setTimeout(() => {
                            showAdminDashboard('reports');
                        }, 2000);
                    }

                    // Reset the form
                    this.reset();

                } else {
                    // Handle unverified email with OTP requirement
                    if (data.error_code === 'EMAIL_NOT_VERIFIED' && data.requires_otp) {
                        // Close login modal
                        const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                        if (loginModal) {
                            loginModal.hide();
                        }

                        // Show OTP modal
                        Swal.fire({
                            title: 'Email Verification Required',
                            text: 'We\'ve sent a new verification code to your email. Please verify to continue.',
                            icon: 'info',
                            confirmButtonText: 'Enter Code',
                            confirmButtonColor: '#2563eb'
                        }).then(() => {
                            showOtpModal(data.email);
                        });
                    } else {
                        // Handle other login errors
                        handleLoginMessage(data);
                    }
                }
            } catch (error) {
                console.error('Login error:', error);
                Swal.fire({
                    title: 'Connection Issue',
                    text: 'We\'re having trouble connecting right now. Please check your internet and try again.',
                    icon: 'error',
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalButtonText;
            }
        });

        // Helper functions (you'll need to implement these based on your existing code)
        function handleLoginMessage(data) {
            Swal.fire({
                title: 'Login Failed',
                text: data.error || 'Invalid email or password',
                icon: 'error',
                confirmButtonColor: '#2563eb'
            });
        }
        function showSoldModal(listingId) {
            document.getElementById('listingId').value = listingId;
            new bootstrap.Modal(document.getElementById('soldModal')).show();
        }

        // Mark item as sold
        function markAsSold() {
            const form = document.getElementById('soldForm');
            const formData = new FormData(form);
            const listingId = document.getElementById('listingId').value;

            fetch(`/mark_sold/${listingId}`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Confirmation email sent to buyer!');
                    bootstrap.Modal.getInstance(document.getElementById('soldModal')).hide();
                    // Refresh the page or update the listing display
                    location.reload();
                } else {
                    alert('Error: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred');
            });
        }

        function showAboutUs() {
            const aboutModal = new bootstrap.Modal(document.getElementById('aboutUsModal'));
            aboutModal.show();
        }

        function showContactModal() {
            const contactModal = new bootstrap.Modal(document.getElementById('contactModal'));
            contactModal.show();
        }
        function ShowFAQPageModal(){
            const FAQPageModal = new bootstrap.Modal(document.getElementById('FAQPageModal'));
            FAQPageModal.show();

        }

        function showTermsModal() {
            const termsModal = new bootstrap.Modal(document.getElementById('termsModal'));
            termsModal.show();
        }

        function showPrivacyModal() {
            const privacyModal = new bootstrap.Modal(document.getElementById('privacyModal'));
            privacyModal.show();
        }

        // Contact form submission
        // Form validation script for contact form
        document.addEventListener('DOMContentLoaded', function() {
            const contactForm = document.getElementById('contactForm');

            // Update every 30 seconds

            if (contactForm) {
                // Form submit event handler with validation
                contactForm.addEventListener('submit', function(event) {
                    event.preventDefault();

                    // Check form validity using Bootstrap validation
                    if (!this.checkValidity()) {
                        event.stopPropagation();
                        this.classList.add('was-validated');
                        return;
                    }

                    // Get submit button
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.innerHTML;

                    // Disable button and show loading state
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending...';

                    // Get form data
                    const formData = {
                        name: document.getElementById('contactName').value,
                        email: document.getElementById('contactEmail').value,
                        subject: document.getElementById('contactSubject').value,
                        message: document.getElementById('contactMessage').value
                    };

                    // Send email using fetch API to your server endpoint or a service like Formspree
                    fetch('https://formspree.io/f/myzwpvvp', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(formData)
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('Success:', data);

                        // Show success message
                        Swal.fire({
                            title: 'Message Sent!',
                            text: 'Thank you for contacting us. We will get back to you within 24 hours.',
                            icon: 'success',
                            confirmButtonColor: '#0d6efd',
                            timer: 3000,
                            timerProgressBar: true
                        });

                        // Close modal
                        const contactModal = bootstrap.Modal.getInstance(document.getElementById('contactModal'));
                        if (contactModal) {
                            contactModal.hide();
                        }

                        // Reset form validation state
                        this.classList.remove('was-validated');

                        // Reset form inputs
                        this.reset();
                    })
                    .catch(error => {
                        console.error('Error:', error);

                        // Show error message
                        Swal.fire({
                            title: 'Message Not Sent',
                            text: 'Sorry, there was a problem sending your message. Please try again or use another contact method.',
                            icon: 'error',
                            confirmButtonColor: '#dc3545'
                        });
                    })
                    .finally(() => {
                        // Restore button state
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = originalText;
                    });
                });

                // Real-time validation feedback
                const formInputs = contactForm.querySelectorAll('input, textarea');
                formInputs.forEach(input => {
                    input.addEventListener('blur', function() {
                        // Check validity when input loses focus
                        if (this.checkValidity()) {
                            this.classList.remove('is-invalid');
                            this.classList.add('is-valid');
                        } else {
                            this.classList.remove('is-valid');
                            this.classList.add('is-invalid');
                        }
                    });
                });
            }

            // Check if we're on a buy page (Keep this functionality from your original code)
            const footer = document.querySelector('footer');
            if (footer) {
                if (window.location.pathname.includes('buy') || window.location.href.includes('buy.html')) {
                    footer.style.display = 'none';
                } else {
                    footer.style.display = 'block';
                }
            }
        });
        // Search functionality
        function handleSearch() {
            const query = document.getElementById('searchInput').value;

            if (!query.trim()) {
                showNotification('🔍 Please enter something to search for!', 'warning');
                return;
            }

            // Check if user is authenticated
            if (currentUser) {
                // User is logged in - redirect to buy.html with search query
                window.location.href = `buy.html?search=${encodeURIComponent(query)}`;
            } else {
                // User not logged in - show search results + login modal
                showNotification(`🔍 Searching for "${query}"\n\n📚 Found 45+ textbooks\n💻 Found 12+ laptops\n🧮 Found 8+ calculators\n📝 Found 23+ notes\n\n💡 Tip: Login to purchase items!`, 'info');

                // Show login modal after user sees search results
                setTimeout(() => {
                    showLoginModal();
                }, 2000);
            }
        }

        function quickSearch(category) {
            document.getElementById('searchInput').value = category;

            // Check if user is authenticated
            if (currentUser) {
                // User is logged in - redirect to buy.html with category search
                window.location.href = `buy.html?search=${encodeURIComponent(category)}`;
            } else {
                // User not logged in - show category results + login modal
                const categoryInfo = {
                    'textbooks': '📚 Found 450+ textbooks\n🔥 Most popular: Engineering (120)\n💊 Medical books (85)\n💼 Commerce (95)',
                    'calculator': '🧮 Found 85+ calculators\n⚡ Scientific: 45 units\n📊 Graphing: 25 units\n💰 Financial: 15 units',
                    'laptop': '💻 Found 75+ laptops\n🔥 Gaming laptops: 25\n💼 Business laptops: 30\n🎨 Creative laptops: 20',
                    'notes': '📝 Found 280+ study materials\n📖 Class notes: 120 sets\n📊 Exam guides: 95 items\n🎯 Quick refs: 65 items'
                };

                showNotification(`🔍 Quick search: ${category}\n\n${categoryInfo[category] || 'Loading results...'}\n\n💡 Login to purchase items!`, 'success');

                setTimeout(() => {
                    showLoginModal();
                }, 2500);
            }
        }

        function handleAction(action) {
            // Check if user is authenticated for actions that need login
            if (!currentUser && (action === 'sell' || action === 'browse')) {
                showLoginModal();
                return;
            }

            if (currentUser && action === 'browse') {
                // Logged in user browsing - redirect to buy.html
                window.location.href = 'buy.html';
                return;
            }

            if (currentUser && action === 'sell') {
                // Logged in user selling - redirect to sell page or show sell modal
                handlePathSelection('sell');
                return;
            }

            // Handle other actions (signup, learn)
            const messages = {
                'signup': '🎉 Welcome to StudentsMart!\n\n👉 Campus email gets bonus\n💰 0% fees for first 3 listings\n🛍️ Early access to new features\n✅ Verification takes 2 minutes',
                'learn': '📚 How StudentsMart Works\n\n1️⃣ List items in 2 minutes\n2️⃣ Buyers message you\n3️⃣ Meet on campus\n4️⃣ Get paid instantly\n\n💡 Pro tip: Books rent fastest!'
            };

            showNotification(messages[action] || 'Action completed successfully!', 'success');
        }

        function handleCategory(categoryName) {
            // Check if user is authenticated
            if (currentUser) {
                // User is logged in - redirect to buy.html with category search
                window.location.href = `buy.html?category=${encodeURIComponent(categoryName)}`;
            } else {
                // User not logged in - show category info + login modal
                const categoryInfo = {
                    'Textbooks': '📚 Found 450+ textbooks\nEngineering: 120 books\nMedical: 85 books\nCommerce: 95 books\nArts: 65 books',
                    'Calculators': '🧮 Found 85+ calculators\nScientific: 45 units\nGraphing: 25 units\nFinancial: 15 units',
                    'Lab Equipment': '🔬 Found 200+ lab items\nMicroscopes: 25 units\nGlassware: 85 sets\nSafety gear: 90 items',
                    'Tech & Gadgets': '💻 Found 320+ tech items\nLaptops: 45 units\nTablets: 35 units\nAudio: 95 items',
                    'Notes & Guides': '📝 Found 280+ materials\nClass notes: 120 sets\nExam guides: 95 items\nCheat sheets: 65 items',
                    'Art Supplies': '🎨 Found 150+ art items\nDrawing tools: 45 sets\nPaints: 35 sets\nPortfolios: 25 items'
                };

                showNotification(`📚 Exploring ${categoryName}!\n\n${categoryInfo[categoryName] || 'Loading items...'}\n\n💡 Login to purchase items!`, 'info');

                setTimeout(() => {
                    showLoginModal();
                }, 2500);
            }
        }

        function handlePrice(action, itemName, price) {
            // Check if user is authenticated for purchase actions
            if (!currentUser) {
                showNotification(`🔒 Login required to ${action} "${itemName}"`, 'warning');
                showLoginModal();
                return;
            }


            // User is logged in - proceed with purchase/rent
            const actionText = action === 'rent' ? 'rent' : 'buy';
            const extraInfo = action === 'rent' ?
                '\n📅 Available from tomorrow\n📍 Meet @ Central Library\n⏱️ 2-day minimum rental\n💳 Pay securely in app' :
                '\n📦 Meet for inspection first\n💳 Secure payment via app\n✅ 7-day return guarantee\n📞 Chat with seller';

            showNotification(`🛒 Great choice!\n\nYou want to ${actionText} "${itemName}" for ${price}${extraInfo}`, 'success');
        }

        // Function to show login modal (you'll need to implement this based on your modal)
        function showLoginModal() {
            const loginModal = document.getElementById('loginModal');
            if (loginModal) {
                loginModal.style.display = 'block';
                // Add any other modal opening logic here
            }
        }

        // Function to handle successful login
        function onLoginSuccess() {
            localStorage.setItem('userLoggedIn', 'true');
            // Hide login modal
            const loginModal = document.getElementById('loginModal');
            if (loginModal) {
                loginModal.style.display = 'none';
            }
            // Optionally redirect to buy.html with last search
            const lastSearch = document.getElementById('searchInput').value;
            if (lastSearch.trim()) {
                window.location.href = `buy.html?search=${encodeURIComponent(lastSearch)}`;
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? 'linear-gradient(135deg, #00B894, #008B74)' :
                           type === 'error' ? 'linear-gradient(135deg, #E17055, #D63031)' :
                           type === 'warning' ? 'linear-gradient(135deg, #FDCB6E, #E17055)' :
                           'linear-gradient(135deg, #6C5CE7, #5649D6)'};
                color: white;
                padding: 1.2rem 1.8rem;
                border-radius: 12px;
                font-size: 0.95rem;
                font-weight: 500;
                z-index: 10000;
                animation: slideInRight 0.3s ease-out;
                max-width: 350px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.15);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255,255,255,0.2);
                white-space: pre-line;
                line-height: 1.6;
            `;

            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Animate stats on scroll
        function animateStatsNumbers() {
            const stats = [
                { id: 'activeListings', target: 1250, suffix: '+' },
                { id: 'happyStudents', target: 5200, suffix: '+' },
                { id: 'campusesServed', target: 58, suffix: '+' },
                { id: 'moneySaved', target: 2500000, suffix: '+', prefix: '₹', format: 'money' }
            ];

            stats.forEach(stat => {
                const element = document.getElementById(stat.id);
                if (element) {
                    const observer = new IntersectionObserver((entries) => {
                        if (entries[0].isIntersecting) {
                            animateNumber(element, stat);
                            observer.disconnect();
                        }
                    });
                    observer.observe(element);
                }
            });
        }

        function animateNumber(element, config) {
            let current = 0;
            const increment = config.target / 100;
            const timer = setInterval(() => {
                current += increment;
                if (current >= config.target) {
                    current = config.target;
                    clearInterval(timer);
                }

                let displayValue = Math.floor(current);
                if (config.format === 'money' && displayValue >= 1000000) {
                    displayValue = (displayValue / 1000000).toFixed(1) + 'M';
                } else if (displayValue >= 1000) {
                    displayValue = (displayValue / 1000).toFixed(1) + 'K';
                }

                element.textContent = (config.prefix || '') + displayValue + (config.suffix || '');
            }, 20);
        }

        // Search input enter key support
        // Replace your current keypress event listener with this:

        // Scroll animations
        document.addEventListener('DOMContentLoaded', function() {
            // Animate elements on scroll
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('in-view');
                    }
                });
            }, observerOptions);

            // Observe all elements with animate class
            document.querySelectorAll('.animate').forEach(el => {
                observer.observe(el);
            });

            // Animate stats
            animateStatsNumbers();

            // Navbar scroll effect
            window.addEventListener('scroll', () => {
                const navbar = document.querySelector('.navbar');  // ← Use .navbar instead of getElementById
                if (navbar) {
                    if (window.scrollY > 50) {
                        navbar.style.boxShadow = '0 5px 20px rgba(0,0,0,0.1)';
                    } else {
                        navbar.style.boxShadow = '0 2px 10px rgba(0,0,0,0.05)';
                    }
                }
            });

            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideInRight {
                    from {
                        transform: translateX(30px);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }

                @keyframes slideOutRight {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(30px);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
        });
        // Mobile Menu Toggle Function
        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            const menuToggle = document.querySelector('.mobile-menu-toggle');

            navLinks.classList.toggle('active');
            menuToggle.classList.toggle('active');
        }

        // Close mobile menu when clicking on a link
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                const navLinks = document.getElementById('navLinks');
                const menuToggle = document.querySelector('.mobile-menu-toggle');

                navLinks.classList.remove('active');
                menuToggle.classList.remove('active');
            });
        });

        // Close mobile menu when clicking outside

        document.addEventListener('DOMContentLoaded', function() {
            const yearDropdown = document.getElementById('propertyYear');
            if (yearDropdown) {
                const currentYear = new Date().getFullYear();
                // Add years from current year down to 1900
                for (let year = currentYear; year >= 4; year--) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    yearDropdown.appendChild(option);
                }
            }
            const modal = document.getElementById('aboutUsModal');
            const closeBtn = document.querySelector('.close-btn');

            // Add click event to close button
            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    const bsModal = bootstrap.Modal.getInstance(modal);
                    if (bsModal) {
                        bsModal.hide();
                    }
                });
            }

            // Close modal when clicking outside
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    const bsModal = bootstrap.Modal.getInstance(modal);
                    if (bsModal) {
                        bsModal.hide();
                    }
                }
            });
        });
        // Footer-related functions
        function showAboutUs() {
            const aboutModal = new bootstrap.Modal(document.getElementById('aboutUsModal'));
            aboutModal.show();
        }

        function showContactModal() {
            const contactModal = new bootstrap.Modal(document.getElementById('contactModal'));
            contactModal.show();
        }
        function ShowFAQPageModal(){
            const FAQPageModal = new bootstrap.Modal(document.getElementById('FAQPageModal'));
            FAQPageModal.show();

        }

        function showTermsModal() {
            const termsModal = new bootstrap.Modal(document.getElementById('termsModal'));
            termsModal.show();
        }

        function showPrivacyModal() {
            const privacyModal = new bootstrap.Modal(document.getElementById('privacyModal'));
            privacyModal.show();
        }

        // Contact form submission
        // Form validation script for contact form
        document.addEventListener('DOMContentLoaded', function() {
            const contactForm = document.getElementById('contactForm');

            // Update every 30 seconds

            if (contactForm) {
                // Form submit event handler with validation
                contactForm.addEventListener('submit', function(event) {
                    event.preventDefault();

                    // Check form validity using Bootstrap validation
                    if (!this.checkValidity()) {
                        event.stopPropagation();
                        this.classList.add('was-validated');
                        return;
                    }

                    // Get submit button
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.innerHTML;

                    // Disable button and show loading state
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending...';

                    // Get form data
                    const formData = {
                        name: document.getElementById('contactName').value,
                        email: document.getElementById('contactEmail').value,
                        subject: document.getElementById('contactSubject').value,
                        message: document.getElementById('contactMessage').value
                    };

                    // Send email using fetch API to your server endpoint or a service like Formspree
                    fetch('https://formspree.io/f/myzwpvvp', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(formData)
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('Success:', data);

                        // Show success message
                        Swal.fire({
                            title: 'Message Sent!',
                            text: 'Thank you for contacting us. We will get back to you within 24 hours.',
                            icon: 'success',
                            confirmButtonColor: '#0d6efd',
                            timer: 3000,
                            timerProgressBar: true
                        });

                        // Close modal
                        const contactModal = bootstrap.Modal.getInstance(document.getElementById('contactModal'));
                        if (contactModal) {
                            contactModal.hide();
                        }

                        // Reset form validation state
                        this.classList.remove('was-validated');

                        // Reset form inputs
                        this.reset();
                    })
                    .catch(error => {
                        console.error('Error:', error);

                        // Show error message
                        Swal.fire({
                            title: 'Message Not Sent',
                            text: 'Sorry, there was a problem sending your message. Please try again or use another contact method.',
                            icon: 'error',
                            confirmButtonColor: '#dc3545'
                        });
                    })
                    .finally(() => {
                        // Restore button state
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = originalText;
                    });
                });

                // Real-time validation feedback
                const formInputs = contactForm.querySelectorAll('input, textarea');
                formInputs.forEach(input => {
                    input.addEventListener('blur', function() {
                        // Check validity when input loses focus
                        if (this.checkValidity()) {
                            this.classList.remove('is-invalid');
                            this.classList.add('is-valid');
                        } else {
                            this.classList.remove('is-valid');
                            this.classList.add('is-invalid');
                        }
                    });
                });
            }

            // Check if we're on a buy page (Keep this functionality from your original code)
            const footer = document.querySelector('footer');
            if (footer) {
                if (window.location.pathname.includes('buy') || window.location.href.includes('buy.html')) {
                    footer.style.display = 'none';
                } else {
                    footer.style.display = 'block';
                }
            }
        });
        // Global variables
        let currentUser = null;
        let currentPath = null;
        let currentListingId = null;
        let currentMessageThreadId = null;
        let currentOtherUserId = null;

        // Function to open the report modal
        function openReportModal() {
            console.log("Opening report modal");

            if (!currentListingId || !currentMessageThreadId) {
                console.error("Missing listing ID or message thread ID for report");
                // Try to get from URL if available
                const urlParams = new URLSearchParams(window.location.search);
                const listingId = urlParams.get('listing');

                if (listingId) {
                    currentListingId = listingId;
                } else {
                    showAlert('Error', 'Cannot report at this time. Please try again later.', 'error');
                    return;
                }
            }

            // Set values in the hidden fields
            document.getElementById('reportListingId').value = currentListingId;
            document.getElementById('reportMessageThreadId').value = currentMessageThreadId || '';

            const reportModal = new bootstrap.Modal(document.getElementById('reportModal'));
            reportModal.show();
        }

        // Handle loading messages in the chat
        async function loadMessages(otherUserId, listingId) {
            try {
                console.log(`Loading messages for user ${otherUserId} and listing ${listingId}`);
                currentOtherUserId = otherUserId;
                currentListingId = listingId;

                const response = await fetch(`/api/messages?other_user_id=${otherUserId}&listing_id=${listingId}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to load messages');

                const data = await response.json();
                const messages = data.messages || [];

                console.log(`Loaded ${messages.length} messages`);

                // Set the first message's ID as the thread ID for reporting
                if (messages && messages.length > 0) {
                    currentMessageThreadId = messages[0].id;
                    console.log(`Set message thread ID to ${currentMessageThreadId}`);
                } else {
                    // If no messages exist yet, we need to create a placeholder message thread ID
                    // This can be a timestamp or other unique identifier
                    currentMessageThreadId = `temp_${Date.now()}`;
                    console.log(`No messages found, using temporary ID: ${currentMessageThreadId}`);
                }

                // Update the chat window UI with messages...
                // [existing message display code]

            } catch (error) {
                console.error('Error loading messages:', error);
            }
        }

        // Handle report form submission
        document.getElementById('reportForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData();
            const listingId = document.getElementById('reportListingId').value;
            const messageThreadId = document.getElementById('reportMessageThreadId').value;
            const description = document.getElementById('reportDescription').value;

            if (!description) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Please describe the issue you\'re reporting.'
                });
                return;
            }

            // Always ensure we have a message thread ID (even if temporary)
            if (!messageThreadId) {
                const tempId = `temp_${Date.now()}`;
                console.log("Created temporary ID for form submission:", tempId);
                formData.append('message_thread_id', tempId);
            } else {
                formData.append('message_thread_id', messageThreadId);
            }

            // Add listing ID if available
            if (listingId) {
                formData.append('listing_id', listingId);
            }

            formData.append('description', description);

            const reportImage = document.getElementById('reportImage').files[0];
            if (reportImage) {
                formData.append('image', reportImage);
            }

            try {
                // Show loading state
                Swal.fire({
                    title: 'Submitting report...',
                    text: 'Please wait',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                const response = await fetch('/api/report/create', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                if (response.ok) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Report Submitted',
                        text: 'Thank you for your report. We will review it shortly.'
                    });
                    closeReportModal();

                    // Clear the form
                    document.getElementById('reportDescription').value = '';
                    document.getElementById('reportImage').value = '';
                    document.getElementById('reportPreviewImage').classList.add('d-none');
                } else {
                    throw new Error(data.error || 'Failed to submit report');
                }
            } catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: error.message
                });
            }
        });

        // Preview report image
        document.getElementById('reportImage').addEventListener('change', (e) => {
            const file = e.target.files[0];
            const preview = document.getElementById('reportPreviewImage');

            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    preview.src = e.target.result;
                    preview.classList.remove('d-none');
                };
                reader.readAsDataURL(file);
            } else {
                preview.classList.add('d-none');
            }
        });

        // Enhanced JavaScript functionality
        const modals = {
            login: new bootstrap.Modal(document.getElementById('loginModal')),
            register: new bootstrap.Modal(document.getElementById('registerModal')),
            createListing: new bootstrap.Modal(document.getElementById('createListingModal'))
        };

        // Add this function to handle path selection
        // Update the handlePathSelection function:
        function handlePathSelection(path) {
    // Check if user is authenticated
            if (!currentUser) {
                showLoginModal();
                return;
            }

            // Handle different path selections
            if (path === 'buy') {
                // Redirect to buy.html page
                window.location.href = 'buy.html';
            } else if (path === 'sell') {
                // Show create listing modal
                showCreateListing();
            }
        }

        // Add this to your DOMContentLoaded event listener
        document.addEventListener('DOMContentLoaded', () => {
            // ... existing code ...

            // Hide search section by default on home page
            const searchSection = document.querySelector('.search-section');
            if (searchSection) {
                searchSection.style.display = 'none';
            }

            // Only show search section if we're on a specific path
            if (currentPath === 'buy' && searchSection) {
                searchSection.style.display = 'block';
            }
            const collegeFilter = document.getElementById('collegeFilter');
            if (currentUser && currentUser.college && collegeFilter) {
                collegeFilter.value = currentUser.college;
            }

            // Add event listener for college filter change
            if (collegeFilter) {
                collegeFilter.addEventListener('change', function() {
                    loadListings();
                });
            }

            // ... rest of your code ...
        });

        // Utility Functions

        function showAlert(title, text, icon) {
            Swal.fire({
                title,
                text,
                icon,
                confirmButtonColor: '#2563eb'
            });
        }

        // Modal Functions
        function showLoginModal() {
            modals.login.show();
        }

        function showRegisterModal() {
            modals.register.show();
        }

        function showCreateListing() {
            if (!currentUser) {
                showAlert('Please Login', 'You need to login to create a listing', 'warning');
                return;
            }
            const createListingModal = new bootstrap.Modal(document.getElementById('createListingModal'));
            createListingModal.show();
        }

        // Authentication Functions
        function updateAuthUI() {
            if (currentUser) {
                // Show user menu, hide auth buttons
                document.getElementById('userMenu').classList.remove('d-none');
                document.getElementById('authButtons').classList.add('d-none');
                document.getElementById('notificationMenu').classList.remove('d-none');
                document.getElementById('userName').textContent = currentUser.full_name;

                // Show admin menu if user is admin
                if (currentUser.is_admin) {
                    document.getElementById('adminMenu').classList.remove('d-none');
                    document.getElementById('reportsMenu').classList.remove('d-none');

                    // Get report count
                    fetch('/admin/dashboard')
                        .then(response => response.json())
                        .then(data => {
                            const pendingReports = data.stats.pending_reports || 0;
                            document.getElementById('navReportsBadge').textContent = pendingReports;

                            if (pendingReports > 0) {
                                document.getElementById('navReportsBadge').style.display = 'inline-block';
                            } else {
                                document.getElementById('navReportsBadge').style.display = 'none';
                            }
                        })
                        .catch(error => console.error('Error fetching report counts:', error));
                } else {
                    document.getElementById('adminMenu').classList.add('d-none');
                    document.getElementById('reportsMenu').classList.add('d-none');
                }
            } else {
                // Show auth buttons, hide user menu
                document.getElementById('userMenu').classList.add('d-none');
                document.getElementById('notificationMenu').classList.add('d-none');
                document.getElementById('authButtons').classList.remove('d-none');
                document.getElementById('adminMenu').classList.add('d-none');
                document.getElementById('reportsMenu').classList.add('d-none');
            }
        }

        async function logout() {
            try {
                await fetch('/logout', {
                    method: 'GET',
                    credentials: 'same-origin'
                });

                // Clear all admin-related localStorage items
                localStorage.removeItem('isAdmin');
                localStorage.removeItem('adminDashboardOpen');

                currentUser = null;
                updateAuthUI();

                // Show success message
                Swal.fire({
                    title: 'Success',
                    text: 'Logged out successfully',
                    icon: 'success',
                    timer: 2000,
                    showConfirmButton: false
                });

                // Reset any path-specific UI elements
                const heroSection = document.querySelector('.hero-section');
                const listingsSection = document.getElementById('listingsSection');

                // Show hero section (home page) and hide listings section
                heroSection.style.display = 'flex';
                listingsSection.style.display = 'none';

                // Reset current path
                currentPath = null;

                // Optionally, you could redirect to the root URL after a short delay
                setTimeout(() => {
                    window.location.href = '/';
                }, 2000);
            } catch (error) {
                showAlert('Error', 'Failed to logout', 'error');
            }
        }

        // Listing Functions

        // Add this to your main.js file or include it as a script
        (async function debugAPI() {
            try {
            const response = await fetch('/listings', {credentials: 'same-origin'});
            const data = await response.json();
            console.log("All listings data:", data);

            // Check specifically for the CFGVBHJN listing
            const targetListing = data.listings.find(l => l.title === "CFGVBHJN");
            if (targetListing) {
                console.log("Target listing found:", targetListing);
                console.log("is_softcopy value:", targetListing.is_softcopy);
                console.log("file_url value:", targetListing.file_url);
            } else {
                console.log("Target listing 'CFGVBHJN' not found in response");
            }
            } catch (error) {
            console.error("Debug API error:", error);
            }
        })();

        async function contactSeller(listingId) {
            if (!currentUser) {
                showAlert('Please Login', 'You need to login to contact sellers', 'warning');
                return;
            }

            try {
                // First get the listing details
                const response = await fetch(`/listings?id=${listingId}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to fetch listing details');

                const data = await response.json();
                const listing = data.listings[0];

                const { value: message } = await Swal.fire({
                    title: 'Send Message to Seller',
                    input: 'textarea',
                    inputLabel: 'Your message',
                    inputPlaceholder: 'Type your message here...',
                    inputAttributes: {
                        'aria-label': 'Type your message here'
                    },
                    showCancelButton: true,
                    confirmButtonText: 'Send Message',
                    showLoaderOnConfirm: true,
                    inputValidator: (value) => {
                        if (!value) {
                            return 'You need to write something!'
                        }
                    },
                    preConfirm: (message) => {
                        // This function runs when the user clicks "Send Message"
                        return fetch('/api/messages/send', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            receiver_id: listing.seller.id,
                            listing_id: listingId,
                            content: message
                        }),
                        credentials: 'same-origin'
                        })
                        .then(response => {
                            if (!response.ok) throw new Error('Failed to send message');
                            return response.json();
                        })
                        .catch(error => {
                            Swal.showValidationMessage(`Request failed: ${error.message}`);
                        });
                    },
                    allowOutsideClick: () => !Swal.isLoading()
                });

                if (message) {
                    // This runs after the message was successfully sent
                    Swal.fire({
                        title: 'Message Sent!',
                        text: 'Your message has been sent to the seller.',
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    });

                    // Optionally, you can open the chat modal to show the conversation
                    setTimeout(() => {
                        const chatModal = new bootstrap.Modal(document.getElementById('chatModal'));
                        chatModal.show();
                        // This will find and open the chat with the seller
                        setTimeout(() => {
                            const chatItems = document.querySelectorAll('.chat-item');
                            const sellerName = listing.seller.name;
                            for (const item of chatItems) {
                                if (item.querySelector('h6').textContent === sellerName) {
                                    item.click();
                                    break;
                                }
                            }
                        }, 500);
                    }, 2000);
                }
            } catch (error) {
                console.error('Error contacting seller:', error);
                showAlert('Error', error.message, 'error');
            }
        }


        async function addToWishlist(listingId) {
            if (!currentUser) {
                showAlert('Please Login', 'You need to login to add items to wishlist', 'warning');
                return;
            }

            try {
                // Show loading state on the button if possible
                const wishlistButton = event.target.closest('button');
                if (wishlistButton) {
                    const originalText = wishlistButton.innerHTML;
                    wishlistButton.disabled = true;
                    wishlistButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Adding...';
                }

                const response = await fetch('/api/wishlist/add', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ listing_id: listingId }),
                    credentials: 'same-origin'
                });

                const data = await response.json();

                if (!response.ok) throw new Error(data.error || 'Failed to add to wishlist');

                // Show success feedback
                Swal.fire({
                    title: 'Added to Wishlist!',
                    text: data.message || 'Item has been added to your wishlist',
                    icon: 'success',
                    timer: 2000,
                    showConfirmButton: false
                });

                // Visual feedback on the button if it exists
                if (wishlistButton) {
                    wishlistButton.innerHTML = '<i class="fas fa-heart me-2"></i>Added to Wishlist';
                    wishlistButton.classList.remove('btn-outline-primary');
                    wishlistButton.classList.add('btn-success');

                    // Disable the button to prevent multiple additions
                    setTimeout(() => {
                        wishlistButton.disabled = false;
                    }, 2000);
                }
            } catch (error) {
                console.error('Wishlist error:', error);
                showAlert('Error', error.message, 'error');

                // Reset button if it exists
                if (wishlistButton) {
                    wishlistButton.disabled = false;
                    wishlistButton.innerHTML = '<i class="fas fa-heart me-2"></i>Add to Wishlist';
                }
            }
        }
        function populateCollegeDropdowns() {
            const sortedColleges = colleges.sort();

            // Populate registration form dropdown
            const registerForm = document.getElementById('collegeSelect');
            sortedColleges.forEach(college => {
                const option = document.createElement('option');
                option.value = college;
                option.textContent = college;
                registerForm.appendChild(option);
            });

            // Populate search filter dropdown
            const filterSelect = document.getElementById('collegeFilter');
            sortedColleges.forEach(college => {
                const option = document.createElement('option');
                option.value = college;
                option.textContent = college;
                filterSelect.appendChild(option);
            });
        }





        async function showMessages() {
            if (!currentUser) {
                showAlert('Please Login', 'You need to login to view your messages', 'warning');
                return;
            }

            try {
                const response = await fetch('/api/messages', {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to fetch messages');

                const data = await response.json();

                const messagesHtml = data.messages.map(message => {
                    const repliesHtml = message.replies.map(reply => `
                        <div class="card-body border-start border-primary ms-4 mt-2">
                            <h6 class="card-subtitle mb-2 text-muted">
                                Reply from ${reply.sender.name}
                            </h6>
                            <p class="card-text">${reply.content}</p>
                            <p class="card-text">
                                <small class="text-muted">
                                    ${new Date(reply.created_at).toLocaleString()}
                                </small>
                            </p>
                        </div>
                    `).join('');

                    return `
                        <div class="card mb-3 ${message.sender.id === currentUser.id ? 'border-primary' : 'border-success'}">
                            <div class="card-body">
                                <h6 class="card-subtitle mb-2 text-muted">
                                    ${message.sender.id === currentUser.id ? 'Sent to' : 'From'}:
                                    ${message.sender.id === currentUser.id ? message.receiver.name : message.sender.name}
                                </h6>
                                <p class="card-text">${message.content}</p>
                                <p class="card-text">
                                    <small class="text-muted">
                                        Re: ${message.listing.title}
                                        <br>
                                        ${new Date(message.created_at).toLocaleString()}
                                    </small>
                                </p>
                                <button class="btn btn-sm btn-primary" onclick="replyToMessage(${message.id}, '${message.sender.id === currentUser.id ? message.receiver.name : message.sender.name}')">
                                    <i class="fas fa-reply me-2"></i>Reply
                                </button>
                            </div>
                            ${repliesHtml}
                        </div>
                    `;
                }).join('');

                Swal.fire({
                    title: 'My Messages',
                    html: `<div class="messages-container">${messagesHtml}</div>`,
                    width: '80%',
                    confirmButtonText: 'Close'
                });
            } catch (error) {
                showAlert('Error', error.message, 'error');
            }
        }

        async function replyToMessage(messageId, recipientName) {
            try {
                const { value: content } = await Swal.fire({
                    title: `Reply to ${recipientName}`,
                    input: 'textarea',
                    inputLabel: 'Your reply',
                    inputPlaceholder: 'Type your reply here...',
                    showCancelButton: true,
                    inputValidator: (value) => {
                        if (!value) {
                            return 'You need to write something!';
                        }
                    }
                });

                if (content) {
                    const response = await fetch('/api/messages/reply', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            parent_message_id: messageId,
                            content: content
                        }),
                        credentials: 'same-origin'
                    });

                    if (!response.ok) throw new Error('Failed to send reply');

                    showAlert('Success', 'Reply sent successfully', 'success');
                    showMessages(); // Refresh the messages view
                }
            } catch (error) {
                showAlert('Error', error.message, 'error');
            }
        }

        // Check session status on page load
        async function checkSession() {
            try {
                const response = await fetch('/check-session', {
                    credentials: 'same-origin'
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.authenticated) {
                        currentUser = data.user;

                        // Clear any existing admin status in localStorage first
                        if (!currentUser.is_admin) {
                            localStorage.removeItem('isAdmin');
                            localStorage.removeItem('adminDashboardOpen');
                            console.log("Cleared admin status from localStorage for non-admin user");
                        } else {
                            // Only set admin status if the current authenticated user is an admin
                            localStorage.setItem('isAdmin', 'true');
                            console.log("Admin status stored in localStorage");
                        }

                        updateAuthUI();
                        // After successful login, update the mobile menu
                        updateMobileUserInfo();

                        // Only use localStorage admin status if the user is actually an admin
                        // This prevents a non-admin from getting admin privileges
                        if (localStorage.getItem('isAdmin') === 'true' && currentUser.is_admin) {
                            console.log("Admin status confirmed, enabling admin features");

                            // Show admin elements right away
                            document.getElementById('adminMenu').classList.remove('d-none');
                            document.getElementById('reportsMenu').classList.remove('d-none');

                            // If the adminDashboardModal was open before refresh, reopen it
                            if (localStorage.getItem('adminDashboardOpen') === 'true') {
                                console.log("Reopening admin dashboard after refresh");
                                setTimeout(() => {
                                    showAdminDashboard();
                                }, 500);
                            }
                        }

                        // If page is loaded with admin flag, show dashboard only if user is admin
                        const urlParams = new URLSearchParams(window.location.search);
                        if (urlParams.get('admin') === 'true' && currentUser.is_admin) {
                            showAdminDashboard();
                        }
                    } else {
                        // Not authenticated, clear any admin status
                        localStorage.removeItem('isAdmin');
                        localStorage.removeItem('adminDashboardOpen');
                    }
                }
            } catch (error) {
                console.error('Session check failed:', error);
            }
        }

        // Event Listeners
        // Modify your DOMContentLoaded event listener
        document.addEventListener('DOMContentLoaded', () => {
            const collegeFilter = document.getElementById('collegeFilter');
            if (currentUser && currentUser.college && collegeFilter) {
                collegeFilter.value = currentUser.college;
            }

            // Add event listener for college filter change
            if (collegeFilter) {
                collegeFilter.addEventListener('change', function() {
                    loadListings();
                });
            }

            // Create skeleton loading cards
            const skeleton = document.getElementById('loadingSkeleton');
            for (let i = 0; i < 8; i++) {
                skeleton.innerHTML += `
                <div class="col-md-4 col-lg-3">
                    <div class="listing-card">
                        <div class="skeleton-loading" style="height: 200px;"></div>
                        <div class="listing-content">
                            <div class="skeleton-loading" style="height: 24px; width: 80%; margin-bottom: 12px;"></div>
                            <div class="skeleton-loading" style="height: 18px; width: 60%; margin-bottom: 12px;"></div>
                            <div class="skeleton-loading" style="height: 18px; width: 40%; margin-bottom: 12px;"></div>
                        </div>
                    </div>
                </div>
                `;
            }

            // Check if user is logged in
            checkSession();
            populateCollegeDropdowns();

            // Add event listeners for search and filters
            document.getElementById('searchInput').addEventListener('input', debounce(loadListings, 500));
            document.getElementById('categoryFilter').addEventListener('change', loadListings);
            document.getElementById('sortFilter').addEventListener('change', loadListings);
            document.getElementById('collegeFilter').addEventListener('change', loadListings);

            // Initialize my listings page if we're on that page


            // Initialize wishlist page if we're on that page

        });
        async function showMyListings() {
            if (!currentUser) {
                showAlert('Please Login', 'You need to login to view your listings', 'warning');
                return;
            }
            // Open the dedicated my-listings page
            window.open('/my-listings.html', '_blank');
        }

        // Add this function to handle the my-listings page load


        async function showWishlist() {
            if (!currentUser) {
                showAlert('Please Login', 'You need to login to view your wishlist', 'warning');
                return;
            }
            // Open the dedicated my-wishlist page
            window.open('/my-wishlist.html', '_blank');
        }

        // Add this function to handle the wishlist page initialization
        function initializeWishlistPage() {
            if (window.location.pathname === '/my-wishlist') {
                const heroSection = document.querySelector('.hero-section');
                const searchSection = document.querySelector('.search-section');

                if (heroSection) heroSection.style.display = 'none';
                if (searchSection) searchSection.style.display = 'none';

                // Show loading state
                const listingsGrid = document.getElementById('listingsGrid');
                if (listingsGrid) {
                    listingsGrid.innerHTML = '<div class="text-center w-100 py-5"><i class="fas fa-spinner fa-spin fa-2x"></i></div>';

                    // Load wishlist items
                    fetch('/api/wishlist', {
                        credentials: 'same-origin'
                    })
                    .then(response => response.json())
                    .then(data => {
                        // Create the header with title
                        listingsGrid.innerHTML = `
                        <div class="col-12 mb-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <h2 class="mb-0">My Wishlist</h2>
                            </div>
                        </div>
                        `;

                        if (data.items.length === 0) {
                            listingsGrid.innerHTML += `
                            <div class="col-12 text-center">
                                <div class="alert alert-info">
                                    <i class="fas fa-info-circle me-2"></i>
                                    Your wishlist is empty. Browse listings to add items to your wishlist.
                                </div>
                            </div>
                            `;
                            return;
                        }

                        // Add each wishlist item to the grid
                        data.items.forEach(item => {
                            const imageUrl = item.listing.image_url.startsWith('http') ?
                                item.listing.image_url : `/static/${item.listing.image_url}`;

                            listingsGrid.innerHTML += `
                            <div class="col-md-4 mb-4">
                                <div class="card h-100">
                                    <img src="${imageUrl}" class="card-img-top" alt="${item.listing.title}"
                                        style="height: 200px; object-fit: cover;">
                                    <div class="card-body">
                                        <h5 class="card-title">${item.listing.title}</h5>
                                        <p class="card-text text-muted">?${item.listing.price}</p>
                                        <p class="card-text">Seller: ${item.listing.seller.name}</p>
                                        <div class="d-flex gap-2">
                                            <button class="btn btn-primary btn-sm flex-grow-1"
                                                onclick="contactSeller(${item.listing.id})">
                                                <i class="fas fa-envelope me-2"></i>Contact Seller
                                            </button>
                                            <button class="btn btn-danger btn-sm flex-grow-1"
                                                onclick="removeFromWishlist(${item.id})">
                                                <i class="fas fa-trash me-2"></i>Remove
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            `;
                        });
                    })
                    .catch(error => {
                        showAlert('Error', error.message, 'error');
                    });
                }
            }
        }
        console.log(typeof bootstrap);

// Test if the dropdown element exists
        console.log(document.getElementById('userDropdown'));

        // Manually trigger dropdown
        const dropdown = new bootstrap.Dropdown(document.getElementById('userDropdown'));
        dropdown.toggle();

        // Add this function to remove items from wishlist
        async function removeFromWishlist(wishlistId) {
            try {
                const result = await Swal.fire({
                    title: 'Remove from Wishlist',
                    text: 'Are you sure you want to remove this item from your wishlist?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: 'Yes, remove it!'
                });

                if (result.isConfirmed) {
                    const response = await fetch(`/api/wishlist/${wishlistId}`, {
                        method: 'DELETE',
                        credentials: 'same-origin'
                    });

                    if (!response.ok) {
                        const data = await response.json();
                        throw new Error(data.error || 'Failed to remove from wishlist');
                    }

                    Swal.fire(
                        'Removed!',
                        'The item has been removed from your wishlist.',
                        'success'
                    );

                    // Refresh the wishlist page
                    initializeWishlistPage();
                }
            } catch (error) {
                showAlert('Error', error.message, 'error');
            }
        }

        function viewListing(listingId) {
            // Fetch the listing details
            fetch(`/listings?id=${listingId}`, {
            credentials: 'same-origin'
            })
            .then(response => {
            if (!response.ok) throw new Error('Failed to fetch listing details');
            return response.json();
            })
            .then(data => {
            if (!data.listings || data.listings.length === 0) {
                throw new Error('Listing not found');
            }

            const listing = data.listings[0];

            // Create a modal to display the listing details
            Swal.fire({
                title: listing.title,
                html: `
                <div class="text-center mb-3">
                    <img src="${listing.image_url.startsWith('http') ? listing.image_url : `/static/${listing.image_url}`}"
                        class="img-fluid rounded" style="max-height: 300px;" alt="${listing.title}">
                </div>
                <div class="text-start">
                    <p class="mb-2"><strong>Price:</strong> ?${listing.price}</p>
                    <p class="mb-2"><strong>Category:</strong> ${listing.category}</p>
                    <p class="mb-2"><strong>Condition:</strong> ${listing.condition}</p>
                    <p class="mb-2"><strong>Seller:</strong> ${listing.seller.name}</p>
                    <p class="mb-2"><strong>Description:</strong> ${listing.description}</p>
                </div>
                `,
                width: '600px',
                showCancelButton: true,
                confirmButtonText: 'Contact Seller',
                cancelButtonText: 'Close'
            }).then((result) => {
                if (result.isConfirmed) {
                contactSeller(listing.id);
                }
            });
            })
            .catch(error => {
            console.error('Error viewing listing:', error);
            showAlert('Error', error.message, 'error');
            });
        }


        // Function to delete a listing

        // Form submission handlers with enhanced error handling and validation

        function handleLoginMessage(data) {
            const errorCode = data.error_code || data.error;

            switch (errorCode) {
                case 'EMAIL_NOT_VERIFIED':
                case 'email_not_verified':
                case 'UNVERIFIED_EMAIL':
                    showEmailVerificationModal(data.email);
                    break;

                case 'INVALID_CREDENTIALS':
                case 'invalid_credentials':
                case 'WRONG_PASSWORD':
                case 'wrong_password':
                    showCredentialsHelpModal();
                    break;

                case 'ACCOUNT_LOCKED':
                case 'account_locked':
                    showAccountLockedModal();
                    break;

                case 'ACCOUNT_DEACTIVATED':
                case 'account_deactivated':
                    showAccountDeactivatedModal();
                    break;

                default:
                    showGenericHelpModal(data.message);
                    break;
            }
        }

        function showEmailVerificationModal(email) {
            const isGmail = email && (email.includes('@gmail.com') || email.includes('@googlemail.com'));

            Swal.fire({
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-envelope-open" style="font-size: 32px; color: white;"></i>
                        </div>

                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-weight: 600;">Check Your Email</h3>

                        <p style="color: #5a6c7d; margin-bottom: 20px; line-height: 1.6;">
                            We've sent a verification link to your email address. Please click the link to verify your account and access your dashboard.
                        </p>

                        <div style="background: #f8f9fb; padding: 15px; border-radius: 10px; margin: 20px 0;">
                            <p style="color: #667eea; font-weight: 500; margin: 0;">
                                <i class="fas fa-envelope" style="margin-right: 8px;"></i>
                                ${email || 'your email address'}
                            </p>
                        </div>

                        <p style="color: #95a5a6; font-size: 14px; margin-top: 20px;">
                            <i class="fas fa-lightbulb" style="color: #f39c12; margin-right: 5px;"></i>
                            Don't see it? Check your spam folder
                        </p>
                    </div>
                `,
                showConfirmButton: true,
                showCancelButton: false,
                confirmButtonText: isGmail ? '<i class="fas fa-external-link-alt"></i> Open Gmail' : '<i class="fas fa-external-link-alt"></i> Open Email App',
                confirmButtonColor: '#667eea',
                buttonsStyling: true,
                customClass: {
                    popup: 'swal2-no-border',
                    confirmButton: 'swal2-styled-button'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    if (isGmail) {
                        // Open Gmail with specific account
                        window.open(`https://mail.google.com/mail/u/${email}/#inbox`, '_blank');
                    } else {
                        window.location.href = 'mailto:';
                    }
                }
            });
        }
        function showCredentialsHelpModal() {
            Swal.fire({
                html: `
                    <div style="text-align: center; padding: 30px 20px;">
                        <div style="width: 90px; height: 90px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);">
                            <i class="fas fa-key" style="font-size: 36px; color: white;"></i>
                        </div>

                        <h2 style="color: #2c3e50; margin-bottom: 20px; font-weight: 700; font-size: 28px;">Let's Get You Signed In</h2>

                        <p style="color: #6c7b7f; margin-bottom: 35px; line-height: 1.7; font-size: 16px; max-width: 400px; margin-left: auto; margin-right: auto;">
                            No worries! Let's double-check a few things to help you access your account smoothly.
                        </p>

                        <div style="background: linear-gradient(135deg, #f8f9ff 0%, #e8f2ff 100%); border: 2px solid #e3f2fd; padding: 25px; border-radius: 15px; margin: 25px 0; text-align: left; max-width: 420px; margin-left: auto; margin-right: auto;">
                            <h4 style="color: #1565c0; margin: 0 0 20px 0; font-size: 18px; font-weight: 600; text-align: center;">
                                <i class="fas fa-lightbulb" style="margin-right: 10px; color: #ffa726;"></i>
                                Quick Checklist:
                            </h4>
                            <div style="space-y: 12px;">
                                <div style="display: flex; align-items: center; margin-bottom: 15px; color: #37474f;">
                                    <div style="width: 8px; height: 8px; background: #667eea; border-radius: 50%; margin-right: 15px; flex-shrink: 0;"></div>
                                    <span style="font-size: 15px; line-height: 1.4;">Verify your email address is correct</span>
                                </div>
                                <div style="display: flex; align-items: center; margin-bottom: 15px; color: #37474f;">
                                    <div style="width: 8px; height: 8px; background: #667eea; border-radius: 50%; margin-right: 15px; flex-shrink: 0;"></div>
                                    <span style="font-size: 15px; line-height: 1.4;">Check if Caps Lock is turned off</span>
                                </div>
                                <div style="display: flex; align-items: center; color: #37474f;">
                                    <div style="width: 8px; height: 8px; background: #667eea; border-radius: 50%; margin-right: 15px; flex-shrink: 0;"></div>
                                    <span style="font-size: 15px; line-height: 1.4;">Re-type your password carefully</span>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 30px;">
                            <p style="color: #78909c; font-size: 14px; margin-bottom: 20px;">
                                Ready to give it another try?
                            </p>
                        </div>
                    </div>
                `,
                showConfirmButton: true,
                showCancelButton: false,
                confirmButtonText: '<i class="fas fa-redo" style="margin-right: 8px;"></i>Try Again',
                confirmButtonColor: '#667eea',
                buttonsStyling: true,
                customClass: {
                    popup: 'swal2-no-border',
                    confirmButton: 'custom-confirm-btn'
                },
                didOpen: () => {
                    // Add custom styling for the button
                    const style = document.createElement('style');
                    style.textContent = `
                        .custom-confirm-btn {
                            padding: 12px 30px !important;
                            font-size: 16px !important;
                            font-weight: 600 !important;
                            border-radius: 25px !important;
                            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3) !important;
                            transition: all 0.3s ease !important;
                        }
                        .custom-confirm-btn:hover {
                            transform: translateY(-2px) !important;
                            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4) !important;
                        }
                        .swal2-no-border {
                            border-radius: 20px !important;
                            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1) !important;
                        }
                    `;
                    document.head.appendChild(style);
                }
            });
        }
        function showAccountLockedModal() {
            Swal.fire({
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%); border-radius: 50%; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-shield-alt" style="font-size: 32px; color: white;"></i>
                        </div>

                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-weight: 600;">Account Security Check</h3>

                        <p style="color: #5a6c7d; margin-bottom: 25px; line-height: 1.6;">
                            To keep your account safe, we've temporarily paused sign-in attempts. You can try again in a few minutes.
                        </p>

                        <div style="background: #f8f9fb; padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <p style="color: #667eea; margin: 0; font-weight: 500;">
                                <i class="fas fa-clock" style="margin-right: 8px;"></i>
                                Try again in 15 minutes
                            </p>
                        </div>

                        <p style="color: #95a5a6; font-size: 14px; margin-top: 20px;">
                            Need immediate access? Our support team can help.
                        </p>
                    </div>
                `,
                showConfirmButton: true,
                showCancelButton: true,
                confirmButtonText: 'Contact Support',
                cancelButtonText: 'I\'ll Wait',
                confirmButtonColor: '#667eea',
                cancelButtonColor: '#95a5a6'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.open('mailto:support@yoursite.com?subject=Account Access Help', '_blank');
                }
            });
        }

        function showAccountDeactivatedModal() {
            Swal.fire({
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%); border-radius: 50%; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-user-cog" style="font-size: 32px; color: white;"></i>
                        </div>

                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-weight: 600;">Account Needs Reactivation</h3>

                        <p style="color: #5a6c7d; margin-bottom: 25px; line-height: 1.6;">
                            Your account is currently inactive. Our support team can help reactivate it and get you back up and running.
                        </p>

                        <div style="background: #f8f9fb; padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <p style="color: #667eea; margin: 0; font-weight: 500;">
                                <i class="fas fa-headset" style="margin-right: 8px;"></i>
                                We're here to help - just reach out!
                            </p>
                        </div>
                    </div>
                `,
                showConfirmButton: true,
                confirmButtonText: 'Contact Support',
                confirmButtonColor: '#667eea'
            }).then(() => {
                window.open('mailto:support@yoursite.com?subject=Account Reactivation Request', '_blank');
            });
        }

        function showGenericHelpModal(message) {
            Swal.fire({
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%); border-radius: 50%; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-question-circle" style="font-size: 32px; color: white;"></i>
                        </div>

                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-weight: 600;">We're Here to Help</h3>

                        <p style="color: #5a6c7d; margin-bottom: 25px; line-height: 1.6;">
                            ${message || 'Something didn\'t work as expected. Let\'s get this sorted out for you.'}
                        </p>

                        <div style="background: #f8f9fb; padding: 20px; border-radius: 10px; margin: 20px 0;">
                            <p style="color: #667eea; margin: 0; font-weight: 500;">
                                <i class="fas fa-redo" style="margin-right: 8px;"></i>
                                Please try again, or contact us if the issue persists
                            </p>
                        </div>
                    </div>
                `,
                showConfirmButton: true,
                confirmButtonText: 'Try Again',
                confirmButtonColor: '#667eea'
            });
        }

        function showFriendlyMessage(config) {
            const icons = {
                connection: 'fas fa-wifi',
                success: 'fas fa-check-circle',
                info: 'fas fa-info-circle',
                warning: 'fas fa-exclamation-triangle'
            };

            const colors = {
                connection: '#74b9ff',
                success: '#00b894',
                info: '#667eea',
                warning: '#fdcb6e'
            };

            Swal.fire({
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="width: 80px; height: 80px; background: ${colors[config.type] || colors.info}; border-radius: 50%; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center;">
                            <i class="${icons[config.type] || icons.info}" style="font-size: 32px; color: white;"></i>
                        </div>

                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-weight: 600;">${config.title}</h3>

                        <p style="color: #5a6c7d; margin-bottom: 25px; line-height: 1.6;">
                            ${config.message}
                        </p>
                    </div>
                `,
                showConfirmButton: config.actions && config.actions.length > 0,
                confirmButtonText: config.actions ? config.actions[0].text : 'OK',
                confirmButtonColor: colors[config.type] || colors.info
            });
        }

        // Add some custom CSS for better styling
        const style = document.createElement('style');
        style.textContent = `
            .swal2-no-border {
                border: none !important;
                box-shadow: 0 10px 40px rgba(0,0,0,0.1) !important;
            }

            .swal2-styled-button {
                border-radius: 25px !important;
                padding: 10px 25px !important;
                font-weight: 500 !important;
            }

            .swal2-styled-button-outline {
                border-radius: 25px !important;
                padding: 10px 25px !important;
                font-weight: 500 !important;
                background: transparent !important;
                border: 2px solid #95a5a6 !important;
                color: #95a5a6 !important;
            }

            .swal2-styled-button-outline:hover {
                background: #95a5a6 !important;
                color: white !important;
            }
        `;
        document.head.appendChild(style);

        // Simple error handling function



        const colleges = [
            "A U College Of Engg. Visakhapatnam, Visakhapatnam",
"A U College Of Engg For Women, Visakhapatnam",
"AAR Mahaveer Engineering College, Hyderabad",
"Abhinav Hi-Tech College of Engineering and Technology, Moinabad",
"Abr College Of Engg And Technology, Kanigiri",
"Adarsh College Of Engineering, Gollaprolu",
"Adi Shankara Inst Of Technology, Gudur",
"Adikavi Nannaya University College Of Engineering, Rajahmundry",
"Aditya College Of Engineering, Madanapalle",
"Aditya College Of Engineering, Peddapuram",
"Aditya College Of Engineering And Technology, Peddapuram",
"Aditya Engineering College, Peddapuram",
"Aditya Institute Of Technology And Mgmt, Tekkali",
"Adhisankara College Of Engg. And Technology, Gudur",
"Akrg College Of Engg And Technology, Nallajerla",
"Akula Sreeramulu College Of Engineering, Tanuku",
"Amalapuram Inst Of Mgmt Sci Coll Of Engg, Mummidivaram",
"A.M.Reddy Memorial Coll. Of Engineering, Narasaraopet",
"Amrita Sai Inst. Of Science And Technology, Paritala",
"Anantha Lakshmi Inst Of Technology And Sci, Anantapuramu",
"Andhra Engineering College, Atmakur N",
"Andhra Loyola Instt Of Engg And Technology, Vijayawada",
"Anil Neerukonda Institute Of Technology And Sci, Bheemunipatnam",
"Annamacharya Inst Of Tech And Sci, Kadapa",
"Annamacharya Inst Of Technology And Sciences, Rajampet",
"Annamacharya Inst Of Technology And Sciences-2Nd Shift, Rajampet",
"Annamacharya Inst Of Technology And Sciences, Tirupathi",
"Anurag University, Hyderabad",
"Anu College Of Engg Technology-Self Finance, Guntur",
"ASK College Of Technology Management, Anakapalle",
"ASN Womens Engineering College, Tenali",
"Audisankara College Of Engg And Technology, Nellore",
"Audisankara College Of Engg For Women, Gudur",
"Aurora's Technological and Research Institute, Uppal",
"Avanthi Institute Of Engg. And Technology, Narsipatnam",
"Avanthi Inst. Of Engineering And Technology, Bhogapuram",
"AVN College of Engineering, Ibrahmipatnam",
"Baba Inst Of Tech And Sciences, Visakhapatnam",
"Bandari Srinivas Institute of Technology, Chevella",
"Bapatla Engineering College, Bapatla",
"Bapatla Womens Engg College, Bapatla",
"Benaiah Inst Of Tech And Sciences, Rajahmundry",
"Bharath College Of Engg And Technology For Women, Kadapa",
"Bharath Institute of Science and Technology, Ibrahmipatnam",
"Bhaskar Engineering College, Hyderabad",
"Bheema Inst Of Technology And Sci, Adoni",
"Bhimavaram Inst. Of Engg. And Technology, Bhimavaram",
"Bhoj Reddy Engineering College for Women, Saidabad",
"Bit Institute Of Technology, Hindupur",
"BITS-Pilani, Hyderabad, Shameerpet",
"Bonam Venkata Chalamaiah Inst. Of Tech And Sci., Amalapuram",
"Brahmaiah College Of Engineering, Nellore",
"Brindavan Inst Of Technology And Sci, Kurnool",
"BVRIT Narsapur, Narsapur",
"Bvc Engineering College, Rajahmundry",
"Bvsr Engineering College, Chimakurthy",
"B V Chalamaiah Engineering College, Odalarevu",
"CBIT Hyderabad, Hyderabad",
"Chadalawada Ramanamma Engg. College, Tirupathi",
"Chaitanya Bharathi Institute Of Technology, Pallavolu",
"Chaitanya Engineering College, Visakhapatnam",
"Chaitanya Inst. Of Sci. And Technology, Kakinada",
"Chalapathi Inst Of Engg And Technology, Guntur",
"Chalapathi Inst Of Technology, Guntur",
"Chebrolu Engineering College, Guntur",
"Chintalapudi Engineering College, Guntur",
"Chirala Engineering College, Chirala",
"Chundi Ranganayakulu Engineering College, Chilakaluripet",
"CMR College Of Engineering & Technology, Kandlakoya",
"CMR Engineering college, kandlakoya",
"CMR Institute Of Technology, Kandlakoya",
"CMR Technical Campus, Kandlakoya",
"Coastal Inst Of Technology And Management, Vizianagaram",
"College Of Engineering Br Ambedkar Univ Self Finance, Srikakulam",
"CVR College of Engineering, Hyderabad",
"Dadi Instt. Of Engineering And Technology, Anakapalle",
"D.B.S.Inst Of Technology, Kavali",
"Deccan College of Engineering and Technology, Nampally",
"Dhanekula Inst Of Engg Technology, Vijayawada",
"DMSSVH College Of Engineering, Machilipatnam",
"Dnr College Of Engg And Tech, Bhimavaram",
"Dr L Bullayya College Of Engg For Women, Visakhapatnam",
"Dr Paul Rajs Engineering College, Yetapaka",
"Dr.K.V.Subba Reddy Inst. Of Technology, Kurnool",
"Dr.K.V.Subba Reddycoll Of Engg For Women, Kurnool",
"D Venkataramana And Dr.Himasekhar Mic Coll Of Tech, Kanchikacherla",
"DVR College of Engineering and Technology, Kandi",
"Ellenki College of Engineering and Technology, Patancheru",
"Eluru College Of Engg And Technology, Eluru",
"Eswar College Of Engineering, Narasaraopet",
"G. Narayanamma Institute of Technology and Science, Shaikpet",
"Gandhi Institute of Technology and Management, Rudraram",
"Gates Institute Of Technology, Gooty",
"Geethanjali College Of Engineering And Technology, Hyderabad",
"Geethanjali College Of Engineering And Technology, Kurnool",
"Geethanjali Inst Of Science And Technology, Nellore",
"Giet College Of Engineering, Rajahmundry",
"Giet Engineering College, Rajahmundry",
"Global Coll Of Engg And Technology, Chenur",
"GMR Institute Of Technology, Rajam",
"Godavari Institute Of Engg. And Technology, Rajahmundry",
"Gokraju Ranjaraju Institute of Engineering and Technology, Nizampet",
"Gokul Group Of Institutions, Bobbili",
"Gokula Krishna College Of Engineering, Sullurpet",
"Golden Valley Integrated Campus, Madanapalle",
"Gonna Inst Of Info Technology Sciences, Visakhapatnam",
"Gouthami Inst Of Technology Mgmt For Women, Proddatur",
"GPR Engineering. College, Kurnool",
"GRIET Hyderabad, Hyderabad",
"Gudlavalleru Engineering College, Gudlavalleru",
"Guntur Engineering College, Guntur",
"Guru Nanak Institute of Technology, Ibrahmipatnam",
"Guru Nanak Institutions Technical Campus, Ibrahmipatnam",
"GV VR Institute Of Technology, Bhimavaram",
"Gayathri Vidya Parishad Coll. Of Engineering, Visakhapatnam",
"Gayathri Vidya Parishad Coll Of Engg For Women, Visakhapatnam",
"GVP College For Degree And Pg Courses, Visakhapatnam",
"GVR And S College Of Engg. And Technology, Guntur",
"Helapuri Inst Of Tech And Science, Eluru",
"Hindu College Of Engineering And Technology, Guntur",
"Holy mary institute of technology, Bogaram",
"Hyderabad Institute of Technology and Management, Hyderabad",
"IARE Hyderabad, Hyderabad",
"Ideal Institute Of Technology, Kakinada",
"IIITDM Kurnool",
"IIT Hyderabad",
"IIT Tirupati",
"Indian Institute of Technology Hyderabad",
"Institute of Aeronautical Engineering, Dundigal",
"International Institute of Information Technology, Hyderabad",
"International School Of Tech And Sci For Women, Rajahmundry",
"Islamia College of Engineering and Technology, Bandlaguda",
"Jagans College Of Engg And Technology, Nellore",
"Jagruti Institute of Engineering & Technology, Ibrahmipatnam",
"Jawaharlal Nehru Technological University, Hyderabad",
"JB Institute of Engineering and Technology, Moinabad",
"Joginpally B R Engineering College, Moinabad",
"JNTUHCEH Hyderabad, Hyderabad",
"JNTUH College of Engineering, Karimnagar, Karimnagar",
"JNTUH College of Engineering, Sultanpur, Sultanpur",
"Jntua College Of Engg. Anantapuramu, Anantapuramu",
"Jntua College Of Engineering, Kalikiri",
"Jntua College Of Engg Pulivendula, Pulivendula",
"Jntuk College Of Engg. Kakinada, Kakinada",
"Jntuk College Of Engineering Narasaraopet, Narasaraopet",
"Jntuk College Of Engineering Vizianagaram, Vizianagaram",
"St. Johns College Of Engg. And Technology, Yemmiganur",
"Kakatiya Institute of Technology and Science, Warangal",
"Kakatiya University, Warangal",
"Kakinada Institute Of Engg. And Technology, Kakinada",
"Kakinada Inst Of Engg And Technology For Women, Kakinada",
"Kakinada Institute Of Technology And Science, Divili",
"Kakinada Institute Of Technology Sciences, Ramachandrapuram",
"Kallam Haranadha Reddy Inst Of Tech, Guntur",
"Kandula Obul Reddy Memorial Coll. Of Engg., Kadapa",
"Keshav Memorial Institute of Technology, Narayanguda",
"KG Reddy Engineering College, Moinabad",
"KITSW Warangal, Warangal",
"Kkr And Ksr Inst Of Technology And Sci, Guntur",
"K.Lakshumma Memorial College Of Engg For Women, Kadapa",
"KMIT Hyderabad, Hyderabad",
"Kmm Inst Of Technology And Science, Tirupathi",
"Kommuri pratap reddy institute of technology, Ghanpur",
"Krishna Chaitanya Inst Of Technology And Sciences, Markapur",
"Krishnaveni Engg College For Women, Narasaraopet",
"Krishna University College Of Engg And Technology, Machilipatnam",
"Sri Krishnadeveraya Engineering College, Gooty",
"Sri Krishnadevaraya Univ.Coll. Of Eng.- Self Finance, Anantapuramu",
"KSRM College Of Engineering, Kadapa",
"KU College of Engineering and Technology, Warangal",
"Kuppam Engineering College, Kuppam",
"Lakireddy Balireddy College Of Engineering, Mylavaram",
"Lendi Inst Of Engg And Technology, Vizianagaram",
"Lenora College Of Engineering, Rampachodavaram",
"Lingayas Inst Of Mgmt And Technology, Vijayawada",
"Lords Institute of Engineering and Technology, Rajendra Nagar",
"Loyola Institute Of Technology And Mgmt, Sattenapally",
"Madanapalle Institute Of Technology And Sci-1St Shift, Madanapalle",
"Madanapalle Institute Of Technology And Sci-2Nd Shift, Madanapalle",
"Mahatma Gandhi Institute of Technology, Gandipet",
"Mahaveer Institute of Science and Technology, Bandlaguda",
"Maheshwara College of Engineering, Rangareddy",
"Malineni Lakshmaiah Engineering College, Singarayakonda",
"Malineni Lakshmaiah Womens Engg. College, Guntur",
"Malineni Perumallu Ednl Soc Group Of Instns, Guntur",
"Malla Reddy Engineering College, Maisammaguda",
"Malla Reddy institution of technology and science, Maisammaguda",
"Mandava Institute Of Engg And Technology, Jaggaiahpet",
"Matrusri Engineering College, Saidabad",
"Maturi Venkata Subba Rao Engineering College, Nadargul",
"Megha Institute of Engineering and Technology for Women, Ghatkesar",
"Mekapati Raja Mohan Reddy Inst Of Tech And Sci., Udayagiri",
"Methodist College of Engineering and Technology, Abids",
"MGIT Hyderabad, Hyderabad",
"Miracle Ednl Soc Group Of Instns, Bhogapuram",
"Mjr College Of Engg And Technology, Piler",
"MLR Institute of Technology, Hyderabad",
"MNR College of Engineering and Technology, Kandi",
"Mother Teresa Inst Of Engg And Tech, Palamner",
"Muffakam Jha College of Engineering and Technology, Banjara hills",
"MVGR College Of Engineering, Vizianagaram",
"MVSR Engineering College, Hyderabad",
"M.V.R.Coll Of Engineering And Technology, Paritala",
"Nadimpalli Satyanarayana Raju Institute Of Technology, Visakhapatnam",
"Nalanda Institute Of Engg. And Technology, Sattenapally",
"Nalla Malla Reddy Engineering College, Ghatkesar",
"Nalla Malla Reddy Engineering College, Kachivani Singaram",
"Narasaraopet Institute Of Technology, Narasaraopet",
"Narasaraopeta Engineering College, Narasaraopet",
"Narayana Engineering College, Gudur",
"Narayana Engineering College, Nellore",
"Narayanadri Inst Of Sci Technology, Rajampet",
"National Institute of Technology, Warangal",
"Nawab Shah Alam Khan College of Engineering and Technology, New Malakpet",
"Nbkr Institute Of Sci. And Technology, Vidyanagar",
"Newton Institute Of Engineering, Macherla",
"Nimra College Of Engg And Technology, Jupudi",
"NIT Andhra Pradesh",
"Nri Institute Of Technology, Agiripalli",
"Nri Instt Of Technology, Guntur",
"N.V.R.College Of Engg Technology, Tenali",
"Osmania University, Hyderabad",
"Pace Institute Of Technology And Sciences, Ongole",
"Paladugu Parvathi Devi College Of Engg And Tech, Vijayawada",
"PBR Visvodaya Institute Of Technology And Sci., Kavali",
"P Nagaiah Choudary And Vijay Inst Of Engg And Tech, Guntur",
"Potti Sriramulu College Of Engg And Technology, Vijayawada",
"Pragati Engineering College, Peddapuram",
"Pragati Engineering College-2Nd Shift, Peddapuram",
"Prakasam Engineering College, Kandkur",
"Prasad V Potluri Siddhartha Instt Of Technology, Vijayawada",
"Prasiddha College Of Engg Technology, Anathavaram",
"Princeton College of Engineering and Technology, Ankushapur",
"Princeton Institute of engineering and technology, Ghatkesar",
"Priyadarshini College Of Engineering, Sullurpet",
"Priyadarshini Coll Of Engg. And Technology, Nellore",
"Priyadarshini Inst Of Technology, Nellore",
"Priyadarshini Inst Of Technology, Tirupathi",
"Priyadarshini Inst. Of Technology And Sciences, Tenali",
"G.Pullaiah Coll. Of Engg. And Technology, Kurnool",
"P.V.K.K. Institute Of Technology, Anantapuramu",
"Pydah College Of Engineering, Kakinada",
"Qis College Of Engg. And Technology, Ongole",
"Qis College Of Engg. And Technology-2Nd Shift, Ongole",
"Qis Institute Of Technology, Ongole",
"Raghu Engineering College, Bheemunipatnam",
"Raghu Inst. Of Technology, Bheemunipatnam",
"Rajamahendri Inst Of Engg And Technology, Rajahmundry",
"Rajiv Gandhi Memorial College Of Engg. And Tech., Nandyal",
"Rajiv Gandhi University of Knowledge Technologies, Basar",
"Ramachandra College Of Engineering, Eluru",
"Ramireddy Subba Ramireddy Engg College, Nellore",
"Ravindra College Of Engg For Women, Kurnool",
"Rayalaseema University College Of Engg, Kurnool",
"Rise Krishna Sai Gandhi Group Of Institutions, Ongole",
"Rise Krishna Sai Prakasam Group Of Institutions, Ongole",
"R.K.College Of Engineering, Ibrahimpatnam",
"RVR And J C College Of Engineering, Guntur",
"Sai Ganapathi Engineering College, Visakhapatnam",
"Sai Rajeswari Institute Of Technology, Proddatur",
"Sai Tirumala NVR Engineering College, Narasaraopet",
"Samskruti college of Engineering and Technology, Bogaram",
"Sankethika Inst Of Technology Management, Visakhapatnam",
"Sankethika Vidya Parishad Engineering College, Visakhapatnam",
"Sanskrithi School Of Engineering, Puttaparthi",
"Santhiram Engineering College, Nandyal",
"Sarada Institute Of Sci. Technology And Mgmt, Srikakulam",
"Sasi Institute Of Technology And Engineering, Tadepalligudem",
"Satya Inst Of Technology And Mgmt, Vizianagaram",
"School Of Engg. Tech. Spmvv - Self Finance, Tirupathi",
"School of Engineering Sciences and Technology, UoH, Gachibowli",
"SCIENT Institute of Technology, Ibrahmipatnam",
"Seshachala Inst Of Technology, Puttur",
"Shadan College of Engineering & Technology, Peeram Cheruvu",
"Shadan Women's College of Engineering and Technology, Khairatabad",
"Shree Inst Of Technological Education, Renigunta",
"Shree Rama Ednl Soc Grp Of Instns, Tirupati",
"Shri Shirdi Sai Inst Of Sci And Engg, Anantapuramu",
"Shri Vishnu Engg. College For Women, Bhimavaram",
"Siddharth Institute Of Engg. And Technology, Puttur",
"Siddhartha Institute of Technology and Sciences, Ibrahmipatnam",
"Siddartha Ednl Academy Grp Of Instns, Tirupathi",
"Siddhartha Inst Of Sci And Technology, Puttur",
"Simhadri Ednl Soc Grp Of Instns, Sabbavaram",
"Sir C R R College Of Engineering, Eluru",
"Sir C.V Raman Inst Of Technology Sciences, Tadipatri",
"Sir Vishveshwaraiah Inst Of Science And Technology, Madanapalle",
"SNIST Ghatkesar, Ghatkesar",
"Sphoorthy Engineering College, Vanasthallipuram",
"Sree Rama Engineering College, Tirupathi",
"Sree Vahini Institute Of Science And Technology, Tiruvuru",
"Sree Venkateswara College Of Engg, Nellore",
"Sree Vidyanikethan Engineering College, Rangampeta",
"Sreenidhi institute of science and technology, Ghatkesar",
"Sreyas Institute Of Engineering & Technology, Bandlaguda",
"Sri Annamacharya Institute Of Technology And Science, Rajampet",
"Sri Chaitanya -Djr Coll Of Engg And Tech, Vijayawada",
"Sri Chaitanya Djr Institute Of Engineering And Technology, Vijayawada",
"Sri Datta College of Engineering, Ibrahmipatnam",
"Sri Indu College of Engineering and Technology, Ibrahmipatnam",
"SRKR Engineering College, Bhimavaram",
"SRKR Engineering College-2Nd Shift, Bhimavaram",
"SRK Inst. Of Technology, Vijayawada",
"Sri Mittapalli College Of Engineering, Guntur",
"Sri Mittapalli Inst Of Technology For Women, Guntur",
"Sri Raghavendra Inst Of Technology And Sci., Vinjamur",
"Sri Sai Institute Of Technology. And Sci.., Rayachoti",
"Sri Sarathi Institute Of Engg. And Technology, Nuzvid",
"Sri Satyanarayana Engineering College, Ongole",
"Sri Sivani College Of Engineering, Srikakulam",
"Sri Sunflower College Of Engg And Technology, Lankapalli",
"Sri Vasavi Engineering College, Tadepalligudem",
"Sri Vasavi Instt Of Engineering And Technology., Pedana",
"Sri Venkateswara Coll Of Engineering, Srikakulam",
"Sri Venkateswara Coll Of Engineering, Tirupathi",
"Sri Venkateswara College Of Engg. And Technology., Chittoor",
"Sri Venkateswara College Of Engineering, Kadapa",
"Sri Venkateswara Engg College, Tirupathi",
"Sri Venkateswara Inst Of Technology, Anantapuramu",
"Sri Venkateswara Instt. Of Science And Technology., Kadapa",
"Sri Venkatesa Perumal College Of Engg. And Tech, Puttur",
"Sridevi Women's Engineering College, Vattinagulapally",
"Srinivasa Institute Of Technology And Mang Studies, Chittoor",
"Srinivasa Inst Of Engg And Technology, Cheyyeru",
"Srinivasa Inst Of Technology Science, Kadapa",
"Srinivasa Ramanujan Inst Of Technology, Anantapuramu",
"St. Anns College Of Engg. And Technology, Chirala",
"St. Martins Engineering College, Dhulapally",
"Stanley College of Engineering and Technology for Women, Abids",
"Sumathi Reddy Institute of Technology for Women, Ananthsagar",
"SVU College Of Engg. Tirupathi, Tirupathi",
"Svr Engineering College, Nandyal",
"Swarnandhra Coll. Of Engg And Technology, Narsapuram",
"Swarnandhra Coll. Of Engg And Tech-2Nd Shift, Narsapuram",
"Swarnandhra Inst. Of Engg And Technology, Narsapuram",
"Swetha Institute Of Technology And Science, Tirupathi",
"Tadipatri Engg College, Tadipatri",
"Tammannagari Ramakrishna Reddy College of Engineering, Inole",
"Teegala Krishna Reddy Engineering College, Saroornagar",
"Tirumala Engineering College, Narasaraopet",
"TKR College of Engineering and Technology, Saroornagar",
"Universal College Of Engg And Technology, Guntur",
"University College of Engineering, Osmania University, Hyderabad",
"University of Hyderabad",
"Usha Rama College Of Engg And Technology, Telaprolu",
"Vaagdevi College of Engineering, Bollikunta",
"Vaagdevi Engineering College, Bollikunta",
"Vaagdevi Institute Of Technology. And Sci., Proddatur",
"Vardhaman College of Engineering, Kacharam",
"Vasavi College of Engineering, Hyderabad",
"Vasireddy Venkatadri Inst. Of Technology, Guntur",
"VBIT Ghatkesar, Ghatkesar",
"Velaga Nageswara Rao College Of Engineering, Ponnur",
"Vemu Institute Of Technology, Chittoor",
"Vidya Jyothi Institute of Science and Technology, Moinabad",
"Vignana Bharathi Institute of Technology, Ghatkesar",
"Vignana Bharathi Institute of technology, Korremulla",
"Vignan Institute of management and technology For Women, Ghatkesar",
"Vignans Inst Of Engineering For Women, Visakhapatnam",
"Vignan'S Institute Of Information Technology, Visakhapatnam",
"Vignan'S Nirula Inst Of Tech. And Sci For Women, Guntur",
"Vignans Lara Inst. Of Technology And Sci, Vadlamudi",
"Vijaya Inst. Of Technology For Women, Vijayawada",
"Vikas College Of Engineering And Technology, Vijayawada",
"Vikas Group Of Institutions, Vijayawada Rural",
"Visakha Inst Of Engg And Technology, Visakhapatnam",
"Visakha Technical Campus, Visakhapatnam",
"Vishnu Grp Of Instns - Vishnu Inst Of Technology, Bhimavaram",
"Visvodaya Engineering College, Kavali",
"Viswanadha Institute Of Technology And Mgmt, Visakhapatnam",
"Visvesvaraya College of Engineering and Technology, Ibrahmipatnam",
"VJIT Hyderabad, Hyderabad",
"Vkr Vnb And Agk Engineering College, Gudivada",
"VNR VJIET Hyderabad, Hyderabad",
"V R Siddhartha Engineering College, Vijayawada",
"Vrs And Yrn College Of Engg. And Technology, Chirala",
"V.S.Lakshmi Engg College For Women, Vijayawada",
"V.S.M College Of Engineering, Ramachandrapuram",
"Vizag Institute Of Technology, Bheemunipatnam",
"VNR Vignana Jyothi Institute of Engineering and Technology, Hyderabad",
"Wellfare Inst Of Science Tech And Mgmt, Pinagadi",
"West Godavari Instt Of Science And Engineering, Nallajerla",
"Ygvu Ysr Engineering College, Proddatur",
"Yogananda Inst Of Technology And Science, Tirupathi"
        ];
        function showRegisterModalFromLogin() {
    // Close login modal and show register modal
            const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
            if (loginModal) {
                loginModal.hide();
            }

            setTimeout(() => {
                const registerModal = new bootstrap.Modal(document.getElementById('registerModal'));
                registerModal.show();
            }, 300);
        }


        // In the register form submit handler in index.html

        // Email verification modal function
        function showEmailVerificationModal(email) {
            const isGmail = email && (email.includes('@gmail.com') || email.includes('@googlemail.com'));

            Swal.fire({
                html: `
                    <div style="text-align: center; padding: 20px;">
                        <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-envelope-open" style="font-size: 32px; color: white;"></i>
                        </div>

                        <h3 style="color: #2c3e50; margin-bottom: 15px; font-weight: 600;">Verify Your Email to Start Exploring</h3>

                        <p style="color: #5a6c7d; margin-bottom: 20px; line-height: 1.6;">
                            We sent a link to your inbox — click it to activate your account.
                            🚀 Be part of our student-powered marketplace.
                            🛒 Access 10,000+ items waiting for you.
                        </p>

                        <div style="background: #f8f9fb; padding: 15px; border-radius: 10px; margin: 20px 0;">
                            <p style="color: #667eea; font-weight: 500; margin: 0;">
                                <i class="fas fa-envelope" style="margin-right: 8px;"></i>
                                ${email || 'your email address'}
                            </p>
                        </div>

                        <p style="color: #95a5a6; font-size: 14px; margin-top: 20px;">
                            <i class="fas fa-lightbulb" style="color: #f39c12; margin-right: 5px;"></i>
                            Don't see it? Check your spam folder
                        </p>
                    </div>
                `,
                showConfirmButton: true,
                showCancelButton: false,
                confirmButtonText: isGmail ? '<i class="fas fa-external-link-alt"></i> Open Gmail' : '<i class="fas fa-external-link-alt"></i> Open Email App',
                confirmButtonColor: '#667eea',
                buttonsStyling: true,
                customClass: {
                    popup: 'swal2-no-border',
                    confirmButton: 'swal2-styled-button'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    if (isGmail) {
                        window.open(`https://mail.google.com/mail/u/${email}/#inbox`, '_blank');
                    } else {
                        window.location.href = 'mailto:';
                    }
                }
            });
        }
        // Function to toggle rent/sell fields
        function toggleRentFields() {
            const listingType = document.getElementById('listingType').value;
            const rentFields = document.querySelectorAll('.rent-field');
            const sellPriceField = document.getElementById('sellPriceField');

            if (listingType === 'rent') {
                // Show rent fields, hide sell price field
                rentFields.forEach(field => field.style.display = 'block');
                sellPriceField.style.display = 'none';

                // Make rent fields required, sell price not required
                document.querySelector('input[name="rent_price"]').required = true;
                document.querySelector('input[name="rent_tenure"]').required = true;
                document.querySelector('input[name="price"]').required = false;
            } else {
                // Hide rent fields, show sell price field
                rentFields.forEach(field => field.style.display = 'none');
                sellPriceField.style.display = 'block';

                // Make sell price required, rent fields not required
                document.querySelector('input[name="price"]').required = true;
                document.querySelector('input[name="rent_price"]').required = false;
                document.querySelector('input[name="rent_tenure"]').required = false;
            }
        }
        // Add to your existing JavaScript





        // Utility function for debouncing
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }


        // Image preview handler

        // Category change handler

        function toggleFileUpload() {
            const isSoftCopy = document.getElementById('softCopy').checked;
            document.querySelector('.field-fileupload').style.display = isSoftCopy ? 'block' : 'none';
            if (isSoftCopy) {
                document.querySelector('input[name="document"]').required = true;
            } else {
                document.querySelector('input[name="document"]').required = false;
            }
        }

        // Modify the existing createListingForm submit handler
        // Modify the existing createListingForm submit handler

        function showLoading() {
            document.getElementById('loadingSkeleton').style.display = 'flex';
            document.getElementById('listingsGrid').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('loadingSkeleton').style.display = 'none';
            document.getElementById('listingsGrid').style.display = 'flex';
        }

        // Alert function (if not already defined)
        function showAlert(title, text, icon) {
            Swal.fire({
                title,
                text,
                icon,
                confirmButtonColor: '#2563eb'
            });
        }
        // Chat Management
        // Chat Management
        // Global variables
        // Global variables


        // Function to show alert messages
        function showAlert(title, message, type = 'info') {
            // You can implement your own alert system here
            console.log(`${title}: ${message}`);
        }

        // Message input handler


        // Function to show messages modal

        // Add this to your DOMContentLoaded event listener
        const urlParams = new URLSearchParams(window.location.search);
        const verificationStatus = urlParams.get('verification');

        if (verificationStatus === 'success') {
            showAlert('Email Verified', 'You can now login!', 'success');
            // Clear the query parameter
            window.history.replaceState({}, document.title, window.location.pathname);
        } else if (verificationStatus === 'invalid') {
            showAlert('Invalid Token', 'The verification link is invalid', 'error');
            window.history.replaceState({}, document.title, window.location.pathname);
        }

        // Messaging System

        // Enhanced JavaScript functionality

        // Add this at the start of your JavaScript

        // Email verification handling
        window.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token');
            const action = urlParams.get('action');

            // Handle verification callback
            if (token && action === 'verify') {
                // Call the verification API
                fetch(`/verify-email/${token}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.message) {
                            Swal.fire({
                                title: 'Email Verified!',
                                text: 'Your email has been verified successfully. You can now log in.',
                                icon: 'success',
                                confirmButtonText: 'Login Now'
                            }).then((result) => {
                                if (result.isConfirmed) {
                                    // Open login modal
                                    const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                                    loginModal.show();
                                }
                            });
                        } else {
                            Swal.fire({
                                title: 'Verification Failed',
                                text: data.error || 'There was a problem verifying your email.',
                                icon: 'error'
                            });
                        }
                    })
                    .catch(error => {
                        console.error('Verification error:', error);
                        Swal.fire({
                            title: 'Verification Error',
                            text: 'An unexpected error occurred during verification.',
                            icon: 'error'
                        });
                    });

                // Clear the query parameters
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        });

        // Add this function to check for new messages periodically

        // Add this to your login success handler
        if (response.ok) {
            // ... existing login success code ...
            startMessageChecking(); // Start checking for new messages
        }

        // Add these new functions for editing and deleting listings


        async function deleteListing(listingId) {
            try {
                // Confirm before deleting
                const result = await Swal.fire({
                    title: 'Delete Listing?',
                    text: 'Are you sure you want to delete this listing? This action cannot be undone.',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: 'Yes, delete it!'
                });

                if (result.isConfirmed) {
                    // Show loading state
                    Swal.fire({
                        title: 'Deleting...',
                        text: 'Please wait while we delete your listing.',
                        allowOutsideClick: false,
                        didOpen: () => {
                            Swal.showLoading();
                        }
                    });

                    // Make sure we're sending the correct request with proper headers
                    const response = await fetch(`/api/listings/${listingId}`, {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        credentials: 'same-origin'
                    });

                    if (!response.ok) {
                        const data = await response.json();
                        throw new Error(data.error || 'Failed to delete listing');
                    }

                    // Show success message
                    Swal.fire({
                        title: 'Deleted!',
                        text: 'Your listing has been deleted successfully.',
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    });

                    // Remove the listing element from the DOM
                    const listingElement = document.querySelector(`[data-listing-id="${listingId}"]`);
                    if (listingElement) {
                        listingElement.remove();
                    } else {
                        // If we can't find the element by data attribute, refresh the page
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                    }

                    // Alternatively, refresh the listings
                    if (window.location.pathname === '/my-listings') {
                        setTimeout(() => {
                            if (typeof initializeMyListingsPage === 'function') {
                                initializeMyListingsPage();
                            } else {
                                window.location.reload();
                            }
                        }, 2000);
                    }
                }
            } catch (error) {
                console.error('Error deleting listing:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to delete listing. Please try again.',
                    icon: 'error'
                });
            }
        }

        // Update the wishlist link/button click handler


        // Add this new function to initialize the wishlist page

        // At the bottom of your script, add:
        window.addEventListener('load', function() {
            // If admin modal exists and user is admin, show it
            const adminModalEl = document.getElementById('adminDashboardModal');
            if (adminModalEl && localStorage.getItem('isAdmin') === 'true' && currentUser && currentUser.is_admin) {
                const adminModal = new bootstrap.Modal(adminModalEl);
                adminModal.show();
                loadAdminData();
            } else if (localStorage.getItem('isAdmin') === 'true' && (!currentUser || !currentUser.is_admin)) {
                // If localStorage has admin flag but user isn't admin, clear it
                localStorage.removeItem('isAdmin');
                localStorage.removeItem('adminDashboardOpen');
            }
        });
        // Admin Dashboard Main Functions
        function showAdminDashboard() {
            // Stricter admin check - require both localStorage AND current user to be admin
            // This prevents non-admin users from accessing admin features
            if (!currentUser || !currentUser.is_admin) {
                // Clear any admin status in localStorage to be safe
                localStorage.removeItem('isAdmin');
                localStorage.removeItem('adminDashboardOpen');
                showAlert('Access Denied', 'You must be an admin to access this page', 'error');
                return;
            }

            // Store that admin dashboard is open
            localStorage.setItem('adminDashboardOpen', 'true');

            const adminModal = new bootstrap.Modal(document.getElementById('adminDashboardModal'));
            adminModal.show();
            loadAdminData();

            // Store admin status in localStorage
            localStorage.setItem('isAdmin', 'true');
        }
        // Alert Utility Function


        // User Management
        let currentUserPage = 1;
        const usersPerPage = 10;

        async function adminDeleteUser(userId) {
            try {
                const result = await Swal.fire({
                    title: 'Are you sure?',
                    text: "This will delete the user and all their listings!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: 'Yes, delete it!'
                });

                if (result.isConfirmed) {
                    Swal.fire({
                        title: 'Deleting...',
                        text: 'Please wait while we delete the user and their listings',
                        allowOutsideClick: false,
                        didOpen: () => {
                            Swal.showLoading();
                        }
                    });

                    const response = await fetch(`/admin/delete-user/${userId}`, {
                        method: 'DELETE',
                        credentials: 'same-origin'
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'Failed to delete user');
                    }

                    const data = await response.json();

                    Swal.fire({
                        title: 'Success!',
                        text: data.message || 'User and their listings deleted successfully',
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    });

                    // Reload admin data to refresh the UI
                    setTimeout(() => {
                        loadAdminData();
                    }, 500);
                }
            } catch (error) {
                console.error('Error deleting user:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to delete user',
                    icon: 'error'
                });
            }
        }

        async function adminToggleVerification(userId, isVerified) {
            try {
                const response = await fetch(`/admin/toggle-verification/${userId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to update verification status');

                const data = await response.json();
                showAlert('Success', data.message, 'success');

            } catch (error) {
                showAlert('Error', error.message, 'error');
                // Revert the toggle if there was an error
                document.querySelector(`.toggle-verification[data-user-id="${userId}"]`).checked = !isVerified;
            }
        }

        async function showUserDetails(userId) {
            try {
                const response = await fetch(`/admin/user-details/${userId}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to load user details');

                const user = await response.json();

                // Format the user details HTML
                const userDetailsHtml = `
                    <div class="row">
                        <div class="col-md-4 text-center mb-3">
                            ${user.profile_picture ?
                                `<img src="/static/${user.profile_picture}" class="img-fluid rounded-circle" alt="Profile" style="max-height: 200px;">` :
                                `<i class="fas fa-user-circle fa-5x text-muted"></i>`}
                        </div>
                        <div class="col-md-8">
                            <h4>${user.full_name || 'N/A'}</h4>
                            <p><strong>Email:</strong> ${user.email}</p>
                            <p><strong>College:</strong> ${user.college || 'N/A'}</p>
                            <p><strong>Department:</strong> ${user.department || 'N/A'}</p>
                            <p><strong>Year:</strong> ${user.year || 'N/A'}</p>
                            <p><strong>Registered:</strong> ${new Date(user.created_at).toLocaleString()}</p>
                            <p><strong>Status:</strong>
                                <span class="badge ${user.is_verified ? 'bg-success' : 'bg-warning'}">
                                    ${user.is_verified ? 'Verified' : 'Unverified'}
                                </span>
                            </p>
                            <p><strong>Listings Count:</strong> ${user.listings_count || 0}</p>
                        </div>
                    </div>

                    <div class="mt-4">
                        <h5>User's Listings</h5>
                        <div class="row" id="userListingsContainer">
                            <!-- Listings will be loaded here -->
                        </div>
                    </div>
                `;

                // Set the content and show the modal
                document.getElementById('userDetailsContent').innerHTML = userDetailsHtml;
                const userDetailsModal = new bootstrap.Modal(document.getElementById('userDetailsModal'));
                userDetailsModal.show();

                // Load user's listings
                loadUserListings(userId);

            } catch (error) {
                showAlert('Error', error.message, 'error');
            }
        }

        async function loadUserListings(userId) {
            try {
                const response = await fetch(`/admin/user-listings/${userId}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to load user listings');

                const listings = await response.json();
                const container = document.getElementById('userListingsContainer');

                if (listings.length === 0) {
                    container.innerHTML = '<div class="col-12 text-muted">No listings found</div>';
                    return;
                }

                container.innerHTML = listings.map(listing => `
                    <div class="col-md-4 mb-3">
                        <div class="card h-100">
                            <img src="/static/${listing.image_url}" class="card-img-top" alt="${listing.title}" style="height: 150px; object-fit: cover;">
                            <div class="card-body">
                                <h6 class="card-title">${listing.title}</h6>
                                <p class="card-text">?${listing.price}</p>
                                <button class="btn btn-sm btn-primary" onclick="showListingDetails(${listing.id})">
                                    View Details
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');

            } catch (error) {
                console.error('Error loading user listings:', error);
            }
        }

        async function loadAdminUsers(page = 1, search = '', filter = '') {
            try {
                const response = await fetch(`/admin/dashboard?page=${page}&search=${search}&filter=${filter}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to load users');

                const data = await response.json();
                const usersTable = document.getElementById('usersTableBody');
                usersTable.innerHTML = data.users.map(user => `
                    <tr>
                        <td>
                            <input type="checkbox" class="form-check-input user-checkbox" value="${user.id}">
                        </td>
                        <td>${user.id}</td>
                        <td>
                            <a href="#" onclick="showUserDetails(${user.id})">${user.full_name || 'N/A'}</a>
                        </td>
                        <td>${user.email}</td>
                        <td>${user.college || 'N/A'}</td>
                        <td>
                            <div class="form-check form-switch">
                                <input class="form-check-input toggle-verification" type="checkbox"
                                    data-user-id="${user.id}" ${user.is_verified ? 'checked' : ''}>
                            </div>
                        </td>
                        <td>${user.listings_count}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="adminDeleteUser(${user.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');

                // Update pagination info
                const totalUsers = data.stats.total_users;
                const start = (page - 1) * usersPerPage + 1;
                const end = Math.min(page * usersPerPage, totalUsers);

                document.getElementById('userStart').textContent = start;
                document.getElementById('userEnd').textContent = end;
                document.getElementById('userTotal').textContent = totalUsers;

                // Update pagination buttons
                document.getElementById('userPrevPage').disabled = page <= 1;
                document.getElementById('userNextPage').disabled = end >= totalUsers;

                currentUserPage = page;

                // Add event listeners for verification toggles
                document.querySelectorAll('.toggle-verification').forEach(toggle => {
                    toggle.addEventListener('change', function() {
                        adminToggleVerification(this.dataset.userId, this.checked);
                    });
                });

            } catch (error) {
                showAlert('Error', error.message, 'error');
            }
        }

        // Listing Management
        let currentListingPage = 1;
        const listingsPerPage = 10;

        async function adminDeleteListing(listingId) {
            try {
                const result = await Swal.fire({
                    title: 'Are you sure?',
                    text: "This will permanently delete the listing!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: 'Yes, delete it!'
                });

                if (result.isConfirmed) {
                    Swal.fire({
                        title: 'Deleting...',
                        text: 'Please wait while we delete the listing',
                        allowOutsideClick: false,
                        didOpen: () => {
                            Swal.showLoading();
                        }
                    });

                    const response = await fetch(`/admin/delete-listing/${listingId}`, {
                        method: 'DELETE',
                        credentials: 'same-origin'
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'Failed to delete listing');
                    }

                    const data = await response.json();

                    Swal.fire({
                        title: 'Success!',
                        text: data.message || 'Listing deleted successfully',
                        icon: 'success',
                        timer: 2000,
                        showConfirmButton: false
                    });

                    // Reload admin data to refresh the UI
                    setTimeout(() => {
                        loadAdminData();
                    }, 500);
                }
            } catch (error) {
                console.error('Error deleting listing:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to delete listing',
                    icon: 'error'
                });
            }
        }

        async function adminToggleFakeWarning(listingId, isFakeWarning) {
            try {
                const response = await fetch(`/admin/toggle-fake-warning/${listingId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to update fake warning status');

                const data = await response.json();
                showAlert('Success', data.message, 'success');

            } catch (error) {
                showAlert('Error', error.message, 'error');
                // Revert the toggle if there was an error
                document.querySelector(`.toggle-fake-warning[data-listing-id="${listingId}"]`).checked = !isFakeWarning;
            }
        }

        async function showListingDetails(listingId) {
            try {
                const response = await fetch(`/admin/listing-details/${listingId}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to load listing details');

                const listing = await response.json();

                // Format the listing details HTML
                const listingDetailsHtml = `
                    <div class="row">
                        <div class="col-md-5">
                            <img src="/static/${listing.image_url}" class="img-fluid rounded" alt="${listing.title}">
                        </div>
                        <div class="col-md-7">
                            <h3>${listing.title}</h3>
                            <p class="text-muted">Posted by: ${listing.seller.full_name} (ID: ${listing.seller_id})</p>
                            <p><strong>Price:</strong> ?${listing.price}</p>
                            ${listing.rent_price ? `<p><strong>Rent Price:</strong> ?${listing.rent_price}</p>` : ''}
                            <p><strong>Category:</strong> ${listing.category}</p>
                            <p><strong>Condition:</strong> ${listing.condition}</p>
                            <p><strong>Posted:</strong> ${new Date(listing.created_at).toLocaleString()}</p>
                            <p><strong>Status:</strong>
                                <span class="badge ${listing.is_fake_warning ? 'bg-danger' : 'bg-success'}">
                                    ${listing.is_fake_warning ? 'Marked as suspicious' : 'Verified'}
                                </span>
                            </p>
                        </div>
                    </div>

                    <div class="mt-4">
                        <h5>Description</h5>
                        <p>${listing.description}</p>

                        ${listing.product_type ? `<p><strong>Product Type:</strong> ${listing.product_type}</p>` : ''}
                        ${listing.branch ? `<p><strong>Branch:</strong> ${listing.branch}</p>` : ''}
                        ${listing.study_year ? `<p><strong>Study Year:</strong> ${listing.study_year}</p>` : ''}
                        ${listing.working_condition ? `<p><strong>Working Condition:</strong> ${listing.working_condition}</p>` : ''}
                        ${listing.warranty_status ? `<p><strong>Warranty Status:</strong> ${listing.warranty_status}</p>` : ''}
                        ${listing.subject ? `<p><strong>Subject:</strong> ${listing.subject}</p>` : ''}
                    </div>
                `;

                // Set the content and show the modal
                document.getElementById('listingDetailsContent').innerHTML = listingDetailsHtml;
                const listingDetailsModal = new bootstrap.Modal(document.getElementById('listingDetailsModal'));
                listingDetailsModal.show();

            } catch (error) {
                showAlert('Error', error.message, 'error');
            }
        }

        async function loadAdminListings(page = 1, search = '', filter = '') {
            try {
                const response = await fetch(`/admin/dashboard?page=${page}&search=${search}&filter=${filter}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to load listings');

                const data = await response.json();
                const listingsTable = document.getElementById('listingsTableBody');

                if (!data.listings || data.listings.length === 0) {
                    listingsTable.innerHTML = `
                        <tr>
                            <td colspan="8" class="text-center py-3">No listings found</td>
                        </tr>
                    `;
                    return;
                }

                listingsTable.innerHTML = data.listings.map(listing => `
                    <tr>
                        <td>
                            <input type="checkbox" class="form-check-input listing-checkbox" value="${listing.id}">
                        </td>
                        <td>${listing.id}</td>
                        <td>
                            <a href="#" onclick="showListingDetails(${listing.id})">${listing.title}</a>
                        </td>
                        <td>?${listing.price}</td>
                        <td>${listing.category}</td>
                        <td>${listing.seller_name}</td>
                        <td>
                            <span class="badge ${listing.is_fake_warning ? 'bg-danger' : 'bg-success'}">
                                ${listing.is_fake_warning ? 'Flagged' : 'Clean'}
                            </span>
                        </td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-primary" onclick="showListingDetails(${listing.id})"
                                    title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-warning" onclick="adminToggleFakeWarning(${listing.id}, ${!listing.is_fake_warning})"
                                    title="${listing.is_fake_warning ? 'Remove Flag' : 'Flag as Fake'}">
                                    <i class="fas fa-flag"></i>
                                </button>
                                <button class="btn btn-outline-danger" onclick="adminDeleteListing(${listing.id})"
                                    title="Delete Listing">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `).join('');

                // Update pagination info
                const totalListings = data.stats.total_listings;
                const start = (page - 1) * listingsPerPage + 1;
                const end = Math.min(page * listingsPerPage, totalListings);

                document.getElementById('listingStart').textContent = start;
                document.getElementById('listingEnd').textContent = end;
                document.getElementById('listingTotal').textContent = totalListings;

                // Update pagination buttons
                document.getElementById('listingPrevPage').disabled = page <= 1;
                document.getElementById('listingNextPage').disabled = end >= totalListings;

                currentListingPage = page;

            } catch (error) {
                console.error('Error loading listings:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to load listings',
                    icon: 'error'
                });
            }
        }

        // Toggle fake warning flag on a listing
        async function adminToggleFakeWarning(listingId, setFlagged) {
            try {
                Swal.fire({
                    title: 'Updating...',
                    text: `${setFlagged ? 'Flagging' : 'Unflagging'} listing`,
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                const response = await fetch(`/admin/toggle-fake-warning/${listingId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    credentials: 'same-origin'
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to update fake warning status');
                }

                const data = await response.json();

                Swal.fire({
                    title: 'Success!',
                    text: data.message || 'Listing status updated successfully',
                    icon: 'success',
                    timer: 2000,
                    showConfirmButton: false
                });

                // Refresh listings
                loadAdminListings(currentListingPage);

            } catch (error) {
                Swal.fire({
                    title: 'Error',
                    text: error.message,
                    icon: 'error'
                });
            }
        }

        // Charts and Statistics
        function initCharts() {
            // Load Chart.js from CDN if not already loaded
            if (typeof Chart === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/chart.js';
                script.onload = renderCharts;
                document.head.appendChild(script);
            } else {
                renderCharts();
            }
        }

        function renderCharts() {
            fetch('/admin/stats', {
                credentials: 'same-origin'
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to load chart data');
                }
                return response.json();
            })
            .then(data => {
                try {
                    // User Growth Chart
                    const userGrowthCtx = document.getElementById('userGrowthChart');
                    if (userGrowthCtx && data.user_growth && data.user_growth.length > 0) {
                        new Chart(userGrowthCtx.getContext('2d'), {
                            type: 'line',
                            data: {
                                labels: data.user_growth.map(item => item.date),
                                datasets: [{
                                    label: 'New Users',
                                    data: data.user_growth.map(item => item.count),
                                    backgroundColor: 'rgba(37, 99, 235, 0.2)',
                                    borderColor: 'rgba(37, 99, 235, 1)',
                                    borderWidth: 2,
                                    tension: 0.3,
                                    fill: true
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        ticks: {
                                            precision: 0
                                        }
                                    }
                                }
                            }
                        });
                    }

                    // Listing Growth Chart
                    const listingGrowthCtx = document.getElementById('listingGrowthChart');
                    if (listingGrowthCtx && data.listing_growth && data.listing_growth.length > 0) {
                        new Chart(listingGrowthCtx.getContext('2d'), {
                            type: 'line',
                            data: {
                                labels: data.listing_growth.map(item => item.date),
                                datasets: [{
                                    label: 'New Listings',
                                    data: data.listing_growth.map(item => item.count),
                                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                    borderColor: 'rgba(16, 185, 129, 1)',
                                    borderWidth: 2,
                                    tension: 0.3,
                                    fill: true
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        ticks: {
                                            precision: 0
                                        }
                                    }
                                }
                            }
                        });
                    }

                    // Category Distribution Chart
                    const categoryCtx = document.getElementById('categoryChart');
                    if (categoryCtx && data.category_distribution && data.category_distribution.length > 0) {
                        const categories = data.category_distribution.map(item => item.category);
                        const counts = data.category_distribution.map(item => item.count);

                        new Chart(categoryCtx.getContext('2d'), {
                            type: 'doughnut',
                            data: {
                                labels: categories,
                                datasets: [{
                                    data: counts,
                                    backgroundColor: [
                                        'rgba(37, 99, 235, 0.7)',
                                        'rgba(16, 185, 129, 0.7)',
                                        'rgba(245, 158, 11, 0.7)',
                                        'rgba(239, 68, 68, 0.7)',
                                        'rgba(139, 92, 246, 0.7)',
                                        'rgba(236, 72, 153, 0.7)'
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        position: 'right'
                                    }
                                }
                            }
                        });
                    }

                    // College Distribution Chart is skipped as the data is not available yet
                } catch (error) {
                    console.error('Error rendering charts:', error);
                }
            })
            .catch(error => {
                console.error('Error loading stats:', error);
            });
        }

        // Main Data Loader
        async function loadAdminData() {
            try {
                // Load stats first
                const statsResponse = await fetch('/admin/dashboard', {
                    credentials: 'same-origin'
                });
                await loadSalesStats();
                
                await loadColleges()

                if (!statsResponse.ok) {
                    const errorData = await statsResponse.json();
                    throw new Error(errorData.error || 'Failed to load admin data');
                }

                const data = await statsResponse.json();

                // Update stats
                if (data && data.stats) {
                    document.getElementById('totalUsers').textContent = data.stats.total_users || 0;
                    document.getElementById('verifiedUsers').textContent = data.stats.verified_users || 0;
                    document.getElementById('unverifiedUsers').textContent =
                        (data.stats.total_users || 0) - (data.stats.verified_users || 0);
                    document.getElementById('totalListings').textContent = data.stats.total_listings || 0;
                    document.getElementById('fakeWarnings').textContent = data.stats.fake_warnings || 0;

                    // Update reports badge
                    if (data.stats.pending_reports) {
                        document.getElementById('reportsBadge').textContent = data.stats.pending_reports;
                        document.getElementById('reportsBadge').style.display = 'inline-block';
                    } else {
                        document.getElementById('reportsBadge').style.display = 'none';
                    }
                }

                // Initialize charts
                try {
                    initCharts();
                } catch (chartError) {
                    console.error('Error initializing charts:', chartError);
                }

                // Load users if available
                if (data && data.users) {
                    // Populate users table
                    const usersTable = document.getElementById('usersTableBody');
                    usersTable.innerHTML = data.users.map(user => `
                        <tr>
                            <td>
                                <input type="checkbox" class="form-check-input user-checkbox" value="${user.id}">
                            </td>
                            <td>${user.id}</td>
                            <td>
                                <a href="#" onclick="showUserDetails(${user.id})">${user.full_name || 'N/A'}</a>
                            </td>
                            <td>${user.email}</td>
                            <td>${user.college || 'N/A'}</td>
                            <td>
                                <div class="form-check form-switch">
                                    <input class="form-check-input toggle-verification" type="checkbox"
                                        data-user-id="${user.id}" ${user.is_verified ? 'checked' : ''}>
                                </div>
                            </td>
                            <td>${user.listings_count || 0}</td>
                            <td>
                                <button class="btn btn-sm btn-danger" onclick="adminDeleteUser(${user.id})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                    `).join('');

                    // Add event listeners for verification toggles
                    document.querySelectorAll('.toggle-verification').forEach(toggle => {
                        toggle.addEventListener('change', function() {
                            adminToggleVerification(this.dataset.userId, this.checked);
                        });
                    });
                } else {
                    // If data doesn't include users, load them separately
                    loadAdminUsers();
                }

                // Load listings if available
                if (data && data.listings) {
                    // Populate listings table
                    const listingsTable = document.getElementById('listingsTableBody');
                    listingsTable.innerHTML = data.listings.map(listing => `
                        <tr>
                            <td>
                                <input type="checkbox" class="form-check-input listing-checkbox" value="${listing.id}">
                            </td>
                            <td>${listing.id}</td>
                            <td>
                                <a href="#" onclick="showListingDetails(${listing.id})">${listing.title}</a>
                            </td>
                            <td>?${listing.price}</td>
                            <td>${listing.category}</td>
                            <td>${listing.seller_name}</td>
                            <td>
                                <span class="badge ${listing.is_fake_warning ? 'bg-danger' : 'bg-success'}">
                                    ${listing.is_fake_warning ? 'Flagged' : 'Clean'}
                                </span>
                            </td>
                            <td>
                                <div class="btn-group btn-group-sm">
                                    <button class="btn btn-outline-primary" onclick="showListingDetails(${listing.id})"
                                        title="View Details">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-outline-warning" onclick="adminToggleFakeWarning(${listing.id}, ${!listing.is_fake_warning})"
                                        title="${listing.is_fake_warning ? 'Remove Flag' : 'Flag as Fake'}">
                                        <i class="fas fa-flag"></i>
                                    </button>
                                    <button class="btn btn-outline-danger" onclick="adminDeleteListing(${listing.id})"
                                        title="Delete Listing">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `).join('');
                } else {
                    // If data doesn't include listings, load them separately
                    loadAdminListings();
                }

                // Load reports if available
                if (data && data.reports) {
                    populateReportsTable(data.reports);
                }

            } catch (error) {
                console.error('Error loading admin data:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to load admin dashboard data',
                    icon: 'error'
                });
            }
        }

        // Search and Filter Functions
        function searchUsers() {
            const searchTerm = document.getElementById('userSearchInput').value;
            const filterValue = document.getElementById('userFilterSelect').value;
            loadAdminUsers(1, searchTerm, filterValue);
        }

        function searchListings() {
            const searchTerm = document.getElementById('listingSearchInput').value;
            const filterValue = document.getElementById('listingFilterSelect').value;
            loadAdminListings(1, searchTerm, filterValue);
        }

        // Pagination Handlers
        function userPrevPage() {
            if (currentUserPage > 1) {
                const searchTerm = document.getElementById('userSearchInput').value;
                const filterValue = document.getElementById('userFilterSelect').value;
                loadAdminUsers(currentUserPage - 1, searchTerm, filterValue);
            }
        }

        function userNextPage() {
            const searchTerm = document.getElementById('userSearchInput').value;
            const filterValue = document.getElementById('userFilterSelect').value;
            loadAdminUsers(currentUserPage + 1, searchTerm, filterValue);
        }

        function listingPrevPage() {
            if (currentListingPage > 1) {
                const searchTerm = document.getElementById('listingSearchInput').value;
                const filterValue = document.getElementById('listingFilterSelect').value;
                loadAdminListings(currentListingPage - 1, searchTerm, filterValue);
            }
        }

        function listingNextPage() {
            const searchTerm = document.getElementById('listingSearchInput').value;
            const filterValue = document.getElementById('listingFilterSelect').value;
            loadAdminListings(currentListingPage + 1, searchTerm, filterValue);
        }

        // Bulk Actions
        function bulkDeleteUsers() {
            const selectedUsers = Array.from(document.querySelectorAll('.user-checkbox:checked')).map(cb => cb.value);

            if (selectedUsers.length === 0) {
                showAlert('Warning', 'No users selected', 'warning');
                return;
            }

            Swal.fire({
                title: 'Are you sure?',
                text: `You are about to delete ${selectedUsers.length} users and their listings! This cannot be undone.`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Yes, delete them!'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        title: 'Deleting...',
                        text: 'Please wait while we delete the users',
                        allowOutsideClick: false,
                        didOpen: () => {
                            Swal.showLoading();
                        }
                    });

                    let completedRequests = 0;
                    let failedRequests = 0;

                    selectedUsers.forEach(userId => {
                        fetch(`/admin/delete-user/${userId}`, {
                            method: 'DELETE',
                            credentials: 'same-origin'
                        })
                        .then(response => {
                            if (response.ok) {
                                completedRequests++;
                            } else {
                                failedRequests++;
                            }

                            // Check if all requests are done
                            if (completedRequests + failedRequests === selectedUsers.length) {
                                if (failedRequests === 0) {
                                    Swal.fire({
                                        title: 'Success!',
                                        text: `${completedRequests} users deleted successfully`,
                                        icon: 'success',
                                        timer: 2000,
                                        showConfirmButton: false
                                    });
                                } else {
                                    Swal.fire({
                                        title: 'Partial Success',
                                        text: `${completedRequests} users deleted successfully, ${failedRequests} failed`,
                                        icon: 'warning'
                                    });
                                }

                                // Reload the admin data
                                loadAdminData();
                            }
                        })
                        .catch(error => {
                            failedRequests++;

                            // Check if all requests are done
                            if (completedRequests + failedRequests === selectedUsers.length) {
                                Swal.fire({
                                    title: 'Error',
                                    text: 'Some or all user deletions failed',
                                    icon: 'error'
                                });

                                // Reload the admin data
                                loadAdminData();
                            }
                        });
                    });
                }
            });
        }

        function bulkDeleteListings() {
            const selectedListings = Array.from(document.querySelectorAll('.listing-checkbox:checked')).map(cb => cb.value);

            if (selectedListings.length === 0) {
                showAlert('Warning', 'No listings selected', 'warning');
                return;
            }

            Swal.fire({
                title: 'Are you sure?',
                text: `You are about to delete ${selectedListings.length} listings! This cannot be undone.`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Yes, delete them!'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire({
                        title: 'Deleting...',
                        text: 'Please wait while we delete the listings',
                        allowOutsideClick: false,
                        didOpen: () => {
                            Swal.showLoading();
                        }
                    });

                    let completedRequests = 0;
                    let failedRequests = 0;

                    selectedListings.forEach(listingId => {
                        fetch(`/admin/delete-listing/${listingId}`, {
                            method: 'DELETE',
                            credentials: 'same-origin'
                        })
                        .then(response => {
                            if (response.ok) {
                                completedRequests++;
                            } else {
                                failedRequests++;
                            }

                            // Check if all requests are done
                            if (completedRequests + failedRequests === selectedListings.length) {
                                if (failedRequests === 0) {
                                    Swal.fire({
                                        title: 'Success!',
                                        text: `${completedRequests} listings deleted successfully`,
                                        icon: 'success',
                                        timer: 2000,
                                        showConfirmButton: false
                                    });
                                } else {
                                    Swal.fire({
                                        title: 'Partial Success',
                                        text: `${completedRequests} listings deleted successfully, ${failedRequests} failed`,
                                        icon: 'warning'
                                    });
                                }

                                // Reload the admin data
                                loadAdminData();
                            }
                        })
                        .catch(error => {
                            failedRequests++;

                            // Check if all requests are done
                            if (completedRequests + failedRequests === selectedListings.length) {
                                Swal.fire({
                                    title: 'Error',
                                    text: 'Some or all listing deletions failed',
                                    icon: 'error'
                                });

                                // Reload the admin data
                                loadAdminData();
                            }
                        });
                    });
                }
            });
        }

        // Export Functions
        function exportUsers() {
            window.location.href = '/admin/export/users';
        }

        function exportListings() {
            window.location.href = '/admin/export/listings';
        }

        // Initialize everything on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadAdminData();

            // Add event listeners
            document.getElementById('userSearchBtn').addEventListener('click', searchUsers);
            document.getElementById('listingSearchBtn').addEventListener('click', searchListings);
            document.getElementById('userPrevPage').addEventListener('click', userPrevPage);
            document.getElementById('userNextPage').addEventListener('click', userNextPage);
            document.getElementById('listingPrevPage').addEventListener('click', listingPrevPage);
            document.getElementById('listingNextPage').addEventListener('click', listingNextPage);
            document.getElementById('bulkDeleteUsersBtn').addEventListener('click', bulkDeleteUsers);
            document.getElementById('bulkDeleteListingsBtn').addEventListener('click', bulkDeleteListings);
            document.getElementById('exportUsersBtn').addEventListener('click', exportUsers);
            document.getElementById('exportListingsBtn').addEventListener('click', exportListings);
            if (localStorage.getItem('isAdmin') === 'true') {
                showAdminDashboard();
            }

            // Initialize tooltips and popovers
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });

            const popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
            popoverTriggerList.map(function (popoverTriggerEl) {
                return new bootstrap.Popover(popoverTriggerEl);
            });
        });
        // Admin Functions


// Utility function for alerts

// Other admin functions (delete, toggle, etc.) remain the same as previous implementation

        // Initialize Admin Dashboard
        async function initAdminDashboard() {
            if (!currentUser || !currentUser.is_admin) {
                console.error('Unauthorized access to admin dashboard');
                return;
            }

            try {
                showLoading();
                const response = await fetch('/admin/dashboard', {
                    credentials: 'same-origin'
                });

                if (!response.ok) throw new Error('Failed to load admin dashboard data');

                const data = await response.json();

                // Update dashboard stats
                document.getElementById('totalUsers').textContent = data.stats.total_users;
                document.getElementById('verifiedUsers').textContent = data.stats.verified_users;
                document.getElementById('unverifiedUsers').textContent = data.stats.total_users - data.stats.verified_users;
                document.getElementById('totalListings').textContent = data.stats.total_listings;
                document.getElementById('fakeWarnings').textContent = data.stats.fake_warnings;
                document.getElementById('reportsBadge').textContent = data.stats.pending_reports;
                document.getElementById('pendingReports').textContent = data.stats.pending_reports;

                // Populate reports table
                populateReportsTable(data.reports);

            } catch (error) {
                console.error('Error initializing admin dashboard:', error);
                showAlert('Error', error.message, 'error');
            } finally {
                hideLoading();
            }
        }

        // Populate Reports Table
        function populateReportsTable(reports) {
            const tableBody = document.getElementById('reportsTableBody');
            if (!tableBody) {
                console.error('Reports table body element not found!');
                return;
            }

            tableBody.innerHTML = '';

            if (!reports || reports.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center py-3">No reports found</td>
                    </tr>
                `;
                return;
            }

            console.log('Populating reports table with:', reports);

            reports.forEach(report => {
                const row = document.createElement('tr');

                // Create status badge with appropriate color
                let statusBadge = '';
                if (report.status === 'pending') {
                    statusBadge = '<span class="badge bg-warning">Pending</span>';
                } else if (report.status === 'reviewed') {
                    statusBadge = '<span class="badge bg-primary">Reviewed</span>';
                } else if (report.status === 'resolved') {
                    statusBadge = '<span class="badge bg-success">Resolved</span>';
                }

                // Format date
                let formattedDate = 'N/A';
                if (report.created_at) {
                    const reportDate = new Date(report.created_at);
                    formattedDate = reportDate.toLocaleDateString() + ' ' +
                                    reportDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                }

                // Description truncation
                const shortDescription = report.description ?
                    (report.description.length > 50 ? report.description.substring(0, 47) + '...' : report.description) :
                    'No description';

                row.innerHTML = `
                    <td>${report.id}</td>
                    <td>${report.listing_title || 'User Report'}</td>
                    <td>${report.reporter_name || 'Unknown'}</td>
                    <td>${shortDescription}</td>
                    <td>${statusBadge}</td>
                    <td>${formattedDate}</td>
                    <td>
                        <button class="btn btn-sm btn-primary view-report-btn" data-report-id="${report.id}">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;

                tableBody.appendChild(row);
            });

            // Add event listeners to the view buttons
            document.querySelectorAll('.view-report-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-report-id');
                    if (reportId) {
                        viewReportDetails(reportId);
                    }
                });
            });
        }

        // View Report Details
        async function viewReportDetails(reportId) {
            try {
                Swal.fire({
                    title: 'Loading...',
                    text: 'Fetching report details',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });

                const response = await fetch(`/admin/reports/${reportId}`, {
                    credentials: 'same-origin'
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to load report details');
                }

                const report = await response.json();
                Swal.close();

                // Format date
                const reportDate = new Date(report.created_at);
                const formattedDate = reportDate.toLocaleDateString() + ' ' +
                                    reportDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

                // Create status badge with appropriate color
                let statusBadge = '';
                if (report.status === 'pending') {
                    statusBadge = '<span class="badge bg-warning">Pending</span>';
                } else if (report.status === 'reviewed') {
                    statusBadge = '<span class="badge bg-primary">Reviewed</span>';
                } else if (report.status === 'resolved') {
                    statusBadge = '<span class="badge bg-success">Resolved</span>';
                }

                // Populate modal content
                const modalContent = document.getElementById('reportDetailsContent');
                modalContent.innerHTML = `
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Report Information</h6>
                            <ul class="list-group mb-3">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Status
                                    ${statusBadge}
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Reported On
                                    <span>${formattedDate}</span>
                                </li>
                                <li class="list-group-item">
                                    <strong>Description:</strong>
                                    <p class="mt-2">${report.description}</p>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>Reporter Information</h6>
                            <ul class="list-group mb-3">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Name
                                    <span>${report.reporter.name || 'N/A'}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Email
                                    <span>${report.reporter.email || 'N/A'}</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    College
                                    <span>${report.reporter.college || 'N/A'}</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-12">
                            <h6>Reported Person Information</h6>
                            <ul class="list-group mb-3">
                                ${report.listing ? `
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Name
                                        <span>${report.listing.seller.name}</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Email
                                        <span>${report.listing.seller.email}</span>
                                    </li>
                                    <li class="list-group-item">
                                        <strong>Related Listing:</strong>
                                        <p class="mt-2">${report.listing.title}</p>
                                    </li>
                                ` : report.message_thread ? `
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Sender
                                        <span>${report.message_thread.sender.name}</span>
                                    </li>
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Receiver
                                        <span>${report.message_thread.receiver.name}</span>
                                    </li>
                                    <li class="list-group-item">
                                        <strong>Message Content:</strong>
                                        <p class="mt-2">${report.message_thread.content}</p>
                                    </li>
                                ` : `
                                    <li class="list-group-item">
                                        <div class="alert alert-warning mb-0">
                                            No specific person information available
                                        </div>
                                    </li>
                                `}
                            </ul>
                        </div>
                    </div>

                    ${report.image_url ? `
                    <div class="row mt-3">
                        <div class="col-12">
                            <h6>Evidence Image</h6>
                            <img src="/static/${report.image_url}" class="img-fluid rounded" style="max-height: 300px;" alt="Report Evidence">
                        </div>
                    </div>
                    ` : ''}
                `;

                // Store the current report ID for action buttons
                document.getElementById('resolveReportBtn').setAttribute('data-report-id', report.id);
                document.getElementById('reviewReportBtn').setAttribute('data-report-id', report.id);

                // Show the modal
                const reportModal = new bootstrap.Modal(document.getElementById('reportDetailsModal'));
                reportModal.show();

            } catch (error) {
                console.error('Error viewing report details:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to load report details',
                    icon: 'error'
                });
            }
        }

        // Function to update admin dashboard stats
        async function updateAdminDashboardStats() {
            try {
                const response = await fetch('/admin/dashboard', {
                    credentials: 'same-origin'
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch dashboard data');
                }

                const data = await response.json();

                // Update stats
                document.getElementById('totalUsers').textContent = data.stats.total_users;
                document.getElementById('verifiedUsers').textContent = data.stats.verified_users;
                document.getElementById('totalListings').textContent = data.stats.total_listings;
                document.getElementById('fakeWarnings').textContent = data.stats.fake_warnings;
                document.getElementById('pendingReports').textContent = data.stats.pending_reports;

                // Update last 30 days stats
                document.getElementById('newUsers30Days').textContent = `Last 30 days: ${data.stats.new_users_30_days || 0}`;
                document.getElementById('unverifiedCount').textContent = `Unverified: ${data.stats.total_users - data.stats.verified_users}`;
                document.getElementById('newListings30Days').textContent = `Last 30 days: ${data.stats.new_listings_30_days || 0}`;
                document.getElementById('pendingWarnings').textContent = `Pending: ${data.stats.pending_warnings || 0}`;

            } catch (error) {
                console.error('Error updating dashboard stats:', error);
                Swal.fire({
                    title: 'Error',
                    text: 'Failed to update dashboard statistics',
                    icon: 'error'
                });
            }
        }

        // Call updateAdminDashboardStats when the dashboard is shown
        document.getElementById('dashboard-tab').addEventListener('shown.bs.tab', function (e) {
            updateAdminDashboardStats();
        });

        // Initial update when page loads if we're on the dashboard tab
        if (document.getElementById('dashboard-tab').classList.contains('active')) {
            updateAdminDashboardStats();
        }

        // Report filter
        document.getElementById('reportFilter').addEventListener('change', function() {
            const filterValue = this.value;
            const reportRows = document.querySelectorAll('#reportsTableBody tr');

            reportRows.forEach(row => {
                const statusCell = row.querySelector('td:nth-child(5)');
                if (!statusCell) return;

                const statusText = statusCell.textContent.toLowerCase();

                if (filterValue === '' || statusText.includes(filterValue)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        // Add a function to open the reports tab directly
        function openAdminReportsTab() {
            // First open the admin dashboard
            showAdminDashboard();

            // Then click on the reports tab
            setTimeout(() => {
                document.getElementById('reports-tab').click();
            }, 500);
        }

        // Modify showAdminDashboard to accept a tab parameter
        function showAdminDashboard(tabToShow = null) {
            // Stricter admin check - require both localStorage AND current user to be admin
            // This prevents non-admin users from accessing admin features
            if (!currentUser || !currentUser.is_admin) {
                // Clear any admin status in localStorage to be safe
                localStorage.removeItem('isAdmin');
                localStorage.removeItem('adminDashboardOpen');
                showAlert('Access Denied', 'You must be an admin to access this page', 'error');
                return;
            }

            // Mark dashboard as open in localStorage
            localStorage.setItem('adminDashboardOpen', 'true');

            const adminModal = new bootstrap.Modal(document.getElementById('adminDashboardModal'));
            adminModal.show();
            loadAdminData();

            // Switch to specified tab if provided
            if (tabToShow) {
                setTimeout(() => {
                    document.getElementById(`${tabToShow}-tab`).click();
                }, 500);
            }

            // Store admin status in localStorage
            localStorage.setItem('isAdmin', 'true');

            // Add event listener to clear dashboard open state when closed
            const adminModalEl = document.getElementById('adminDashboardModal');
            adminModalEl.addEventListener('hidden.bs.modal', function() {
                localStorage.removeItem('adminDashboardOpen');
                console.log("Admin dashboard closed, removed from localStorage");
            });
        }

        // Add event listeners for report action buttons
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('resolveReportBtn').addEventListener('click', function() {
                const reportId = this.getAttribute('data-report-id');
                if (reportId) {
                    updateReportStatus(reportId, 'resolved');
                } else {
                    Swal.fire({
                        title: 'Error',
                        text: 'Could not find report ID',
                        icon: 'error'
                    });
                }
            });

            document.getElementById('reviewReportBtn').addEventListener('click', function() {
                const reportId = this.getAttribute('data-report-id');
                if (reportId) {
                    updateReportStatus(reportId, 'reviewed');
                } else {
                    Swal.fire({
                        title: 'Error',
                        text: 'Could not find report ID',
                        icon: 'error'
                    });
                }
            });
        });

        // Update report status function
        async function updateReportStatus(reportId, status) {
            try {
                const response = await fetch(`/admin/reports/${reportId}/status`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.message || 'Failed to update report status');
                }

                const result = await response.json();

                Swal.fire({
                    title: 'Success',
                    text: `Report has been marked as ${status}`,
                    icon: 'success'
                }).then(() => {
                    $('#reportDetailModal').modal('hide');
                    loadReports(); // Refresh the reports list
                });
            } catch (error) {
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'An error occurred while updating the report',
                    icon: 'error'
                });
            }
        }

        // Report filter
        // ... existing code ...

        // Load reports function
        async function loadReports() {
            try {
                const response = await fetch('/admin/reports');

                if (!response.ok) {
                    throw new Error('Failed to load reports');
                }

                const reports = await response.json();
                const reportsContainer = document.getElementById('reportsContainer');

                // Clear existing reports
                reportsContainer.innerHTML = '';

                if (reports.length === 0) {
                    reportsContainer.innerHTML = '<div class="text-center p-4"><p>No reports found</p></div>';
                    return;
                }

                // Create report cards
                reports.forEach(report => {
                    const statusClass = getStatusClass(report.status);
                    const card = document.createElement('div');
                    card.className = 'card mb-3';
                    card.innerHTML = `
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="card-title">${report.title || 'Untitled Report'}</h5>
                                <span class="badge ${statusClass}">${report.status}</span>
                            </div>
                            <p class="card-text text-muted mb-2">Reported by: ${report.reportedBy || 'Anonymous'}</p>
                            <p class="card-text mb-3">${report.description.substring(0, 100)}${report.description.length > 100 ? '...' : ''}</p>
                            <button class="btn btn-primary btn-sm view-report-btn" data-report-id="${report.id}">View Details</button>
                        </div>
                    `;
                    reportsContainer.appendChild(card);
                });

                // Add event listeners to view detail buttons
                document.querySelectorAll('.view-report-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const reportId = this.getAttribute('data-report-id');
                        if (reportId) {
                            showReportDetails(reportId);
                        }
                    });
                });
            } catch (error) {
                console.error('Error loading reports:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to load reports',
                    icon: 'error'
                });
            }
        }

        // Helper function to get status class
        function getStatusClass(status) {
            switch(status.toLowerCase()) {
                case 'pending':
                    return 'bg-warning text-dark';
                case 'resolved':
                    return 'bg-success';
                case 'reviewed':
                    return 'bg-info text-dark';
                default:
                    return 'bg-secondary';
            }
        }

        // Show report details function
        async function showReportDetails(reportId) {
            try {
                const response = await fetch(`/admin/reports/${reportId}`);

                if (!response.ok) {
                    throw new Error('Failed to load report details');
                }

                const report = await response.json();

                // Create status options
                const statusOptions = ['Pending', 'Reviewed', 'Resolved']
                    .map(status => `<option value="${status.toLowerCase()}" ${report.status.toLowerCase() === status.toLowerCase() ? 'selected' : ''}>${status}</option>`)
                    .join('');

                // Show modal with report details
                Swal.fire({
                    title: report.title || 'Report Details',
                    html: `
                        <div class="text-start">
                            <p><strong>Reported by:</strong> ${report.reportedBy || 'Anonymous'}</p>
                            <p><strong>Date:</strong> ${new Date(report.createdAt).toLocaleString()}</p>
                            <p><strong>Description:</strong></p>
                            <div class="border p-2 mb-3 rounded bg-light">
                                ${report.description}
                            </div>
                            <div class="form-group mb-3">
                                <label for="reportStatus" class="form-label">Status:</label>
                                <select id="reportStatus" class="form-select">
                                    ${statusOptions}
                                </select>
                            </div>
                        </div>
                    `,
                    showCancelButton: true,
                    confirmButtonText: 'Update Status',
                    cancelButtonText: 'Close',
                    width: '600px'
                }).then((result) => {
                    if (result.isConfirmed) {
                        const newStatus = document.getElementById('reportStatus').value;
                        updateReportStatus(reportId, newStatus);
                    }
                });
            } catch (error) {
                console.error('Error loading report details:', error);
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to load report details',
                    icon: 'error'
                });
            }
        }

        // Add this immediately after the report button


        function showReportModal() {
            console.log("Opening report modal");

            // Get current conversation info
            const otherUserId = currentOtherUserId;
            const listingId = currentListingId;

            console.log("Report modal: listing ID =", listingId, "thread ID =", currentMessageThreadId);

            // If we don't have a message thread ID, create a temporary one
            if (!currentMessageThreadId) {
                currentMessageThreadId = `temp_${Date.now()}`;
                console.log("Created temporary message thread ID:", currentMessageThreadId);
            }

            // Update hidden fields
            document.getElementById('reportListingId').value = listingId || '';
            document.getElementById('reportMessageThreadId').value = currentMessageThreadId;

            // Show modal using Bootstrap
            const reportModal = new bootstrap.Modal(document.getElementById('reportModal'));
            reportModal.show();
        }

        function closeReportModal() {
            const reportModal = bootstrap.Modal.getInstance(document.getElementById('reportModal'));
            if (reportModal) {
                reportModal.hide();
            }
        }

        // Add function to log download attempts
        function handleDownload(listingId, title, event) {
            console.log(`Download initiated for listing #${listingId}: ${title}`);

            // If not authenticated, prevent default and show login message
            if (!currentUser) {
                event.preventDefault();
                showAlert('Please Login', 'You need to login to download files', 'warning');
                return false;
            }

            // Show loading indicator
            const downloadBtn = event.currentTarget;
            const originalText = downloadBtn.innerHTML;
            downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Downloading...';
            downloadBtn.disabled = true;

            // Set a timer to restore the button if download doesn't start
            setTimeout(() => {
                if (downloadBtn.innerHTML.includes('Downloading')) {
                    downloadBtn.innerHTML = originalText;
                    downloadBtn.disabled = false;
                }
            }, 5000);

            // Set up error handling for the download
            window.addEventListener('error', function(e) {
                if (e.target.tagName === 'A' && e.target === downloadBtn) {
                    showAlert('Download Failed', 'The file could not be downloaded. Please try again later.', 'error');
                    downloadBtn.innerHTML = originalText;
                    downloadBtn.disabled = false;
                }
            }, {once: true});

            return true;
        }
        // Add this at the beginning of your JavaScript code
        function forceDesktopView() {
            // Set viewport to a fixed width (like desktop)
            const viewportMeta = document.querySelector('meta[name="viewport"]');
            if (viewportMeta) {
                viewportMeta.content = "width=1200, initial-scale=1.0";
            } else {
                const meta = document.createElement('meta');
                meta.name = "viewport";
                meta.content = "width=1200, initial-scale=1.0";
                document.head.appendChild(meta);
            }

            // Prevent any responsive behavior
            document.documentElement.style.overflowX = "auto";
            document.body.style.minWidth = "1200px";
            document.body.style.overflowX = "auto";

            // Disable Bootstrap's mobile breakpoints
            const style = document.createElement('style');
            style.innerHTML = `
                @media (max-width: 1200px) {
                    .container, .container-sm, .container-md, .container-lg, .container-xl, .container-xxl {
                        max-width: 1200px;
                    }
                    .navbar-expand-lg .navbar-collapse {
                        display: flex !important;
                    }
                    .navbar-toggler {
                        display: none !important;
                    }
                }
            `;
            document.head.appendChild(style);
        }

        // Multi-Step Form Variables


        // Step Form Functions
        // Fixed version of your create listing JavaScript

        function initializeStepForm() {
            currentStep = 1;
            updateStepDisplay();
            updateProgressBar();
            updateButtons();

            // Reset form data
            document.getElementById('createListingForm').reset();
            clearImagePreview();

            // Hide conditional fields
            document.querySelectorAll('.field-branch, .field-faculty, .field-subject, .field-softcopy, .field-fileupload, .field-working-condition, .field-warranty').forEach(field => {
                field.style.display = 'none';
            });
        }

        function changeStep(direction) {
            const newStep = currentStep + direction;

            if (direction > 0 && !validateStep(currentStep)) {
                return;
            }

            if (newStep >= 1 && newStep <= totalSteps) {
                currentStep = newStep;
                updateStepDisplay();
                updateProgressBar();
                updateButtons();

                if (currentStep === 5) {
                    updateReviewSection();
                }
            }
        }

        function updateStepDisplay() {
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });

            const currentContent = document.querySelector(`.step-content[data-step="${currentStep}"]`);
            if (currentContent) {
                currentContent.classList.add('active');
            }

            document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                indicator.classList.remove('active', 'completed');

                if (index + 1 === currentStep) {
                    indicator.classList.add('active');
                } else if (index + 1 < currentStep) {
                    indicator.classList.add('completed');
                }
            });
        }

        function updateProgressBar() {
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                const progressPercentage = (currentStep / totalSteps) * 100;
                progressBar.style.width = progressPercentage + '%';
            }
        }

        function updateButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');

            if (prevBtn) prevBtn.style.display = currentStep > 1 ? 'block' : 'none';

            if (currentStep < totalSteps) {
                if (nextBtn) nextBtn.style.display = 'block';
                if (submitBtn) submitBtn.style.display = 'none';
            } else {
                if (nextBtn) nextBtn.style.display = 'none';
                if (submitBtn) submitBtn.style.display = 'block';
            }
        }

        function validateStep(step) {
            switch (step) {
                case 1:
                    const category = document.getElementById('listingCategory').value;
                    const productType = document.getElementById('productType').value;
                    const academicYear = document.getElementById('academicYear').value;

                    if (!category) {
                        showAlert('Required Field', 'Please select a category', 'warning');
                        return false;
                    }
                    if (!productType) {
                        showAlert('Required Field', 'Please select a product type', 'warning');
                        return false;
                    }
                    if (!academicYear) {
                        showAlert('Required Field', 'Please select an academic year', 'warning');
                        return false;
                    }
                    return true;

                case 2:
                    const title = document.querySelector('input[name="title"]').value.trim();
                    const description = document.querySelector('textarea[name="description"]').value.trim();

                    if (!title) {
                        showAlert('Required Field', 'Please enter a title for your listing', 'warning');
                        return false;
                    }
                    if (!description) {
                        showAlert('Required Field', 'Please enter a description', 'warning');
                        return false;
                    }
                    return true;

                case 3:
                    const listingType = document.querySelector('input[name="listing_type"]:checked').value;

                    if (listingType === 'sell') {
                        const price = document.querySelector('input[name="price"]').value;
                        if (!price || price <= 0) {
                            showAlert('Invalid Price', 'Please enter a valid selling price', 'warning');
                            return false;
                        }
                    } else {
                        const rentPrice = document.querySelector('input[name="rent_price"]').value;
                        const rentTenure = document.querySelector('input[name="rent_tenure"]').value;

                        if (!rentPrice || rentPrice <= 0) {
                            showAlert('Invalid Price', 'Please enter a valid rental price', 'warning');
                            return false;
                        }
                        if (!rentTenure || rentTenure <= 0) {
                            showAlert('Invalid Tenure', 'Please enter a valid rental period', 'warning');
                            return false;
                        }
                    }
                    return true;

                case 4:
                    const imageInput = document.getElementById('imageInput');
                    if (!imageInput.files || imageInput.files.length === 0) {
                        showAlert('Image Required', 'Please upload an image of your product', 'warning');
                        return false;
                    }

                    const file = imageInput.files[0];
                    if (file.size > 5 * 1024 * 1024) {
                        showAlert('File Too Large', 'Please upload an image smaller than 5MB', 'warning');
                        return false;
                    }
                    return true;

                case 5:
                    const fakeWarning = document.getElementById('fakeWarning').checked;
                    if (!fakeWarning) {
                        showAlert('Confirmation Required', 'Please confirm that your product information is accurate', 'warning');
                        return false;
                    }
                    return true;

                default:
                    return true;
            }
        }

        function updateReviewSection() {
            const form = document.getElementById('createListingForm');
            const formData = new FormData(form);

            const imageInput = document.getElementById('imageInput');
            if (imageInput.files && imageInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const reviewImage = document.getElementById('reviewImage');
                    if (reviewImage) {
                        reviewImage.src = e.target.result;
                    }
                };
                reader.readAsDataURL(imageInput.files[0]);
            }

            // Update review details
            const reviewTitle = document.getElementById('reviewTitle');
            const reviewDescription = document.getElementById('reviewDescription');

            if (reviewTitle) reviewTitle.textContent = formData.get('title') || 'Product Title';
            if (reviewDescription) reviewDescription.textContent = formData.get('description') || 'Product description...';

            // Update badges
            const category = formData.get('category');
            const productType = formData.get('product_type');
            const academicYear = formData.get('study_year');

            const reviewCategory = document.getElementById('reviewCategory');
            const reviewProductType = document.getElementById('reviewProductType');
            const reviewYear = document.getElementById('reviewYear');

            if (reviewCategory) reviewCategory.textContent = category ? category.charAt(0).toUpperCase() + category.slice(1) : 'Category';
            if (reviewProductType) reviewProductType.textContent = productType ? productType.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase()) : 'Product Type';
            if (reviewYear) reviewYear.textContent = academicYear ? `${academicYear}${getOrdinalSuffix(academicYear)} Year` : 'Academic Year';

            // Update price display
            const listingType = document.querySelector('input[name="listing_type"]:checked').value;
            let priceText = '₹0';

            if (listingType === 'sell') {
                const price = formData.get('price');
                priceText = price ? `₹${price}` : '₹0';
            } else {
                const rentPrice = formData.get('rent_price');
                priceText = rentPrice ? `₹${rentPrice}/day` : '₹0/day';
            }

            const reviewPriceDisplay = document.getElementById('reviewPriceDisplay');
            if (reviewPriceDisplay) reviewPriceDisplay.textContent = priceText;
        }

        function getOrdinalSuffix(num) {
            const j = num % 10;
            const k = num % 100;
            if (j == 1 && k != 11) return "st";
            if (j == 2 && k != 12) return "nd";
            if (j == 3 && k != 13) return "rd";
            return "th";
        }

        function removeImage() {
            const imageInput = document.getElementById('imageInput');
            const uploadPlaceholder = document.getElementById('uploadPlaceholder');
            const imagePreviewContainer = document.getElementById('imagePreviewContainer');

            if (imageInput) imageInput.value = '';
            if (uploadPlaceholder) uploadPlaceholder.style.display = 'block';
            if (imagePreviewContainer) imagePreviewContainer.style.display = 'none';
        }

        function clearImagePreview() {
            const uploadPlaceholder = document.getElementById('uploadPlaceholder');
            const imagePreviewContainer = document.getElementById('imagePreviewContainer');

            if (uploadPlaceholder) uploadPlaceholder.style.display = 'block';
            if (imagePreviewContainer) imagePreviewContainer.style.display = 'none';
        }

        // FIXED: Product type population function
        function populateProductTypes(category) {
            const productTypeSelect = document.getElementById('productType');
            if (!productTypeSelect) return;

            // Clear existing options
            productTypeSelect.innerHTML = '<option value="">Select Product Type</option>';

            // Product type mappings - MAKE SURE these match your HTML option values
            const productTypes = {
                'electronic': [
                    { value: 'mobile', text: '📱 Mobile' },
                    { value: 'laptop', text: '💻 Laptop' },
                    { value: 'calculator', text: '🔢 Calculator' },
                    { value: 'tablet', text: '📱 Tablet' },
                    { value: 'headphones', text: '🎧 Headphones' }
                ],
                'books': [
                    { value: 'text_books', text: '📖 Text Books' },
                    { value: 'class_book', text: '📚 Class Book' },
                    { value: 'running_notes', text: '📝 Running Notes' },
                    { value: 'reference_books', text: '📑 Reference Books' }
                ],
                'clothes': [
                    { value: 'casual', text: '👕 Casual' },
                    { value: 'formal', text: '👔 Formal' },
                    { value: 'apron', text: '🥼 Apron' },
                    { value: 'uniform', text: '👕 Uniform' }
                ]
            };

            if (productTypes[category]) {
                productTypes[category].forEach(type => {
                    const option = document.createElement('option');
                    option.value = type.value;
                    option.textContent = type.text;
                    productTypeSelect.appendChild(option);
                });
                console.log(`Loaded ${productTypes[category].length} product types for ${category}`);
            }
        }

        // FIXED: Category field visibility function
        function updateCategoryFields(category) {
            // Hide all conditional fields first
            const fieldsToHide = ['.field-branch', '.field-subject', '.field-faculty', '.field-softcopy', '.field-fileupload', '.field-working-condition', '.field-warranty'];
            fieldsToHide.forEach(selector => {
                const field = document.querySelector(selector);
                if (field) field.style.display = 'none';
            });

            // Show fields based on category
            if (category === 'books') {
                const fieldsToShow = ['.field-branch', '.field-subject', '.field-faculty', '.field-softcopy'];
                fieldsToShow.forEach(selector => {
                    const field = document.querySelector(selector);
                    if (field) field.style.display = 'block';
                });
            } else if (category === 'electronic') {
                const fieldsToShow = ['.field-working-condition', '.field-warranty'];
                fieldsToShow.forEach(selector => {
                    const field = document.querySelector(selector);
                    if (field) field.style.display = 'block';
                });
            }
        }

        function toggleRentFields() {
            const listingType = document.querySelector('input[name="listing_type"]:checked')?.value;
            const rentFields = document.querySelectorAll('.rent-field');
            const sellPriceField = document.getElementById('sellPriceField');

            if (listingType === 'rent') {
                rentFields.forEach(field => field.style.display = 'block');
                if (sellPriceField) sellPriceField.style.display = 'none';

                const rentPriceInput = document.querySelector('input[name="rent_price"]');
                const rentTenureInput = document.querySelector('input[name="rent_tenure"]');
                const priceInput = document.querySelector('input[name="price"]');

                if (rentPriceInput) rentPriceInput.required = true;
                if (rentTenureInput) rentTenureInput.required = true;
                if (priceInput) priceInput.required = false;
            } else {
                rentFields.forEach(field => field.style.display = 'none');
                if (sellPriceField) sellPriceField.style.display = 'block';

                const rentPriceInput = document.querySelector('input[name="rent_price"]');
                const rentTenureInput = document.querySelector('input[name="rent_tenure"]');
                const priceInput = document.querySelector('input[name="price"]');

                if (rentPriceInput) rentPriceInput.required = false;
                if (rentTenureInput) rentTenureInput.required = false;
                if (priceInput) priceInput.required = true;
            }
        }

        function toggleFileUpload() {
            const isSoftCopy = document.getElementById('softCopy')?.checked;
            const fileUploadField = document.querySelector('.field-fileupload');
            const documentInput = document.querySelector('input[name="document"]');

            if (fileUploadField) {
                fileUploadField.style.display = isSoftCopy ? 'block' : 'none';
            }

            if (documentInput) {
                documentInput.required = isSoftCopy;
            }
        }

        // FIXED: Initialize event listeners
        function setupEventListeners() {
            // Category change handler - FIXED VERSION
            const categorySelect = document.getElementById('listingCategory');
            if (categorySelect) {
                categorySelect.addEventListener('change', function() {
                    const category = this.value;
                    console.log('Category selected:', category); // Debug log

                    if (category) {
                        populateProductTypes(category);
                        updateCategoryFields(category);
                    }
                });
            }

            // Image upload handler
            const imageInput = document.getElementById('imageInput');
            if (imageInput) {
                imageInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        if (file.size > 5 * 1024 * 1024) {
                            showAlert('File Too Large', 'Please select an image smaller than 5MB', 'error');
                            this.value = '';
                            return;
                        }

                        if (!file.type.match('image.*')) {
                            showAlert('Invalid File Type', 'Please select a valid image file', 'error');
                            this.value = '';
                            return;
                        }

                        const reader = new FileReader();
                        reader.onload = function(e) {
                            const uploadPlaceholder = document.getElementById('uploadPlaceholder');
                            const imagePreviewContainer = document.getElementById('imagePreviewContainer');
                            const imagePreview = document.getElementById('imagePreview');

                            if (uploadPlaceholder && imagePreviewContainer && imagePreview) {
                                uploadPlaceholder.style.display = 'none';
                                imagePreviewContainer.style.display = 'block';
                                imagePreview.src = e.target.result;
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }

            // Listing type handlers
            const sellType = document.getElementById('sellType');
            const rentType = document.getElementById('rentType');
            if (sellType && rentType) {
                [sellType, rentType].forEach(radio => {
                    radio.addEventListener('change', toggleRentFields);
                });
            }

            // Copy type handlers
            const softCopy = document.getElementById('softCopy');
            const hardCopy = document.getElementById('hardCopy');
            if (softCopy && hardCopy) {
                [softCopy, hardCopy].forEach(radio => {
                    radio.addEventListener('change', toggleFileUpload);
                });
            }

            // Form submission handler
            const createListingForm = document.getElementById('createListingForm');
            if (createListingForm) {
                createListingForm.addEventListener('submit', async function(e) {
                    e.preventDefault();

                    if (!validateStep(5)) {
                        return;
                    }

                    try {
                        const submitBtn = document.getElementById('submitBtn');
                        const originalBtnText = submitBtn.innerHTML;
                        submitBtn.disabled = true;
                        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Creating...';

                        const formData = new FormData(this);

                        const listingType = document.querySelector('input[name="listing_type"]:checked').value;
                        formData.append('is_for_rent', listingType === 'rent' ? 'true' : 'false');

                        if (listingType === 'rent') {
                            formData.set('price', '0');
                        }

                        const response = await fetch('/create-listing', {
                            method: 'POST',
                            body: formData,
                            credentials: 'same-origin'
                        });

                        const data = await response.json();

                        if (response.ok) {
                            const modal = bootstrap.Modal.getInstance(document.getElementById('createListingModal'));
                            modal.hide();

                            await Swal.fire({
                                title: 'Success!',
                                text: 'Your listing has been created successfully',
                                icon: 'success',
                                timer: 2000,
                                showConfirmButton: false
                            });

                            this.reset();
                            initializeStepForm();

                            // Reload listings if on buy page
                            if (typeof loadListings === 'function') {
                                loadListings();
                            }

                        } else {
                            throw new Error(data.error || 'Failed to create listing');
                        }
                    } catch (error) {
                        console.error('Error creating listing:', error);
                        Swal.fire({
                            title: 'Error',
                            text: error.message,
                            icon: 'error'
                        });
                    } finally {
                        const submitBtn = document.getElementById('submitBtn');
                        if (submitBtn) {
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = '<i class="fas fa-plus-circle me-2"></i>Create Listing';
                        }
                    }
                });
            }
        }

        // MAIN INITIALIZATION
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize step form when modal is shown
            const createListingModal = document.getElementById('createListingModal');
            if (createListingModal) {
                createListingModal.addEventListener('show.bs.modal', function() {
                    setTimeout(() => {
                        initializeStepForm();
                        setupEventListeners(); // Setup event listeners after modal is shown
                        console.log('Modal initialized with event listeners');
                    }, 100);
                });
            }
        });

        // Global variables (make sure these are defined in your main script)


        // Enhanced toggle functions
        function toggleRentFields() {
            const listingType = document.querySelector('input[name="listing_type"]:checked')?.value;
            const rentFields = document.querySelectorAll('.rent-field');
            const sellPriceField = document.getElementById('sellPriceField');

            if (listingType === 'rent') {
                rentFields.forEach(field => field.style.display = 'block');
                if (sellPriceField) sellPriceField.style.display = 'none';

                // Update required fields
                const rentPriceInput = document.querySelector('input[name="rent_price"]');
                const rentTenureInput = document.querySelector('input[name="rent_tenure"]');
                const priceInput = document.querySelector('input[name="price"]');

                if (rentPriceInput) rentPriceInput.required = true;
                if (rentTenureInput) rentTenureInput.required = true;
                if (priceInput) priceInput.required = false;
            } else {
                rentFields.forEach(field => field.style.display = 'none');
                if (sellPriceField) sellPriceField.style.display = 'block';

                // Update required fields
                const rentPriceInput = document.querySelector('input[name="rent_price"]');
                const rentTenureInput = document.querySelector('input[name="rent_tenure"]');
                const priceInput = document.querySelector('input[name="price"]');

                if (rentPriceInput) rentPriceInput.required = false;
                if (rentTenureInput) rentTenureInput.required = false;
                if (priceInput) priceInput.required = true;
            }
        }

        function toggleFileUpload() {
            const isSoftCopy = document.getElementById('softCopy')?.checked;
            const fileUploadField = document.querySelector('.field-fileupload');
            const documentInput = document.querySelector('input[name="document"]');

            if (fileUploadField) {
                fileUploadField.style.display = isSoftCopy ? 'block' : 'none';
            }

            if (documentInput) {
                documentInput.required = isSoftCopy;
            }
        }
        // ==================== SALES ANALYTICS FUNCTIONS ====================

// Sales Statistics Variables
      
        // Load Sales Statistics
        
        // ==================== COLLEGES MANAGEMENT FUNCTIONS ====================

       
        // Load Colleges Data
        async function loadColleges(page = 1, search = '') {
            try {
                const response = await fetch(`/admin/colleges?page=${page}&search=${search}`, {
                    credentials: 'same-origin'
                });
                
                if (!response.ok) throw new Error('Failed to load colleges');
                
                const data = await response.json();
                allCollegesData = data.colleges || [];
                
                displayCollegesTable(allCollegesData, page);
                
            } catch (error) {
                console.error('Error loading colleges:', error);
                const collegesTable = document.getElementById('collegesTableBody');
                if (collegesTable) {
                    collegesTable.innerHTML = `
                        <tr>
                            <td colspan="4" class="text-center text-danger py-3">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Error loading colleges: ${error.message}
                            </td>
                        </tr>
                    `;
                }
            }
        }

        // Display Colleges Table
        function displayCollegesTable(colleges, page = 1) {
            const tableBody = document.getElementById('collegesTableBody');
            if (!tableBody) return;
            
            const start = (page - 1) * collegesPerPage;
            const end = start + collegesPerPage;
            const paginatedData = colleges.slice(start, end);
            
            if (!colleges || colleges.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="4" class="text-center py-4">
                            <i class="fas fa-university fa-3x text-muted mb-3 d-block"></i>
                            <p class="text-muted mb-0">No colleges found</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tableBody.innerHTML = paginatedData.map(college => `
                <tr>
                    <td>
                        <strong>${college.college_name}</strong>
                    </td>
                    <td>
                        <span class="badge bg-primary">${college.user_count}</span>
                    </td>
                    <td>
                        <span class="badge bg-info">${college.listing_count}</span>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewCollegeDetails('${college.college_name}')" title="View Details">
                            <i class="fas fa-eye me-1"></i>View Details
                        </button>
                    </td>
                </tr>
            `).join('');
            
            // Update pagination
            updateCollegesPagination(colleges.length, page);
        }

        // Update Colleges Pagination
        function updateCollegesPagination(total, currentPage) {
            const totalPages = Math.ceil(total / collegesPerPage);
            const start = total === 0 ? 0 : (currentPage - 1) * collegesPerPage + 1;
            const end = Math.min(currentPage * collegesPerPage, total);
            
            const collegeStartEl = document.getElementById('collegeStart');
            const collegeEndEl = document.getElementById('collegeEnd');
            const collegeTotalEl = document.getElementById('collegeTotal');
            const prevBtn = document.getElementById('collegePrevPage');
            const nextBtn = document.getElementById('collegeNextPage');
            
            if (collegeStartEl) collegeStartEl.textContent = start;
            if (collegeEndEl) collegeEndEl.textContent = end;
            if (collegeTotalEl) collegeTotalEl.textContent = total;
            
            if (prevBtn) prevBtn.disabled = currentPage === 1;
            if (nextBtn) nextBtn.disabled = currentPage === totalPages || totalPages === 0;
        }

        // View College Details
        async function viewCollegeDetails(collegeName) {
            try {
                Swal.fire({
                    title: 'Loading...',
                    text: 'Fetching college details',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading();
                    }
                });
                
                const response = await fetch(`/admin/college-details/${encodeURIComponent(collegeName)}`, {
                    credentials: 'same-origin'
                });
                
                if (!response.ok) throw new Error('Failed to load college details');
                
                const college = await response.json();
                Swal.close();
                
                // Format the college details HTML
                const collegeDetailsHtml = `
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3 class="text-primary">
                                <i class="fas fa-university me-2"></i>${college.college_name}
                            </h3>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card bg-primary text-white">
                                <div class="card-body text-center">
                                    <h6>Total Users</h6>
                                    <h2>${college.user_count}</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-success text-white">
                                <div class="card-body text-center">
                                    <h6>Verified Users</h6>
                                    <h2>${college.verified_users}</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card bg-info text-white">
                                <div class="card-body text-center">
                                    <h6>Total Listings</h6>
                                    <h2>${college.listing_count}</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <h5>Recent Users</h5>
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Verified</th>
                                            <th>Joined</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${college.recent_users.map(user => `
                                            <tr>
                                                <td>${user.full_name}</td>
                                                <td><small>${user.email}</small></td>
                                                <td>
                                                    ${user.is_verified ? 
                                                        '<span class="badge bg-success">Verified</span>' : 
                                                        '<span class="badge bg-warning">Unverified</span>'}
                                                </td>
                                                <td><small>${new Date(user.created_at).toLocaleDateString()}</small></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-3">
                        <div class="col-12">
                            <h5>Recent Listings</h5>
                            <div class="table-responsive">
                                <table class="table table-sm table-hover">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Category</th>
                                            <th>Price</th>
                                            <th>Seller</th>
                                            <th>Posted</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${college.recent_listings.map(listing => `
                                            <tr>
                                                <td>${listing.title}</td>
                                                <td><span class="badge bg-info">${listing.category}</span></td>
                                                <td>₹${listing.price}</td>
                                                <td><small>${listing.seller_name}</small></td>
                                                <td><small>${new Date(listing.created_at).toLocaleDateString()}</small></td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;
                
                // Set the content and show the modal
                document.getElementById('collegeDetailsContent').innerHTML = collegeDetailsHtml;
                const collegeDetailsModal = new bootstrap.Modal(document.getElementById('collegeDetailsModal'));
                collegeDetailsModal.show();
                
            } catch (error) {
                Swal.fire({
                    title: 'Error',
                    text: error.message || 'Failed to load college details',
                    icon: 'error'
                });
            }
        }

        // Event Listeners for Colleges
        document.addEventListener('DOMContentLoaded', function() {
            // College search
            const collegeSearch = document.getElementById('collegeSearch');
            if (collegeSearch) {
                collegeSearch.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const filteredColleges = allCollegesData.filter(college => 
                        college.college_name.toLowerCase().includes(searchTerm)
                    );
                    currentCollegePage = 1;
                    displayCollegesTable(filteredColleges, 1);
                });
            }
            
            // College pagination
            const collegePrevBtn = document.getElementById('collegePrevPage');
            const collegeNextBtn = document.getElementById('collegeNextPage');
            
            if (collegePrevBtn) {
                collegePrevBtn.addEventListener('click', function() {
                    if (currentCollegePage > 1) {
                        currentCollegePage--;
                        displayCollegesTable(allCollegesData, currentCollegePage);
                    }
                });
            }
            
            if (collegeNextBtn) {
                collegeNextBtn.addEventListener('click', function() {
                    const totalPages = Math.ceil(allCollegesData.length / collegesPerPage);
                    if (currentCollegePage < totalPages) {
                        currentCollegePage++;
                        displayCollegesTable(allCollegesData, currentCollegePage);
                    }
                });
            }
        });
        // Modern Mobile Menu Functions
        function toggleMobileMenu() {
            const toggler = document.querySelector('.navbar-toggler');
            const navbarCollapse = document.getElementById('navbarNav');
            const backdrop = document.querySelector('.mobile-menu-backdrop');
            
            toggler.classList.toggle('active');
            navbarCollapse.classList.toggle('show');
            backdrop.classList.toggle('show');
            document.body.classList.toggle('menu-open');
        }

        function closeMobileMenu() {
            const toggler = document.querySelector('.navbar-toggler');
            const navbarCollapse = document.getElementById('navbarNav');
            const backdrop = document.querySelector('.mobile-menu-backdrop');
            
            toggler.classList.remove('active');
            navbarCollapse.classList.remove('show');
            backdrop.classList.remove('show');
            document.body.classList.remove('menu-open');
        }

        // Initialize mobile menu
        document.addEventListener('DOMContentLoaded', function() {
            // Create backdrop
            if (!document.querySelector('.mobile-menu-backdrop')) {
                const backdrop = document.createElement('div');
                backdrop.className = 'mobile-menu-backdrop';
                backdrop.onclick = closeMobileMenu;
                document.body.appendChild(backdrop);
            }
            
            // Close menu on link clicks
            document.querySelectorAll('#navbarNav .nav-link').forEach(link => {
                link.addEventListener('click', function() {
                    if (!this.classList.contains('dropdown-toggle')) {
                        setTimeout(closeMobileMenu, 300);
                    }
                });
            });
            
            // Update mobile user info
            updateMobileUserInfo();
        });

        // Update mobile menu based on login status
        function updateMobileUserInfo() {
            const userName = document.getElementById('userName')?.textContent;
            const mobileUserSection = document.getElementById('mobileUserSection');
            const mobileAuthSection = document.getElementById('mobileAuthSection');
            
            if (userName && userName.trim()) {
                // User is logged in
                mobileUserSection?.classList.remove('d-none');
                if (mobileAuthSection) mobileAuthSection.style.display = 'none';
                
                document.getElementById('mobileUserName').textContent = userName;
                document.getElementById('mobileUserAvatar').textContent = userName.charAt(0).toUpperCase();
            } else {
                // User is logged out
                mobileUserSection?.classList.add('d-none');
                if (mobileAuthSection) mobileAuthSection.style.display = 'flex';
            }
        }
    </script>
</body>
</html>